(this["webpackJsonpimage-editor"]=this["webpackJsonpimage-editor"]||[]).push([[15],{1021:function(e,t,n){var r={"./daub-pen.svg":1022,"./path-pen.svg":1023,"./rect-pen.svg":1024,"./union.svg":1025};function c(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}c.keys=function(){return Object.keys(r)},c.resolve=a,(e.exports=c).id=1021},1029:function(e,t,n){var r={"./line-0.svg":1030,"./line-1.svg":1031,"./line-2.svg":1032,"./line-3.svg":1033,"./line-4.svg":1034};function c(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}c.keys=function(){return Object.keys(r)},c.resolve=a,(e.exports=c).id=1029},1035:function(e,t,n){var r={"./arrow.svg":1036,"./circle.svg":1037,"./curve.svg":1038,"./heart.svg":1039,"./line.svg":1040,"./polygon.svg":1041,"./square.svg":1042,"./star.svg":1043};function c(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}c.keys=function(){return Object.keys(r)},c.resolve=a,(e.exports=c).id=1035},104:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));t=n(149);var r=n.n(t),c=n(139),a=function(){return new Promise((function(e){var t=2;!function n(){var a=function(){var e=r.a.get("meitustat");if(!e)return"";try{return JSON.parse(e).wgid}catch(e){return""}}();a||0!==t?a?e(a):setTimeout((function(){t-=1,n()}),500):e(Object(c.a)())}()}))}},1063:function(e,t,n){},107:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var r=n(18),c=function(){return{vipModalShow:Object(r.c)((function(e){return e.editor.recordModel.vipModalShow})),vipModalParams:Object(r.c)((function(e){return e.editor.recordModel.vipModalParams})),recordInfo:Object(r.c)((function(e){return e.editor.recordModel.recordInfo}))}},a=function(){return Object(r.b)((function(e){return e.editor.recordModel.resetRecordInfo}))},i=function(){return Object(r.b)((function(e){return e.editor.recordModel.setRecordInfo}))}},108:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(20),c=!1,a=function(){return c},i=function(){return new Promise((function(e,t){var n=(new Date).getTime();Object(r.setConfig)({debug:!1}),r.imageKit.init("https://pc.meitudata.com/image-editor").then((function(){c=!0;var t=(new Date).getTime()-n;window._stat_track("wasm_durations",{duration:t}),e(1)})).catch((function(e){t()}))}))}},1093:function(e,t){},1098:function(e,t,n){},1099:function(e,t,n){},1100:function(e,t,n){},1101:function(e,t,n){},1108:function(e,t,n){},1110:function(e,t,n){},1111:function(e,t,n){},1114:function(e,t,n){},1118:function(e,t,n){},1119:function(e,t,n){},112:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));t=n(256);var r=n.n(t),c=(t=n(424),n.n(t));function a(e){return{meta:{code:e.error_code,msg:e.msg,error:e.error}}}function i(e,t){return e=r()(e,["data"]),c()(e,{data:t})}},1120:function(e,t,n){},1121:function(e,t,n){},1127:function(e,t,n){},1160:function(e,t,n){var r={"./vip-font-style-1.png":1161,"./vip-font-style-10.png":1162,"./vip-font-style-11.png":1163,"./vip-font-style-12.png":1164,"./vip-font-style-13.png":1165,"./vip-font-style-14.png":1166,"./vip-font-style-2.png":1167,"./vip-font-style-3.png":1168,"./vip-font-style-4.png":1169,"./vip-font-style-5.png":1170,"./vip-font-style-6.png":1171,"./vip-font-style-7.png":1172,"./vip-font-style-8.png":1173,"./vip-font-style-9.png":1174};function c(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}c.keys=function(){return Object.keys(r)},c.resolve=a,(e.exports=c).id=1160},1161:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/5e43e5a14566350a6d42e40f82843619.png"},1162:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/fb62a947424340e1212ce13cb3b1900b.png"},1163:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/e57397d0dd4cbd062ed34f5168d70ca7.png"},1164:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/65ffe0f7ae588d3709b55c643a39f97d.png"},1165:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/b9505a69d183a56b6901ad213c0d68d8.png"},1166:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/6529263a993142ee6c12acab190f5ef6.png"},1167:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/08013b751f22316a392f2ea2308486a0.png"},1168:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/28acfd00989ca246e4958220feb2e273.png"},1169:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/8561a3201ed1c20aa424bc1bb1a81d7c.png"},1170:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/c7b5d44c0bf27afd8d8fcb3b67980d0e.png"},1171:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/36bd330f246eed113a5d4bfdf3a9cfaf.png"},1172:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/e75f167faf20d250cb3c350d0bf204d3.png"},1173:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/e4676b0dc81617b9e34d080d84d3b345.png"},1174:function(e,t,n){"use strict";n.r(t),t.default=n.p+"static/images/1e88bca2f87211f2dd80d66f81c08376.png"},1175:function(e,t,n){},1176:function(e,t,n){},1178:function(e,t,n){},1179:function(e,t,n){},1185:function(e,t,n){"use strict";function r(e){function t(e,t){var a={width:n,height:r};a[t]=e,i||("width"===t?a.height=e/l:a.width=e*l),c(a,t)}var n=e.width,r=(e.maxVal,e.minVal,e.height),c=e.onChange,a=e.inputStyleWidth,i=e.canAutoCrop,o=e.setCanAutoCrop,s=(e=e.precision,Object(u.useState)(1)),l=(s=Object(j.a)(s,2))[0],d=s[1];Object(u.useEffect)((function(){i||d(n/r)}),[n,r,i]),s=Object(u.useCallback)((function(){o(!i)}),[i]);return Object(h.jsxs)("div",{className:"m-size-input",children:[Object(h.jsx)(m.f,{width:a||64,precision:e,height:24,onChange:function(e){S()(e)||t(e,"width")},value:n,showStepBtn:!1}),Object(h.jsx)(T,{canAutoCrop:i,handleLock:s}),Object(h.jsx)(m.f,{width:a||64,height:24,precision:e,onChange:function(e){S()(e)||t(e,"height")},value:r,showStepBtn:!1})]})}n.r(t);t=n(12);var c=n(71),a=(c=n.n(c),n(1199)),i=n(122),o=n(639),u=((a=(a.a({dsn:"https://705e5014c23345abb4ce3b297db018f3@sentry.meipu.cn/154",integrations:[new o.a({tracingOrigins:["localhost","prepc.meitu.com","betapc.meitu.com","pc.meitu.com",/^\//]})],autoSessionTracking:!1,enabled:!0,environment:"release",release:"version_202311081138"}),window.localStorage.getItem("uid")))&&i.b({id:a}),n(0)),s=(o=n.n(u),n(101)),l=n(159),d=n(138),b=n(4),p=n(5),f=n(11),j=n(8),O=n(658),m=n(13),h=(n(944),n(1)),g=m.v.AppTheme,_=o.a.memo((function(){var e=Object(s.a)();return Object(h.jsx)("div",{className:"p-header__logo",onClick:function(){window.location.href=window.location.origin},children:e.theme===g.dark?Object(h.jsx)(m.s,{width:116,height:32,name:"logo"}):Object(h.jsx)(m.s,{width:116,height:32,name:"logo-white"})})})),v=(i=n(63),n.n(i)),w=o.a.memo((function(){var e=[{text:"\u56fe\u7247\u7f16\u8f91",func:function(){},active:!0},{text:"\u6d77\u62a5\u8bbe\u8ba1",active:!1,func:function(){var e="",t=(v.a.parse(window.location.search),window.sessionStorage.getItem("channel")),n=window.sessionStorage.getItem("first_url");t&&(e+="&channel=".concat(t)),n&&(e+="&first_url=".concat(encodeURIComponent(n))),window.open("https://".concat("","design.meitu.com/design/?from=tpbj").concat(e),"_blank")}}];return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(_,{}),Object(h.jsx)("div",{className:"c-header__tabs",children:Object(h.jsx)(O.a,{tabData:e})}),Object(h.jsx)("div",{className:"p-header__separater"})]})})),x=(a=n(9),n.n(a)),y=n(18),k=n(3),E=n(16),T=(n(1063),o.a.memo((function(e){var t=e.canAutoCrop,n=e.handleLock;return Object(h.jsx)(m.x,{title:t?"\u672a\u9501\u5b9a\u6bd4\u4f8b":"\u9501\u5b9a\u6bd4\u4f8b",placement:"bottom",children:Object(h.jsx)(m.d,{width:24,height:24,isActive:!t,type:"button",fontSize:24,name:t?"delink":"link",onClick:function(){return n()}})})}))),S=(i=n(330),n.n(i)),I=(a=n(139),n(114)),A=n(154),C=n(208),L=n.p+"static/images/b1373dd0431557513d505fd71ab4bf82.png",N=n(264),M=n(45),R=function(e){return e.px="px",e.ch="ch",e.cm="cm",e}({}),P="customSizeStoreKey",U=n(108),D=(n(1098),n(43));function F(e){var t=8e3;return e===R.px?t=8e3:e===R.cm?t=211.67:e===R.ch&&(t=83.33),t}function G(e){var t=1;return e===R.px?t=1:e!==R.cm&&e!==R.ch||(t=.01),t}function z(){function e(e){"\u81ea\u7531\u8c03\u6574"===e.name?(q(!1),T((function(e){return Object(p.a)(Object(p.a)({},e),{},{name:"\u81ea\u7531\u8c03\u6574",id:O[0].id})}))):(q(!0),T(e),V(B.find((function(t){return t.unit===e.unit}))),K(+e.height/+e.width))}var t=Object(D.o)(),n=Object(D.m)(),c=Object(u.useState)([]),a=(c=Object(j.a)(c,2))[0],i=c[1],o=Object(M.d)(),s=(Object(y.b)((function(e){return e.templateModel.setIsInit})),Object(y.b)((function(e){return e.editor.stageSizeCollapseModel.setStageSizeList}))),l=Object(y.b)((function(e){return e.stageModel})).setEnterType,d=(Object(u.useEffect)((function(){!function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t,n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(window.localStorage.getItem(P)||"[]"),e.next=3,Object(C.k)();case 3:n=(n=e.sent).data.data,s(Q()((null==n?void 0:n.materials)||[])),($=((null==n?void 0:n.materials)||[]).map((function(e){return{width:e.material.meta.template_size.width,height:e.material.meta.template_size.height,unit:e.material.meta.unit,name:e.material.default_name,id:e.material.id,isCustom:!1}}))).unshift({width:0,height:0,unit:R.px,name:"\u81ea\u7531\u8c03\u6574",isCustom:!1,id:"0"}),g(Object(E.a)($)),T($[1]),q(!0),K(+(null==(n=$[1])?void 0:n.height)/+(null==(n=$[1])?void 0:n.width)),i(t);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),Object(u.useEffect)((function(){window.localStorage.setItem(P,JSON.stringify(a));var e=Object(E.a)($);a.length&&e.splice.apply(e,[1,0].concat(Object(E.a)(a))),g(e)}),[a.length]),m.m.Option),O=(c=Object(u.useState)([]),(c=Object(j.a)(c,2))[0]),g=c[1],_=(c=Object(u.useState)(""),(c=Object(j.a)(c,2))[0]),v=c[1],w=(c=Object(u.useState)($[1]),(c=Object(j.a)(c,2))[0]),T=c[1],S=(c=Object(u.useState)({}),(c=Object(j.a)(c,2))[0]),z=c[1],B=(Object(u.useEffect)((function(){var e=(t=B[0]).unit,t=t.fixed,n=(e=(t=Y({width:+(null==w?void 0:w.width),height:+(null==w?void 0:w.height),fixed:t,form:null==w?void 0:w.unit,to:e})).width,480/(t=t.height)<340/e?480/t:340/e);z({backgroundColor:_,backgroundImage:!_&&"url(".concat(L,")")||"",backgroundRepeat:"repeat",transform:"scale(".concat(n,")"),width:e,height:t,flexShrink:0})}),[w,_]),[{unit:R.px,name:"\u50cf\u7d20",max:8e3,fixed:0},{unit:R.ch,name:"\u82f1\u5bf8",max:83.33,fixed:2},{unit:R.cm,name:"\u5398\u7c73",max:211.67,fixed:2}]),H=(c=Object(u.useState)(B[0]),(c=Object(j.a)(c,2))[0]),V=c[1];function J(e){var t=H.max,n=H.fixed;return(e=t<e?t:e).toFixed(n)}var Y=function(e){var t,n=e.width,r=e.height,c=e.form,a=e.to;e=e.fixed;return t={},Object(k.a)(t,R.px,96),Object(k.a)(t,R.cm,2.54),Object(k.a)(t,R.ch,1),{width:Number((n/t[c]*t[a]).toFixed(e))||1,height:Number((r/t[c]*t[a]).toFixed(e))||1}},W=(c=(Object(u.useEffect)((function(){var e,t=H.unit,n=H.fixed,r=H.max;t!==(null==w?void 0:w.unit)&&(e=(n=Y({width:+w.width,height:+w.height,fixed:n,form:null==w?void 0:w.unit,to:t})).width,n=n.height,T({name:"\u81ea\u7531\u8c03\u6574",unit:t,width:r<e?r:e,height:r<n?r:n,isCustom:!1,id:"0"}))}),[H]),Object(u.useState)(!1)),(c=Object(j.a)(c,2))[0]),q=c[1],K=(c=Object(u.useState)(0),(c=Object(j.a)(c,2))[0],c[1]),X=Object(A.a)();c=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t,r;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.show(),l("create"),t=B.find((function(e){return e.unit===R.px})),r=t.fixed,t=t.unit,r=Y({width:+(null==w?void 0:w.width),height:+(null==w?void 0:w.height),fixed:r,form:null==w?void 0:w.unit,to:t}),t=r.width,r=r.height,Object(U.b)(),X.createBackground({width:t,height:r,backgroundColor:_,isTransparent:!0}),n(!1),o.hide();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsxs)(m.j,{className:"create-canvas-model",visible:t,closable:!0,hideOkButton:!0,hideCancelButton:!0,onCancel:function(){n(!1)},children:[Object(h.jsxs)("div",{className:"model-content",children:[Object(h.jsx)("div",{className:"model-content__left",children:Object(h.jsx)("div",{style:S})}),Object(h.jsxs)("div",{className:"model-content__right",children:[Object(h.jsx)("div",{className:"model__title",children:"\u65b0\u5efa\u753b\u5e03"}),Object(h.jsx)("div",{className:"model-content__right__title",children:"\u753b\u5e03\u5c3a\u5bf8"}),Object(h.jsx)(I.Scrollbars,{className:"model-content__right__scroll",style:{height:"164px"},children:O.map((function(t,n){return Object(h.jsxs)("div",{onClick:function(){e(t)},className:x()({active:(null==t?void 0:t.id)===(null==w?void 0:w.id)},"model-content__right__scroll__item"),children:[t.name+("\u81ea\u7531\u8c03\u6574"!==t.name&&t.isCustom?" ".concat(t.width," x ").concat(t.height," ").concat(t.unit):""),t.isCustom?Object(h.jsx)(m.d,{name:"crossBold",fontSize:12,onClick:function(t){t.stopPropagation(),a.splice(n-1,1),i(Object(E.a)(a)),e(O[0])}}):null]},t.id)}))}),Object(h.jsxs)("div",{className:"model-content__right__number",children:[Object(h.jsx)(r,{width:+(null==w?void 0:w.width),height:+(null==w?void 0:w.height),canAutoCrop:W,precision:H.fixed,onChange:function(e,t){var n=e.width;e=e.height;T(Object(p.a)(Object(p.a)({},w),{},{width:+J(n||1),height:+J(e||1),name:"\u81ea\u7531\u8c03\u6574"}))},setCanAutoCrop:function(){q(!W),w.height===w.width?K(1):K(+w.height/+w.width)},maxVal:F(H.unit),minVal:G(H.unit)}),Object(h.jsx)(m.m,{value:H.unit,style:{width:120},onChange:function(e){V(B.find((function(t){return t.unit===e})))},suffixIcon:Object(h.jsx)(m.d,{name:"chevronDownBold",fontSize:16}),children:B.map((function(e){return Object(h.jsx)(d,{value:e.unit,children:e.name},e.unit)}))})]}),Object(h.jsx)(m.a,{block:!0,shape:"round",icon:Object(h.jsx)(m.d,{name:"plusFill",fontSize:12}),onClick:function(){var e=w.width,t=w.height,n=w.unit;a.unshift({name:"\u81ea\u5b9a\u4e49",width:e,height:t,unit:n,isCustom:!0,id:Math.random().toString()}),i(Object(E.a)(a))},children:"\u6dfb\u52a0\u4e3a\u81ea\u5b9a\u4e49\u5c3a\u5bf8"}),Object(h.jsx)("div",{className:"model-content__right__title",children:Object(h.jsx)(N.a,{color:_,setColor:function(e,t){v(t?"":e)},height:"20px",width:"38px",fastSelect:12,title:"\u753b\u5e03\u80cc\u666f"})}),Object(h.jsxs)("div",{className:"model-content__right__btn",children:[Object(h.jsx)(m.a,{shape:"round",className:"ant-btn-secondary",onClick:function(){n(!1)},children:"\u53d6\u6d88"}),Object(h.jsx)(m.a,{shape:"round",type:"primary",onClick:c,children:"\u786e\u5b9a"})]})]})]}),Object(h.jsx)(M.a,{})]})}function B(){var e=Object(y.c)((function(e){return e.editor.collapseModel.isLock})),t={};return Object(k.a)(t,te,e),Object(k.a)(t,"isLock",e),t}function H(){function e(e){i(e.target.value)}var t=Object(ee.c)(),n=Object(u.useState)(!1),r=(n=Object(j.a)(n,2))[0],c=n[1],a=(n=Object(u.useState)(""),(n=Object(j.a)(n,2))[0]),i=n[1],o=Object(y.c)((function(e){return e.downloadModel.download})),s=(n=Object(D.b)()).width,l=n.height,d=Object(y.b)((function(e){return e.downloadModel.setDownloadModelShow})),p=Object(u.useRef)(null),O=Object(D.m)(),g=Object(D.k)(),_=Object(D.c)(),v=(n=B(),Object(y.b)((function(e){return e.downloadModel.setCopyrightVisible})));return Object(u.useEffect)((function(){a!==_&&i(_)}),[_]),Object(u.useEffect)((function(){r&&p.current.focus()}),[r]),Object(h.jsxs)("div",{className:x()(n,"header-c-file__container"),children:[Object(h.jsx)(m.k,{content:function(){return Object(h.jsxs)("div",{className:x()("header-c-file__popover"),children:[Object(h.jsxs)("div",{className:"file__top",children:[Object(h.jsx)("div",{onClick:function(){c(!0)},children:r?Object(h.jsx)("div",{className:"file__top__input",children:Object(h.jsx)("input",{ref:p,type:"text",defaultValue:a,onChange:e,maxLength:50,onBlur:function(){a?g(a):i(_),c(!1)}})}):Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{className:"file__top__label",children:a}),Object(h.jsx)(m.d,{fontSize:20,name:"pen"})]})}),Object(h.jsxs)("div",{className:"file__top__tips",children:[s," x ",l," px"]})]}),Object(h.jsxs)("div",{className:"file__bottom",children:[Object(h.jsx)("div",{onClick:function(){var e;o?O(!0):m.j.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:"\u662f\u5426\u4e0b\u8f7d\u5f53\u524d\u56fe\u7247\uff1f",okText:"\u4e0b\u8f7d",cancelText:"\u4e0d\u7528\u4e86\uff0c\u8c22\u8c22",centered:!0,closable:!0,onOk:(e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window._stat_track("upload_picture_succeed",{source:"tpbj",open_type:"1"}),d(!0),v(!0),window._stat_track("picture_download_show",{source:"tpbj",open_type:"1"});case 4:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)}),onCancel:function(e){"close"!==e&&O(!0)}})},children:"\u65b0\u5efa\u753b\u5e03"}),Object(h.jsx)("div",{onClick:function(){t.openDuplicate()},children:"\u521b\u5efa\u526f\u672c"})]})]})},trigger:"hover",children:Object(h.jsx)(m.a,{children:"\u6587\u4ef6"})}),Object(h.jsx)(z,{})]})}function V(){var e=Object(u.useRef)(null),t=Object(A.a)(),n=Object(y.b)((function(e){return e.downloadModel.setDownloadModelShow})),r=Object(M.d)(),c=Object(y.c)((function(e){return e.downloadModel.download})),a=B().isLock,i=Object(y.b)((function(e){return e.downloadModel.setCopyrightVisible})),o=Object(y.b)((function(e){return e.stageModel})).setEnterType,s=function(){var t=Object(f.a)(Object(b.a)().mark((function t(r){var o;return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c||a?(window._stat_track("upload_picture_click",{source:"tpbj",wey:"top_bar",status:1}),null!=(o=e.current)&&o.click()):m.j.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:"\u662f\u5426\u4e0b\u8f7d\u5f53\u524d\u56fe\u7247\uff1f",okText:"\u4e0b\u8f7d",cancelText:"\u4e0d\u7528\u4e86\uff0c\u8c22\u8c22",centered:!0,closable:!0,onOk:function(){var e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window._stat_track("upload_picture_succeed",{source:"tpbj",open_type:"0"}),i(!0),window._stat_track("picture_download_show",{source:"tpbj",open_type:"1"}),n(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(t){window._stat_track("upload_picture_click",{source:"tpbj",wey:"top_bar",status:1}),"cancel"===t&&null!=(t=e.current)&&t.click()}});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),l=function(){var n=Object(f.a)(Object(b.a)().mark((function n(c){var a,i,u;return Object(b.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.show(),n.prev=1,o("open"),Object(U.b)(),n.next=6,Object(Se.d)(c);case 6:i=n.sent,u=i.base64,a=i.name,i=i.originalSize,t.createImg({imgSrc:u,width:0,height:0,name:a}),Ie.a.emit(Ae),window._stat_track("upload_picture_succeed",{source:"tpbj",wey:"canvas",status:1,original_size:i}),n.next=19;break;case 15:n.prev=15,n.t0=n.catch(1),r.hide(),"openError"===n.t0?m.j.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25\uff0c\u5efa\u8bae\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\uff08Chrome\uff09\u6253\u5f00\u54e6~",okText:"\u6211\u77e5\u9053\u4e86",centered:!0,hideCancelButton:!0,onOk:function(){var e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}):"close"!==n.t0&&null!=(u=e.current)&&u.click();case 19:case"end":return n.stop()}}),n,null,[[1,15]])})));return function(e){return n.apply(this,arguments)}}();return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{style:{marginRight:16},children:Object(h.jsx)(m.a,{onClick:s,children:"\u6253 \u5f00"})}),Object(h.jsx)("input",{ref:e,style:{display:"none"},type:"file",onChange:function(e){l(e.target.files[0]),e.target.value=""},accept:"image/jpeg,image/jpg,image/png,image/heic"})]})}function J(e){var t=Object(u.useRef)(null),n=Object(M.d)(),r=je().saveTemplate,c=(0,Object(X.p)().getMainLayer)(),a=e.disableOperate,i=e.userInfo,o=e.showWaterMark,s=(e=Object(u.useState)(0),(e=Object(j.a)(e,2))[0]),l=e[1],d=(e=Object(D.b)()).width,p=e.height,O=Object(Z.u)(),g=Object(Z.v)(),_=Object(Z.w)(),v=Object(D.n)(),w=Object(D.c)(),x=(Object(Ge.h)(),Object(D.d)()),k=Object(oe.a)().recordInfo,E=Object(ue.e)(),T=(Object(D.e)(),Object(D.i)()),S=(Object(y.c)((function(e){return e.editor.watermarkModel})).isVipTemplate,Object(y.c)((function(e){return e.editor.watermarkModel.thresholdIdList}))),I=Object(y.c)((function(e){return e.templateModel})).preview,A=Object(X.l)().drawAsync,C=Object(X.H)().getLayers,L=Object(D.g)(),N=Object(D.f)(),R=Object(y.b)((function(e){return e.downloadModel.setShowDownloadTip})),P=Object(y.b)((function(e){return e.downloadModel.setCopyrightVisible})),U=Object(y.b)((function(e){return e.editor.recordModel.getRecordId})),F=(e=Object(ue.b)()).isAutoSaving,G=e.isSaving,z=Object(u.useRef)(),B=(e=Object(u.useState)(Ze[0].value===Me.jpeg?Me.jpeg:Me.png),(e=Object(j.a)(e,2))[0]),H=e[1],V=(e=Object(u.useState)(Qe[0]),(e=Object(j.a)(e,2))[0]),J=e[1],Y=Object(u.useRef)(null),W=(e=Object(u.useState)(!1),(e=Object(j.a)(e,2))[0]),q=e[1],K=(e=Object(u.useState)(!1),(e=Object(j.a)(e,2))[0]),Q=e[1],$=(e=Object(u.useState)(!1),(e=Object(j.a)(e,2))[0]),ee=e[1],te=(e=Object(u.useState)(!1),(e=Object(j.a)(e,2))[0]),ne=e[1],se=(e=Object(u.useState)(!1),(e=Object(j.a)(e,2))[0],e[1]),le=(e=Object(u.useState)(!0),(e=Object(j.a)(e,2))[0]),be=e[1],pe=(e=Object(u.useState)(null!=i&&i.is_vip||S.length||k.threshold?qe.TYPE_COMMERCIAL:qe.TYPE_PERSONAL),(e=Object(j.a)(e,2))[0]),fe=(e[1],Object(ze.c)()),Oe=Object(y.b)((function(e){return e.editor.collapseModel.setCurrentType})),me=Object(ie.b)(),_e=Object(y.c)((function(e){return e.stageModel})).enterType,ve=(Object(y.c)((function(e){return e.editor.watermarkModel})).materialList,Object(y.c)((function(e){return e.sdk.historyManagerModel})).history),we=(e=Je()).isInIframe,xe=e.sendMessage,ye=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n,r,c,a,i,o;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=[],r=ve.get("history-main")||[],c=0;case 4:if(c<r.length)return i=r[c].id,e.next=8,de.b.getItemAsync(i);e.next=23;break;case 8:(i=e.sent).isAdjust&&n.push("10_40"),i.isEliminate&&(o=i.type===Ye.a.AI?"10_48":"10_41",n.push(o)),i.type===He.i.light&&n.push("10_42"),i.type===He.i.color&&n.push("10_44"),i.type===He.i.posterize&&n.push("10_45"),i.type===He.i.particulars&&n.push("10_43"),i.type===He.i.hsl&&n.push("10_46"),i.type===He.i.intelligentColor&&n.push("10_47"),Ne()(i.isMainFilter)&&n.push("11"),i.activeNewLayer&&((i.newInfo.layerType===ge.a.TEXT_LAYER||null!=(o=i.newInfo.data)&&o.isTextMaterial)&&n.push("12"),i.newInfo.layerType===ge.a.IMAGE_LAYER&&(i.newInfo.materialIds.size?n.push("14"):n.push("16_70")),i.newInfo.layerType===ge.a.WATERMARK&&n.push("18"),i.newInfo.layerType===ge.a.SVG_LAYER)&&n.push("13_61"),(null==i||null==(a=i.newInfo)?void 0:a.layerType)===ge.a.BACKGROUND_LAYER&&n.push("15");case 20:c++,e.next=4;break;case 23:t(Array.from(new Set(n)).join(",")),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(0),t("");case 29:case"end":return e.stop()}}),e,null,[[0,26]])})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ee=(Object(u.useEffect)((function(){!navigator.onLine&&K&&(Y.current=null,tt(!0),l(0),m.i.error("\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01"))}),[K,navigator.onLine]),Object(u.useEffect)((function(){var e;c&&(e=(null==c?void 0:c.data).maskURL||"png"===N||Ze[0].value!==Me.jpeg?Me.png:Me.jpeg,H(e),q("png"===e))}),[c]),Object(y.c)((function(e){return e.editor.watermarkModel.materialList}))),Te=(e=Object(y.c)((function(e){return e.editor.watermarkModel}))).materialIdList,Se=e.thresholdIdMap,Ie=Object(u.useCallback)(Object(f.a)(Object(b.a)().mark((function e(){var n,r;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearInterval(z.current),ne(!1),se(!0),ee(!1),tt(!1),we?(n=Y.current.toDataURL("image/".concat(B===Me.png?Me.png:Me.jpeg)),xe({url:n,suffix:B,id:U(),type:Ve.SAVE})):(R(!0),$||(null!=Y&&null!=(n=Y.current)&&n.imgFile?Object(Re.saveAs)(null==Y||null==(r=Y.current)?void 0:r.imgFile,"".concat(w,".").concat(B)):Object(Fe.a)(null==Y?void 0:Y.current,w,B,+V)),r={canvas:null==Y?void 0:Y.current,fileName:w,downloadImgSuffix:B,downloadImgQuality:+V},m.j.confirm({className:"download-success-modal",content:Object(h.jsx)(Be,{fileSave:r,onView:function(){fe.use(ce.b.MINE_MENU),Oe(ce.b.MINE_MENU),me(re.a.RECORD),P(!1),R(!1),t.current.destroy()}}),onInstance:function(e){t.current=e},hideCancelButton:!0,centered:!0,hideIcon:!0,closable:!0,hideOkButton:!0,onCancel:function(){R(!1),P(!1)},onOk:function(){R(!1),P(!1)}})),Y.current=null,k.material_id,$e.from,Ae(pe),Object(ke.c)().join(","),k.id&&k.id,(k.topic_id||$e.topicId)&&(k.topic_id||$e.topicId),(k.category_id||$e.categoryId)&&(k.category_id||$e.categoryId),$e.scene_id&&$e.scene_id,$e.collection_id&&$e.collection_id,($e.class||T.class)&&(T.class||$e.class),($e.query||T.query)&&(T.query||$e.query),($e.scm||T.scm)&&(T.scm||$e.scm),e.t0=window,e.t1="jpeg"===B?"jpg":B,e.t2="png"===B?"":100*+V,e.t3=Ee.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id)})).join(","),e.t4=Te.map((function(e){var t=(c=Se.get(e)||{type:"",typeId:"",isVip:!1,trackName:""}).type,n=c.typeId,r=c.isVip,c=c.trackName;return t?"".concat(t,"_").concat(n,"_").concat(e,"_").concat(Number(r),"_").concat(c||""):""})).join(","),e.next=23,ye();case 23:e.t5=e.sent,e.t6=_e,e.t7={format:e.t1,compress:e.t2,download_type:"1",vip_type:e.t3,material_id:e.t4,func_use_list:e.t5,enter_type:e.t6},e.t0._stat_track.call(e.t0,"tpbj_download_succeed",e.t7);case 27:case"end":return e.stop()}}),e)}))),[pe,k.material_id,k.id,k.topic_id,k.category_id,$,v,B,V,Te,Se,Ee,we]),Ae=function(e){return null!=i&&i.is_vip?(e||pe)===qe.TYPE_COMMERCIAL?"commercial_no":"personal_no":null!=i&&i.is_vip||(e||pe)!==qe.TYPE_COMMERCIAL?null!=i&&i.is_vip||!k.threshold?"personal_no":"personal_yes":"commercial_no"},et=(e=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(he.e)();case 2:e.sent&&et();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window._stat_track("tpbj_download_confirm_click",{source:"tpbj",format:"jpeg"===B?"jpg":B,compress:"png"===B?"":100*+V,icon_type:"1",vip_type:Ee.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id)})).join(","),material_id:Ee.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id,"_").concat(Number(e.isVip),"_").concat(e.trackName)})).join(",")}),G||F){if(F)return m.i.info("\u6b63\u5728\u4fdd\u5b58\u4e2d \u8bf7\u7a0d\u540e\u91cd\u8bd5"),e.abrupt("return");e.next=5}else e.next=6;break;case 5:return e.abrupt("return");case 6:t=(new Date).getTime(),n.show("\u4fdd\u5b58\u4e2d...",!0),O(!1),g(!1),_(!1),Q(!0),ee(!1),se(!1),ne(!1),Y.current=null,setTimeout(Object(f.a)(Object(b.a)().mark((function e(){var o,u,s,f,j;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a){e.next=18;break}return o=W?"png":"jpeg",e.next=5,C();case 5:return u=e.sent,e.next=8,A(d,p,o,null==(f=c.data)?void 0:f.maskURL,u);case 8:return s=e.sent,Ke.composite=(new Date).getTime()-t,f={caption:w,id:k.id||"",userInfo:i,isCropStage:x},j=(new Date).getTime(),e.next=14,r({layers:u,stageWidth:d,stageHeight:p,preview:I,name:v},ae.a.DOWNLOAD,o,f,s,L);case 14:Y.current=s,Ke.record_update=(new Date).getTime()-j,Xe||0===Ke.download||(window._stat_track("template_composite_durations",Ke),Xe=!0),n.hide();case 18:e.next=35;break;case 20:e.prev=20,e.t0=e.catch(0),n.hide(),Y.current=null,tt(!0),l(0),k.material_id,$e.from,Ae(pe),Object(ke.c)().join(","),k.id&&k.id,(k.topic_id||$e.topicId)&&(k.topic_id||$e.topicId),(k.category_id||$e.categoryId)&&(k.category_id||$e.categoryId),$e.scene_id&&$e.scene_id,$e.collection_id&&$e.collection_id,($e.class||T.class)&&(T.class||$e.class),($e.query||T.query)&&(T.query||$e.query),($e.scm||T.scm)&&(T.scm||$e.scm);case 35:case"end":return e.stop()}}),e,null,[[0,20]])}))),60),function e(n){window.requestAnimationFrame(Object(f.a)(Object(b.a)().mark((function r(){var c;return Object(b.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:Y.current?(c=(new Date).getTime(),te||(ne(!0),Y.current&&Ie(),l(100),P(!1),Ke.all_download=(new Date).getTime()-t,Ke.download=(new Date).getTime()-c,Xe)||0===Ke.record_update||(window._stat_track("template_composite_durations",Ke),Xe=!0)):100<=(c=n+Math.floor(50*Math.random()))?Y.current?(c=100,Y.current&&Ie(),l(100),P(!1)):(l(99),e(c=99)):(l(c),e(c));case 1:case"end":return r.stop()}}),r)}))))}(0);case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),tt=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Q(!1),t&&(ee(!0),Y.current=null,window._stat_track("tpbj_download_cancel",{format:"jpeg"===B?"jpg":B,compress:"png"===B?"":100*+V,vip_type:Ee.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id)})).join(","),material_id:Ee.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id,"_").concat(Number(e.isVip),"_").concat(e.trackName)})).join(",")}),window._stat_track("hb_export_backwindow_click",{"\u5206\u7c7b":"\u53d6\u6d88"}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),nt=(s=Object(h.jsxs)("div",{className:"m-download-wrap__composite-pic",children:[Object(h.jsx)("div",{className:"m-download-wrap__composite-pic__title",children:"\u6b63\u5728\u5bfc\u51fa\u56fe\u7247"}),Object(h.jsx)(Ce.a,{percent:s,status:"active",showInfo:!1,className:"m-download-wrap__composite-pic__progress"}),Object(h.jsx)("div",{className:"m-download-wrap__composite-pic__btn",onClick:function(){tt(!0),E(!1)},children:"\u53d6\u6d88"})]}),Object(h.jsx)(Le.a,{defaultValue:V,onChange:function(e){e!==V&&J(e),k.material_id,$e.from,Ae(pe),Object(ke.c)().join(","),k.id&&k.id,!k.topic_id&&!$e.topicId||k.topic_id||$e.topicId,!k.category_id&&!$e.categoryId||k.category_id||$e.categoryId,$e.scene_id&&$e.scene_id,$e.collection_id&&$e.collection_id,!$e.class&&!T.class||T.class||$e.class,!$e.query&&!T.query||T.query||$e.query,!$e.scm&&!T.scm||T.scm||$e.scm},className:"m-download-wrap__options",dropdownClassName:"m-download-wrap__options__dropdown",suffixIcon:Object(h.jsx)(m.d,{name:"chevronDownBold",fontSize:16}),children:Qe.map((function(e,t){return Object(h.jsxs)(We,{value:e,children:[100*+e,"% ",1==+e?"(\u65e0\u538b\u7f29)":""]},t)}))})),rt=Object(h.jsxs)("div",{className:"m-download-wrap__vipbtn",onClick:function(){var e;window._stat_track("tpbj_download_confirm_click",{source:"tpbj",format:"jpeg"===B?"jpg":B,compress:"png"===B?"":100*+V,icon_type:"0",vip_type:Ee.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id)})).join(","),material_id:Ee.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id,"_").concat(Number(e.isVip),"_").concat(e.trackName||"")})).join(",")}),Object(Pe.a)()?(Object(ke.c)(),e={entrance:"save",source:"tpbj",vip_type:Ee.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id)})).join(","),material_id:Ee.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id,"_").concat(Number(e.isVip),"_").concat(e.trackName)})).join(",")},Object(he.f)(e)):Object(he.e)()},children:[Object(h.jsx)(m.d,{name:"vipDiamondBold",fontSize:24}),"\u5f00\u901a\u4f1a\u5458\u514d\u8d39\u4e0b\u8f7d"]}),ct=we?"\u4fdd\u5b58":"\u4e0b\u8f7d",at=Object(h.jsx)("div",{className:"m-download-wrap__btn",onClick:i?et:e,children:i?ct:"\u767b\u5f55\u8d26\u53f7\u7acb\u5373".concat(ct)});return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{className:"m-download-wrap",onClick:function(e){return e.stopPropagation()},children:[Object(h.jsx)("div",{className:"m-download-wrap__title",children:"\u4e0b\u8f7d\u4f5c\u54c1"}),Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{className:"m-download-wrap__subtitle",children:"\u4f5c\u54c1\u7c7b\u578b"}),Object(h.jsx)(Le.a,{value:B,className:"m-download-wrap__options",onChange:function(e){e!==B&&(H(e),"png"===e?(J(Qe[0]),q(!0)):q(!1)),k.material_id,e.toUpperCase(),$e.from,Ae(pe),Object(ke.c)().join(","),k.id&&k.id,!k.topic_id&&!$e.topicId||k.topic_id||$e.topicId,!k.category_id&&!$e.categoryId||k.category_id||$e.categoryId,$e.scene_id&&$e.scene_id,$e.collection_id&&$e.collection_id,!$e.class&&!T.class||T.class||$e.class,!$e.query&&!T.query||T.query||$e.query,!$e.scm&&!T.scm||T.scm||$e.scm},dropdownMatchSelectWidth:!1,dropdownClassName:"m-download-wrap__options__dropdown",suffixIcon:Object(h.jsx)(m.d,{name:"chevronDownBold",fontSize:16}),children:Ze.map((function(e,t){return Object(h.jsx)(We,{value:e.value,children:e.label},t)}))}),!W&&nt]}),S.length&&o?Object(h.jsx)(De.a,{count:S.length,show:le,isImageEditor:!0,onClick:function(){return be(!le)},children:Object(h.jsx)(Ue.a,{list:Ee})}):null,function(){if(null==i||!i.is_vip){if(k.threshold)return rt;if(S.length)return rt}return!o||null!=i&&i.is_vip?at:rt}()]}),Object(h.jsx)(m.j,{visible:K,width:300,onCancel:function(){return tt(!0)},maskClosable:!1,centered:!0,footer:null,children:s})]})}function Y(){var e=Object(u.useState)(!1),t=(e=Object(j.a)(e,2))[0],n=e[1],r=(e=Object(u.useState)(tt.PRE),(e=Object(j.a)(e,2))[0]),c=(e=(e[1],Object(u.useState)(1)),(e=Object(j.a)(e,2))[0]),a=e[1];return Object(u.useEffect)((function(){}),[]),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(m.j,{title:"\u6a21\u5f0f\u9009\u62e9",visible:t,onOk:function(){window.location.href=window.location.href+"&preview="+c},okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onCancel:function(){n(!1),a(1)},children:[Object(h.jsxs)("p",{children:["\u5f53\u524d\u73af\u5883\uff1a",r===tt.PRE?"\u6d4b\u8bd5\u73af\u5883":"\u9884\u53d1\u73af\u5883"]}),Object(h.jsxs)(m.l.Group,{onChange:function(e){a(e.target.value)},value:c,children:[Object(h.jsx)(m.x,{title:"\u6b64\u6a21\u5f0f\u4e0b\uff0c\u5c55\u793a\u9884\u53d1\u5e03+\u6b63\u5f0f\u72b6\u6001\u7684\u6240\u6709\u7d20\u6750\u6570\u636e\uff08\u9690\u85cf\u9664\u5916\uff09\u3002",placement:"bottom",children:Object(h.jsx)(m.l,{value:1,children:"\u6df7\u5408\uff08\u9884\u53d1\u5e03+\u6b63\u5f0f\uff09"})}),Object(h.jsx)(m.x,{title:"\u6b64\u6a21\u5f0f\u4e0b\uff0c\u5c55\u793a\u4ec5\u6b63\u5f0f\u72b6\u6001\u7684\u6240\u6709\u7d20\u6750\u6570\u636e\uff08\u9690\u85cf\u9664\u5916\uff09\u3002",placement:"bottom",children:Object(h.jsx)(m.l,{value:0,children:"\u4ec5\u6b63\u5f0f"})})]}),Object(h.jsx)("p",{})]})})}function W(){return Object(y.b)((function(e){return e.customAdModel.setShow}))}function q(){var e=Object(D.m)(),t=Object(D.k)(),n=Object(u.useState)([]),r=(n=Object(j.a)(n,2))[0],c=n[1];function a(e){!0!==e.ctrlKey&&!0!==e.metaKey||61!==e.keyCode&&107!==e.keyCode&&173!==e.keyCode&&109!==e.keyCode&&187!==e.keyCode&&189!==e.keyCode||e.preventDefault()}i=Object(M.d)(),o=xt().createStageByUrl,s=Object(A.a)(),l=Object(y.b)((function(e){return e.stageModel})).setEnterType;var i,o,s,l,d=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n,r,c,a,u;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.show(),l("open"),e.prev=2,e.next=5,yt(t);case 5:return c=e.sent,n=c.base64,r=c.name,c=c.originalSize,e.next=11,o(n);case 11:return Object(U.b)(),s.createImg({imgSrc:n,width:0,height:0,name:r}),Ie.a.emit(Ae),e.next=16,Object(ge.l)(n);case 16:return a=e.sent,u=a.width,a=a.height,i.hide(),e.abrupt("return",{width:u,height:a,originalSize:c||""});case 23:return e.prev=23,e.t0=e.catch(2),i.hide(),"openError"===e.t0?m.j.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:"\u56fe\u7247\u52a0\u8f7d\u5931\u8d25\uff0c\u5efa\u8bae\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\uff08Chrome\uff09\u6253\u5f00\u54e6~",okText:"\u6211\u77e5\u9053\u4e86",centered:!0,hideCancelButton:!0,onOk:function(){var e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}):(u=document.querySelector(".l-select__input"),"close"!==e.t0&&u.click()),e.abrupt("return",{width:0,height:0,originalSize:""});case 28:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(t){return e.apply(this,arguments)}}(),p=(n=Object(u.useState)(!1),(n=Object(j.a)(n,2))[0]),O=n[1],g=Object(M.d)(),_=xt().createStageByUrl,v=Object(y.b)((function(e){return e.templateModel.setIsInit})),w=Object(y.b)((function(e){return e.editor.collapseModel.setCurrentType})),k=(0,Object(me.b)().showUserInfo)(),E=Object(oe.c)(),T=Object(A.a)(),S=Object(y.b)((function(e){return e.stageModel.setNaturalImage})),I=function(){var e=Object(f.a)(Object(b.a)().mark((function e(n){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g.show(),e.next=3,_(n.url);case 3:Object(U.b)(),g.hide(),v(!0),S(n.url),t(n.name),Ie.a.emit(Ae);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=Object(y.b)((function(e){return e.stageModel})).setEnterType,L=(Object(u.useEffect)((function(){k||Object(Pe.a)()?function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p||r.length)return e.abrupt("return");e.next=2;break;case 2:return O(!0),e.prev=3,e.next=6,Object(be.d)({cursor:"",type:"1"});case 6:t=(t=e.sent).data.data.lists,c(t.splice(0,3)),O(!1),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(3),c([]),O(!1);case 17:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(){return e.apply(this,arguments)}}()():c([])}),[k]),Object(u.useEffect)((function(){function e(e){e.preventDefault()}var t,n=document.getElementById("selectImage"),r=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n,r,c,a;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=null==(n=t.dataTransfer)?void 0:n.files[0],r=(null==n||null==(r=n.name)?void 0:r.lastIndexOf("."))||0,c=(null==n||null==(c=n.name)||null==(c=c.substring(r))?void 0:c.toLowerCase())||"",n&&(Tt.b.includes(n.type)||Tt.b.includes(c)))return window._stat_track("upload_picture_click",{source:"tpbj",wey:"drag",status:0}),Object(U.b)(),e.next=9,d(n);e.next=14;break;case 9:a=(a=e.sent).originalSize,window._stat_track("upload_picture_succeed",{source:"tpbj",wey:"drag",status:0,original_size:a}),e.next=15;break;case 14:n&&kt.a.warning("\u6682\u65f6\u53ea\u652f\u6301JPG/JPEG/PNG/HEIC\u683c\u5f0f\u56fe\u7247");case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n,r,c,a,i;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.clipboardData&&t.clipboardData.items,r=null,!n||!n.length){e.next=12;break}c=0;case 5:if(c<n.length){if(-1!==n[c].type.indexOf("image"))return r=n[c].getAsFile(),e.abrupt("break",12);e.next=9}else e.next=12;break;case 9:c++,e.next=5;break;case 12:if(i=(null==(i=r)||null==(i=i.name)?void 0:i.lastIndexOf("."))||"",i=null==(a=r)||null==(a=a.name)||null==(a=a.substr(i))?void 0:a.toLowerCase(),r&&(Tt.b.includes(r.type)||Tt.b.includes(i)))return Object(U.b)(),e.next=18,d(r);e.next=23;break;case 18:a=e.sent,i=a.originalSize,window._stat_track("upload_picture_succeed",{source:"tpbj",wey:"quick",status:0,original_size:i}),e.next=24;break;case 23:r?kt.a.warning("\u6682\u65f6\u53ea\u652f\u6301JPG/JPEG/PNG/HEIC\u683c\u5f0f\u56fe\u7247"):kt.a.warning("\u672a\u5728\u526a\u8d34\u677f\u68c0\u67e5\u5230\u56fe\u7247\uff0c\u53ef\u76f4\u63a5\u6253\u5f00\u56fe\u7247\u6216\u62d6\u52a8\u56fe\u7247\u5230\u6b64\u9875\u9762\u6253\u5f00~");case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return document.addEventListener("paste",c),null!=(t=n)&&t.addEventListener("dragover",e,!1),null!=(t=n)&&t.addEventListener("drop",r,!1),document.addEventListener("keydown",a,!1),function(){var t;null!=(t=n)&&t.removeEventListener("dragover",e,!1),null!=(t=n)&&t.removeEventListener("drop",r,!1),document.removeEventListener("paste",c),document.removeEventListener("keydown",a,!1),n=null}}),[]),function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n,r,a,i,o,u,s,l;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,O(!0),C("record"),e.prev=3,e.next=6,Object(be.e)({id:String(n)});case 6:if(s=e.sent,r=s.data.data,s=r.records,a=r.editor_version,i=r.original_image,l=r.caption,s=JSON.parse(s||"{}"),o=null==i||null==(o=i.match(/[^\.]\w*$/))?void 0:o[0],Object(U.b)(),0<s.length)return e.next=15,T.initLayers(s,{naturalFileName:l||"",naturalImage:i||"",naturalFileSize:0,naturalFileSuffix:o||""},a);e.next=18;break;case 15:E({id:n}),e.next=23;break;case 18:kt.a.warn("\u5f53\u524d\u4f5c\u56fe\u8bb0\u5f55\u56e0\u5386\u53f2\u539f\u56e0\uff0c\u65e0\u6cd5\u6b63\u5e38\u52a0\u8f7d\uff0c\u53ea\u80fd\u4f5c\u4e3a\u56fe\u7247\u4f7f\u7528\u3002"),(u=new Image).crossOrigin="",u.onload=function(){var e=Object(Et.lb)(u);T.createImg({imgSrc:e,width:0,height:0,name:r.caption})},u.src=r.original_image;case 23:E({id:n}),e.next=38;break;case 26:return e.prev=26,e.t0=e.catch(3),O(!1),kt.a.warning("\u627e\u4e0d\u5230\u8be5\u4f5c\u56fe\u8bb0\u5f55,\u8bf7\u91cd\u65b0\u9009\u62e9"),O(!0),e.next=34,Object(be.d)({cursor:"",type:"1"});case 34:s=e.sent,l=s.data.data.lists,c(l.splice(0,3)),O(!1);case 38:return e.prev=38,Ie.a.emit(Ae),e.finish(38);case 41:case"end":return e.stop()}}),e,null,[[3,26,38,41]])})));return function(t){return e.apply(this,arguments)}}());return Object(h.jsx)("div",{id:"selectImage",className:"l-select",children:Object(h.jsx)("div",{className:"l-select__open",children:Object(h.jsxs)("div",{children:[Object(h.jsx)("div",{children:Object(h.jsxs)(m.a,{type:"primary",shape:"round",onClick:function(){window._stat_track("upload_picture_click",{source:"tpbj",wey:"canvas",status:0})},children:["\u6253\u5f00\u56fe\u7247",Object(h.jsx)("input",{className:"l-select__input",type:"file",title:"",onChange:function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d(t.target.files[0]);case 2:(n=(n=e.sent).originalSize)&&v(!0),window._stat_track("upload_picture_succeed",{source:"tpbj",wey:"canvas",status:0,original_size:n}),t.target.value="";case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),accept:"image/jpeg,image/jpg,image/png,image/heic"})]})}),Object(h.jsxs)("div",{className:"l-select__open__tips",children:["\u4e5f\u652f\u6301\u7c98\u8d34\u4e0e\u62d6\u62fd\u56fe\u7247\u81f3\u6b64\u9875\u9762\u6253\u5f00\u6216",Object(h.jsx)("span",{onClick:function(){e(!0)},children:"\u65b0\u5efa\u753b\u5e03"})]}),Object(h.jsxs)("div",{className:"l-select__open__demo",children:[Object(h.jsx)("div",{className:"l-select__open__demo__title",children:Object(h.jsx)("span",{children:r.length?Object(h.jsxs)("span",{className:"cursor record",onClick:function(){w(ce.b.MINE_MENU)},children:["\u4f5c\u56fe\u8bb0\u5f55",Object(h.jsx)(m.d,{name:"chevronRight",fontSize:14})]}):"\u8bd5\u8bd5\u6837\u7247"})}),Object(h.jsx)(m.r,{spinning:p,children:Object(h.jsx)("div",{className:x()("l-select__open__demo__imgs",{separator:!r.length}),children:r.length||p?r.map((function(e,t){return Object(h.jsx)("div",{onClick:Object(f.a)(Object(b.a)().mark((function t(){return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window._stat_track("upload_picture_click",{source:"tpbj",wey:"recently",status:0}),t.next=3,L(e);case 3:window._stat_track("upload_picture_succeed",{source:"tpbj",wey:"recently",status:0,original_size:""});case 4:case"end":return t.stop()}}),t)}))),children:Object(h.jsx)("img",{src:"".concat(Object(Et.nb)(e.preview,144)),alt:""})},e.id)})):pe.i.map((function(e,t){return Object(h.jsx)("div",{onClick:Object(f.a)(Object(b.a)().mark((function t(){return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return window._stat_track("upload_picture_click",{source:"tpbj",wey:"try",status:0}),t.next=3,I(e);case 3:window._stat_track("upload_picture_succeed",{source:"tpbj",wey:"try",status:0,original_size:""});case 4:case"end":return t.stop()}}),t)}))),children:Object(h.jsx)("img",{src:"".concat(e.url,"!thumb-w108"),alt:""})},t)}))})})]})]})})})}function K(e){var t=e.prevText,n=e.nextText,r=e.content,c=e.showStepCount,a=e.currentStepCount;e=e.allCount;return Object(h.jsxs)("div",{className:"c-steps-wrapper",children:[c?Object(h.jsx)("div",{className:"c-steps-wrapper__count",children:"\u7b2c".concat(a,"/").concat(e,"\u6b65")}):null,Object(h.jsx)("div",{className:"c-steps-wrapper__content",children:r}),Object(h.jsxs)("div",{className:"c-steps-wrapper__btns",children:[t?Object(h.jsx)("button",{className:"c-steps-wrapper__btns-prev",children:t}):null,n?Object(h.jsx)("button",{className:"c-steps-wrapper__btns-next",children:n}):null]})]})}n(1099),n(315),n(31);var X=n(10),Z=n(22),Q=(i=(m.m.Option,n(15)),n.n(i)),$=[{width:0,height:0,unit:R.px,name:"\u81ea\u7531\u8c03\u6574",isCustom:!1,id:Object(a.a)()},{width:900,height:383,unit:R.px,name:"\u516c\u4f17\u53f7\u9996\u56fe",isCustom:!1,id:Object(a.a)()},{width:200,height:200,unit:R.px,name:"\u516c\u4f17\u53f7\u6b21\u56fe",isCustom:!1,id:Object(a.a)()},{width:1080,height:1080,unit:R.px,name:"\u670b\u53cb\u5708\u5c01\u9762",isCustom:!1,id:Object(a.a)()},{width:1920,height:1080,unit:R.px,name:"\u7535\u8111\u58c1\u7eb8",isCustom:!1,id:Object(a.a)()},{width:500,height:500,unit:R.px,name:"Logo\u8bbe\u8ba1",isCustom:!1,id:Object(a.a)()},{width:800,height:800,unit:R.px,name:"\u65b9\u5f62\u4e3b\u56fe",isCustom:!1,id:Object(a.a)()}],ee=(n(1100),n(374)),te=(n(1101),"c-disable-app"),ne=o.a.memo((function(){function e(e){var t;return!(null==(e=e.target)||null==(e=e.className)||null==(t=e.includes)||!t.call(e,te))}var t=Object(y.b)((function(e){return e.editor.collapseModel.setIsLock})),n=Object(u.useRef)(null),r=Object(y.c)((function(e){return e.editor.collapseModel.isLock})),c=Object(X.A)(),a=!(null==c||null==(c=c.data)||!c.url);return Object(u.useEffect)((function(){t(!a)}),[a]),Object(u.useEffect)((function(){var t,c;if(r)return t=function(t){var r;n.current&&e(t)&&(r=t.x,t=t.y,n.current.style.top=t+20+"px",n.current.style.left=r+20+"px",n.current.style.display="flex")},c=function(t){n.current&&e(t)&&(n.current.style.display="none")},document.addEventListener("mousemove",t),document.addEventListener("mouseout",c),function(){document.removeEventListener("mousemove",t),document.removeEventListener("mouseout",c)}}),[r]),r?Object(h.jsx)("div",{ref:n,className:"c-disable-app__text",children:"\u5148\u6253\u5f00\u56fe\u7247\uff0c\u518d\u5f00\u59cb\u64cd\u4f5c\u5427"}):null})),re=n(282),ce=n(28),ae=n(257),ie=n(386),oe=n(107),ue=n(119),se=n(151),le=n(423),de=n(34),be=n(177),pe=n(55),fe=n(286),je=function(){var e=Object(y.c)((function(e){return e.templateModel.preview})),t=Object(y.b)((function(e){return e.templateModel.setPreview})),n=Object(oe.c)(),r=(l=Object(ue.b)()).isAutoSaving,c=l.isSaving,a=Object(ue.e)(),i=Object(ue.d)(),o=Object(ue.f)(),s=Object(ue.c)(),l=Object(u.useState)(!1),d=((l=Object(j.a)(l,2))[0],l[1]),O=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t,n,r){var c,a,i,o,u,s,l,d;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=t.width,a=t.height,o=400/(c/a),s=Object(le.a)(400,o),u=s.canvas,s.ctx.drawImage(t,0,0,c,a,0,0,400,o),s="png"===n?"image/png":"image/jpeg",c=u.toDataURL(s,.8),e.next=17,Object(se.c)(c);case 17:return a=e.sent,i=a.url,e.next=21,Object(le.c)(c);case 21:return o=e.sent,u=o.width,s=o.height,e.abrupt("return",{url:i,width:u,height:s});case 27:return e.prev=27,e.t0=e.catch(0),e.next=31,Object(le.c)(r);case 31:return d=e.sent,l=d.width,d=d.height,e.abrupt("return",{width:l,height:d,url:r});case 35:case"end":return e.stop()}}),e,null,[[0,27]])})));return function(t,n,r){return e.apply(this,arguments)}}(),h=function(){var e=Object(f.a)(Object(b.a)().mark((function e(r,c,a,i){var o,u,s;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(i,r,c);case 2:return s=e.sent,o=s.url,u=s.width,s=s.height,t(o),e.prev=7,e.next=10,Object(fe.d)({id:a,height:s,width:u,type:"1",preview:o});case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7);case 15:n({id:a,isRecording:!1});case 16:case"end":return e.stop()}}),e,null,[[7,12]])})));return function(t,n,r,c){return e.apply(this,arguments)}}();l=function(){var t=Object(f.a)(Object(b.a)().mark((function t(i,u,l,f,j,O){var g,_,v,w;return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(g={source:"",data:""},navigator.onLine){t.next=3;break}throw"\u7f51\u7edc\u5df2\u65ad\u5f00\uff0c\u8bf7\u8054\u7f51\u540e\u91cd\u8bd5";case 3:if(c||r){if(r)return m.i.info("\u6b63\u5728\u4fdd\u5b58\u4e2d \u8bf7\u7a0d\u540e\u91cd\u8bd5"),t.abrupt("return");t.next=7}else t.next=8;break;case 7:return t.abrupt("return");case 8:if(a(!0),n({isRecording:!0}),d(!0),_="",O)return v=de.a.getCode(O),t.next=18,de.a.getRemoteUrlAsync(v);t.next=19;break;case 18:_=t.sent;case 19:return t.next=21,Object(be.f)(Object(p.a)({type:"1",original_image:_,records:JSON.stringify(i.layers),editor_version:pe.h},f||{}));case 21:return v=t.sent,(w=null==v||null==(w=v.data)||null==(w=w.data)?void 0:w.id)&&(n({id:w}),s(),h(l,e,w,j)),d(!1),a(!1),o(u),t.abrupt("return",{data:g.data,source:g.source});case 28:case"end":return t.stop()}}),t)})));return function(e,n,r,c,a,i){return t.apply(this,arguments)}}();return{autoSaveTemplate:function(){var e=Object(f.a)(Object(b.a)().mark((function e(t,n){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(!0),i(!1),n&&n();case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),saveTemplate:l,isSaving:c}},Oe=n(29),me=n(89),he=n(64),ge=n(23),_e=n(86),ve=o.a.memo((function(){Object(ge.x)(["ctrl+shift+e","Command+Shift+e"],(function(){U()}));var e=Object(M.d)(),t=Object(X.p)().getMainLayer,n=je().saveTemplate,r=Object(Z.f)(),c=B().isLock,a=Object(ge.A)(),i=Object(Z.u)(),o=(r=r||c,(c=Object(D.b)()).width),s=c.height,l=Object(D.n)(),d=Object(y.c)((function(e){return e.templateModel})).preview,p=Object(oe.c)(),j=Object(ue.e)(),O=(c=Object(ue.b)()).saveTooltipText,g=c.isSaving,_=c.isAutoSaving,v=(c=c.saveType,Object(Oe.d)()),w=Object(ie.b)(),x=Object(y.b)((function(e){return e.editor.collapseModel.setCurrentType})),k=Object(X.E)(),E=Object(me.b)().showUserInfo,T=Object(X.l)().drawAsync,S=Object(X.H)().getLayers,I=Object(X.p)().getLayers,A=Object(D.g)(),C=Object(D.c)(),L=Object(D.d)(),N=Object(oe.a)().recordInfo,R=Object(_e.b)(),P=Object(y.c)((function(e){return e.stageModel.naturalFileSuffix})),U=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var r,c;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=3;break}return m.i.error("\u7f51\u7edc\u9519\u8bef\uff1a\u8bf7\u91cd\u8bd5\u6216\u68c0\u67e5\u60a8\u7684\u7f51\u7edc\u72b6\u6001"),e.abrupt("return");case 3:if(0===k.length)return e.abrupt("return");e.next=5;break;case 5:if(r=E()){e.next=9;break}return Object(he.e)(),e.abrupt("return");case 9:i(!1),j(!0),p({isRecording:!0}),c=t(),setTimeout(Object(f.a)(Object(b.a)().mark((function e(){var t,a,i,u;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=I(),e.next=4,Object(ge.f)(t,R);case 4:return e.next=6,S();case 6:return a=e.sent,e.next=9,T(o,s,P,null==(t=c.data)?void 0:t.maskURL,a);case 9:return i=e.sent,u={caption:C,id:N.id||"",userInfo:r,isCropStage:L},e.next=13,n({layers:a,stageWidth:o,stageHeight:s,preview:d,name:l},ae.a.HANDLE,P,u,i,A);case 13:m.i.success({content:Object(h.jsxs)("span",{children:["\u5df2\u4e0a\u4f20\u81f3\u6211\u7684\u4f5c\u56fe\u8bb0\u5f55\u4e2d",Object(h.jsx)("span",{style:{color:"#6C8EE5",marginLeft:4,cursor:"pointer"},onClick:F,children:"\u67e5\u770b"})]})}),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(0),p({isRecording:!1});case 22:return e.prev=22,j(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,17,22,25]])}))),100);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){v.use(ce.b.MINE_MENU),x(ce.b.MINE_MENU),w(re.a.RECORD)},G=(r=(Object(u.useEffect)((function(){a||e.hide()}),[a]),Object(h.jsxs)("div",{children:[_||g||O?null:Object(h.jsx)(m.d,{onClick:function(){U()},disable:r,type:"button",name:"cloudUpload",fontSize:24,text:"\u4fdd\u5b58\u4f5c\u56fe\u8bb0\u5f55",width:24}),_||g?Object(h.jsx)(m.d,{disable:r,type:"button",name:"loop",width:24,text:"\u4e0a\u4f20\u4e2d...",fontSize:24}):null,_||g||!O?null:Object(h.jsx)(m.d,{onClick:function(){U()},disable:r,type:"button",name:"cloudUploadSuccess",text:O||"",fontSize:24,width:24})]})),O=Object(h.jsx)("div",{className:"p-header__save-btn__popover",children:Object(h.jsx)("div",{className:"p-header__save-btn__record",onClick:function(){return F()},children:"\u6211\u7684\u4f5c\u56fe\u8bb0\u5f55"})}),r);return c!==ae.a.HANDLE||_||g?Object(h.jsx)(h.Fragment,{children:G}):Object(h.jsx)(m.k,{content:O,overlayClassName:"save-btn__popover",trigger:"hover",children:r})})),we=n(24),xe=n(513),ye=o.a.memo((function(){var e=Object(we.d)(),t=Object(we.a)(),n=Object(we.b)(),r=Object(we.c)(),c=Object(Z.u)(),a=Object(Z.v)(),i=Object(Oe.d)(),o=i.use,s=i.getCurFeature;return Object(u.useEffect)((function(){function e(e){var t;(e.isEliminate||e.isMainFilter)&&(t=s(),Object(xe.a)(t))&&o(ce.b.ADJUST_MENU),e.isEliminate||c(!1),e.isIntelligent||a(!1)}r.onBeforeRedo((function(t){e(t)})),r.onBeforeUndo((function(t){e(t)}))}),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(m.x,{placement:"bottom",title:"\u64a4\u9500",children:Object(h.jsx)("div",{style:{marginLeft:76},children:Object(h.jsx)(m.d,{onClick:function(){e.undo()},disable:!n,type:"button",name:"undo",fontSize:24})})}),Object(h.jsx)(m.x,{placement:"bottom",title:"\u91cd\u505a",children:Object(h.jsx)("div",{style:{margin:"0 7px"},children:Object(h.jsx)(m.d,{onClick:function(){e.redo()},disable:!t,type:"button",name:"redo",fontSize:24})})})]})})),ke=(n(1108),n(53)),Ee=n(104),Te=o.a.memo((function(){var e=(0,Object(me.b)().showUserInfo)(),t=Object(u.useState)(""),n=(t=Object(j.a)(t,2))[0],r=t[1],c=(t=Object(u.useState)(""),t=((t=Object(j.a)(t,2))[0],t[1],Object(u.useState)({})),(t=Object(j.a)(t,2))[0]),a=t[1],i=Object(y.c)((function(e){return e.editor.watermarkModel.materialList}));Object(u.useEffect)((function(){!function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ke.b)();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),Object(u.useEffect)((function(){!function(){var t=Object(f.a)(Object(b.a)().mark((function t(){var n,r,c;return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Ee.a)();case 2:r=t.sent,n="".concat("https://feedback.meitu.com","/im?client_id=").concat(pe.a,"&track_from=\u56fe\u7247\u7f16\u8f91&client_orign=").concat(window.location.origin||""),r={gid:r||"",language:"zh_CN",channel:"",theme:"light"},c={vipType:(null==e?void 0:e.is_vip)||!1,screenName:(null==e?void 0:e.screen_name)||"",avatar:(null==e?void 0:e.avatar)||""},a({iframeUrl:n,appInfo:r,userInfo:c});case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}),[e]);var o=Object(y.c)((function(e){return e.editor.watermarkModel})).materialList;t=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t,n,r;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(he.b)();case 2:if(t=e.sent,n={entrance:"open",source:"tpbj",vip_type:function(){var e="";return Array.from(new Set(o)).forEach((function(t){e+="".concat(t.type,"_").concat(t.typeId,"_").concat(t.id,",")})),e}(),material_id:i.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id,"_").concat(Number(e.isVip),"_").concat(e.trackName)})).join(",")},r=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&Object(he.f)(n);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t){e.next=16;break}return e.next=8,Object(he.e)();case 8:if(e.sent)return e.next=12,Object(he.b)();e.next=14;break;case 12:e.sent,Object(he.f)(n);case 14:return setTimeout(r,1e3),e.abrupt("return");case 16:r();case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)(me.a,{userInfo:e,showContactMessage:!0,showKeyboardKeymap:!1,showFeedBack:!0,onJumpToLogin:he.e,onHandleLogout:he.c,onHandleUserInfo:he.d,feedBackSrc:n,accountCallbackUrl:he.a,onHandleOpenVipModal:t,onPayFailCallback:he.c,onPaySuccessCallback:he.b,businessMessengerConfig:c,onTrack:function(e){window._stat_track("photo_click",{class:e||""})}})})),Se=n(350),Ie=(n(1110),n(19)),Ae="AFTER_CREATE_IMAGE_EVENT",Ce=(n(368),n(308)),Le=(n(369),n(174)),Ne=(i=n(298),n.n(i)),Me=(n(1111),n(630),function(e){return e.jpeg="jpeg",e.png="png",e}({})),Re=n(220),Pe=n(142),Ue=n(664),De=n(665),Fe=n(281),Ge=n(179),ze=n(276),Be=(n(1114),o.a.memo((function(e){e.isCommercial;var t=e.onView,n=(e.onCommercial,e.fileSave);return Object(h.jsxs)("div",{className:"download-success",style:{width:"100%"},children:[Object(h.jsx)("div",{className:"download-success-title",children:"\u4f5c\u54c1\u4e0b\u8f7d\u6210\u529f"}),Object(h.jsx)("div",{className:"download-success-record",children:Object(h.jsx)("div",{children:"\u4f5c\u54c1\u5df2\u81ea\u52a8\u4fdd\u5b58\u81f3\u4f5c\u56fe\u8bb0\u5f55"})}),Object(h.jsxs)("div",{className:"download-success-footer",children:[Object(h.jsx)(m.a,{size:"small",type:"primary",className:"download-success-footer__btn",style:{width:"125px",height:"36px"},onClick:function(){t&&t()},children:"\u67e5\u770b\u4f5c\u56fe\u8bb0\u5f55"}),Object(h.jsx)("div",{}),Object(h.jsx)("div",{children:Object(h.jsx)("span",{onClick:Object(f.a)(Object(b.a)().mark((function e(){var t,r,c,a,i,o;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.fileName,r=n.downloadImgSuffix,c=n.canvas,a=n.downloadImgQuality,window.showSaveFilePicker)return e.next=5,window.showSaveFilePicker({suggestedName:"".concat(t,".").concat(r),types:[{description:"jpg file",accept:{"image/jpg":[".jpg"]}},{description:"png file",accept:{"image/png":[".png"]}}]});e.next=13;break;case 5:return i=e.sent,e.next=8,i.createWritable();case 8:o=e.sent,"png"===r&&(a=1),c.toBlob(function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.write(t);case 2:return e.next=4,o.close();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r,a),e.next=14;break;case 13:Object(Fe.a)(c,t,r,a);case 14:case"end":return e.stop()}}),e)}))),children:"\u70b9\u51fb\u4e0b\u8f7d\u4f5c\u54c1"})})]})]})}))),He=n(41),Ve=function(e){return e.SAVE="save",e.LOADED="loaded",e.OPEN="open",e}({}),Je=function(){var e=Object(u.useState)(!1),t=(e=Object(j.a)(e,2))[0],n=e[1];return Object(u.useEffect)((function(){"image-editor-sdk"===v.a.parse(window.location.search).origin&&n(!0)}),[]),{isInIframe:t,sendMessage:function(e){var t;null!=(t=window)&&t.parent&&window.parent.postMessage(e,"*")}}},Ye=n(52),We=Le.a.Option,qe=function(e){return e.TYPE_COMMERCIAL="commercial",e.TYPE_PERSONAL="personal",e}({}),Ke={template_id:"",font_num:0,layer_num:0,canvas_size:"",download:0,all_download:0,composite:0,record_update:0},Xe=!1,Ze=[{value:"jpeg",label:"JPG \u53ef\u8c03\u6574\u753b\u8d28\uff0c\u4e0d\u652f\u6301\u900f\u660e\u80cc\u666f"},{value:"png",label:"PNG \u652f\u6301\u900f\u660e\u80cc\u666f"}],Qe=["1","0.8","0.7","0.5","0.2"],$e=v.a.parse(window.location.search),et=o.a.memo((function(e){function t(){return Object(h.jsx)(m.a,{type:"primary",className:"header-download-btn",disabled:o,onClick:function(e){e.stopPropagation(),window._stat_track("picture_download_icon_click",{source:"tpbj"}),i||window._stat_track("picture_download_show",{source:"tpbj",open_type:0}),Object(ge.f)(s.getLayers(),l),a(!i)},icon:Object(h.jsx)(m.d,{name:"downloadBold",fontSize:20}),children:d?"\u4fdd\u5b58":"\u4e0b\u8f7d"})}var n=e.disableOperate,r=e.userInfo,c=e.showWaterMark,a=e.setCopyrightVisible,i=e.copyrightVisible,o=B().isLock,s=Object(X.p)(),l=Object(_e.b)(),d=Je().isInIframe;return Object(u.useEffect)((function(){function e(e){var t,n;-1===(null==(n=(t=e.target.className).indexOf)?void 0:n.call(t,"header-download-btn"))&&-1===(null==(t=(n=e.target.className).indexOf)?void 0:t.call(n,"mt-modal-confirm__ok"))&&"\u4e0b \u8f7d"!==e.target.innerText&&a(!1)}return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[]),n?t():Object(h.jsx)(m.k,{placement:"bottomRight",content:Object(h.jsx)(J,{disableOperate:n,userInfo:r,showWaterMark:c}),trigger:"click",destroyTooltipOnHide:!0,visible:i,className:"copyright-popover",children:t()})})),tt=function(e){return e.PRE="pre",e.BETA="beta",e}({}),nt=n(1201),rt=n(44),ct=n(56),at=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rt.a)("".concat(Object(ct.f)(),"/v1/home/get_init_data"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),it=o.a.memo((function(){var e=Object(Z.f)(),t=(Object(s.a)(),Object(y.c)((function(e){return e.downloadModel.copyrightVisible}))),n=Object(y.b)((function(e){return e.downloadModel.setCopyrightVisible})),r=Object(u.useState)([]),c=(r=Object(j.a)(r,2))[0],a=r[1],i=(r=(Object(ge.x)(["ctrl+s","Command+s"],(function(){n(!0),window._stat_track("picture_download_show",{source:"tpbj",open_type:2})})),Object(me.b)())).showUserInfo,o=r.setUserInfo,l=r.destroy,d=i(),O=(r=Object(y.c)((function(e){return e.editor.watermarkModel})).watermarkShow,function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(he.b)();case 2:(t=e.sent)?o(Object(p.a)({},t)):l();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());i=Object(u.useCallback)(Object(f.a)(Object(b.a)().mark((function e(){var t,n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=d&&d.is_vip)return e.abrupt("return");e.next=2;break;case 2:if(t={entrance:"topnav",source:"tpbj"},null!=d&&d.id){e.next=16;break}return e.next=6,Object(he.e)();case 6:if(e.sent)return e.next=10,Object(he.b)();e.next=14;break;case 10:if(null!=(n=e.sent)&&n.is_vip){e.next=14;break}return Object(he.f)(t),e.abrupt("return");case 14:e.next=17;break;case 16:Object(he.f)(t);case 17:case"end":return e.stop()}}),e)}))),[d]);return Object(u.useEffect)((function(){O(),function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t,n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at({});case 2:0===(n=(n=e.sent).data).code&&n&&null!=(t=n.data)&&t.vip_hover_content&&a(JSON.parse(n.data.vip_hover_content));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),Object(h.jsxs)("div",{className:"p-header",children:[Object(h.jsxs)("div",{className:"p-header__left",children:[Object(h.jsx)(w,{}),Object(h.jsxs)("div",{className:x()("p-header"),children:[Object(h.jsx)("div",{className:"p-header__tool",children:Object(h.jsx)(H,{})}),Object(h.jsx)(ye,{}),Object(h.jsx)(ve,{})]})]}),Object(h.jsxs)("div",{className:"p-header__right",children:[null!=d&&d.id&&null!=d&&d.is_vip?null:Object(h.jsx)("div",{className:"p-header__right__buy-vip",children:Object(h.jsx)(nt.a,{list:c,handleClick:i})}),Object(h.jsxs)("div",{className:x()("p-header"),children:[Object(h.jsx)(V,{}),Object(h.jsx)(et,{disableOperate:e,copyrightVisible:t,userInfo:d,setCopyrightVisible:n,showWaterMark:r})]}),Object(h.jsx)(Te,{})]}),Object(h.jsx)(Y,{})]})})),ot=(a={},Object(k.a)(a,ce.b.ADJUST_MENU,"tz"),Object(k.a)(a,ce.b.FILTER_MENU,"lj"),Object(k.a)(a,ce.b.TEXT_MENU,"wz"),Object(k.a)(a,ce.b.PENT_MENU,"hb"),Object(k.a)(a,ce.b.MATERIAL_MENU,"sc"),Object(k.a)(a,ce.b.BACKGROUND_MENU,"bj"),Object(k.a)(a,ce.b.MINE_MENU,"wd"),[{name:"\u8c03\u6574",iconName:"adjestment",collapseType:ce.b.ADJUST_MENU,trackId:"10"},{name:"\u6ee4\u955c",iconName:"filter",collapseType:ce.b.FILTER_MENU,trackId:"11"},{name:"\u6587\u5b57",iconName:"text",collapseType:ce.b.TEXT_MENU,trackId:"12"},{name:"\u753b\u7b14",iconName:"magicBrush",collapseType:ce.b.PENT_MENU,trackId:"13"},{name:"\u7d20\u6750",iconName:"sticker",collapseType:ce.b.MATERIAL_MENU,trackId:"14"},{name:"\u6c34\u5370",iconName:"waterMark",collapseType:ce.b.WATERMARK_MENU,trackId:"18"},{name:"\u80cc\u666f",iconName:"frame",collapseType:ce.b.BACKGROUND_MENU,trackId:"15"},{name:"\u6211\u7684",iconName:"user",collapseType:ce.b.MINE_MENU,trackId:"16"}]),ut=(n(1118),o.a.memo((function(e){function t(e){c.open(),e.collapseType!==o&&(r.use(e.collapseType),i(e.collapseType),window._stat_track("tpbj_subfunction_click",{func:e.trackId,open:1,record_id:a}))}var n=e.data,r=Object(Oe.d)(),c=Object(Oe.b)(),a=Object(D.h)().id,i=Object(y.b)((function(e){return e.editor.collapseModel.setCurrentType})),o=Object(y.c)((function(e){return e.editor.collapseModel.currentType})),u=(e=Object(ue.b)()).saveTooltipText,s=e.isSaving,l=(e=e.isAutoSaving,n.collapseType===o);return Object(h.jsxs)("div",{className:"p-aside__menu__item",children:[n.collapseType!==ce.b.MINE_MENU?Object(h.jsx)(m.d,{onClick:function(){return t(n)},name:n.iconName,text:n.name,type:"menu",width:68,height:49,isActive:l,marginBottom:24,fontSize:l?26:32}):e||s||u?e||s?Object(h.jsx)(m.d,{onClick:function(){return t(n)},type:"menu",name:"loop",text:n.name,width:68,height:49,isActive:l,marginBottom:24,fontSize:l?26:32}):u?Object(h.jsx)(m.d,{onClick:function(){return t(n)},type:"menu",name:"cloudUploadSuccess",text:n.name,width:68,height:49,isActive:l,marginBottom:24,fontSize:l?26:32}):void 0:Object(h.jsx)(m.d,{onClick:function(){return t(n)},type:"menu",name:"cloudUpload",text:n.name,width:68,height:49,isActive:l,marginBottom:24,fontSize:l?26:32}),n.endTime&&n.isNew&&(new Date).valueOf()<n.endTime?Object(h.jsx)("div",{className:"p-aside__menu__item-new",children:Object(h.jsx)(m.s,{width:33,height:15,name:"new"})}):null]})}))),st=o.a.memo((function(e){var t=e.data,n=e.index,r=(e=t.icon,t.name),c=Object(y.b)((function(e){return e.customAdModel.setData})),a=W();return Object(h.jsxs)("div",{className:"menu-custom-wrap",onClick:function(){c(t),a(!0),window._stat_track("functions_click",{function_name:t.name,function_location:n})},children:[Object(h.jsx)("img",{src:e,alt:""}),Object(h.jsx)("p",{children:r})]})})),lt=o.a.memo((function(){var e=B(),t=Object(u.useState)([]),n=(t=Object(j.a)(t,2))[0],r=t[1],c=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t,n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(ke.a)(),e.next=3,Object(fe.a)(n);case 3:null!=(n=e.sent)&&null!=(t=n.data)&&t.data&&r(n.data.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(u.useEffect)((function(){c()}),[]),Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("div",{className:x()("p-menu",e),children:Object(h.jsxs)(I.Scrollbars,{children:[ot.map((function(e,t){return Object(h.jsx)(ut,{data:e},t)})),n.map((function(e,t){return Object(h.jsx)(st,{data:e,index:t},t)}))]})})})})),dt=(i=(n(1119),Object(u.lazy)((function(){return n.e(4).then(n.bind(null,1298))}))),a=Object(u.lazy)((function(){return Promise.all([n.e(2),n.e(12)]).then(n.bind(null,1302))})),Object(u.lazy)((function(){return n.e(19).then(n.bind(null,1308))}))),bt=Object(u.lazy)((function(){return n.e(23).then(n.bind(null,1303))})),pt=Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,1304))})),ft=Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(17)]).then(n.bind(null,1300))})),jt=Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(18)]).then(n.bind(null,1309))})),Ot=Object(u.lazy)((function(){return n.e(29).then(n.bind(null,1306))})),mt=(In={},Object(k.a)(In,ce.b.ADJUST_MENU,Object(h.jsx)(u.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(i,{})})),Object(k.a)(In,ce.b.FILTER_MENU,Object(h.jsx)(u.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(a,{})})),Object(k.a)(In,ce.b.PENT_MENU,Object(h.jsx)(u.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(dt,{})})),Object(k.a)(In,ce.b.TEXT_MENU,Object(h.jsx)(u.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(bt,{})})),Object(k.a)(In,ce.b.BACKGROUND_MENU,Object(h.jsx)(u.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(pt,{})})),Object(k.a)(In,ce.b.MATERIAL_MENU,Object(h.jsx)(u.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(ft,{})})),Object(k.a)(In,ce.b.WATERMARK_MENU,Object(h.jsx)(u.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(Ot,{})})),In),ht=Object(k.a)({},ce.b.MINE_MENU,Object(h.jsx)(u.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(jt,{})})),gt=(i={},Object(k.a)(i,ce.b.MATERIAL_MENU,""),Object(k.a)(i,ce.b.ADJUST_MENU,"secondary"),Object(k.a)(i,ce.b.FILTER_MENU,""),Object(k.a)(i,ce.b.PENT_MENU,"secondary"),Object(k.a)(i,ce.b.TEXT_MENU,""),Object(k.a)(i,ce.b.MINE_MENU,""),Object(k.a)(i,ce.b.BACKGROUND_MENU,""),i),_t=o.a.memo((function(){var e=B(),t=Object(y.c)((function(e){return e.editor.collapseModel.currentType})),n=Object(u.useRef)([]);t&&!n.current.includes(t)&&n.current.push(t),e=t!==ce.b.MINE_MENU?e:"";return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:x()("p-collapse",Object(p.a)({},e)),children:[Object.keys(ht).map((function(e){return e===t?Object(h.jsx)("div",{className:x()("p-collapse__container",{"p-collapse__container-secondary":"secondary"===gt[e]}),style:{display:"block"},children:ht[e]},e):null})),Object.keys(mt).map((function(e){var r=e===t;return Object(h.jsx)("div",{className:x()("p-collapse__container",{"p-collapse__container-secondary":"secondary"===gt[e]}),style:{display:r?"block":"none"},children:n.current.includes(e)?mt[e]:null},e)}))]})})})),vt=(n(1120),n(42)),wt=n(17),xt=function(){var e=Object(vt.h)(),t=Object(Oe.h)(),n=Object(D.j)(),r=Object(oe.b)(),c=Object(y.b)((function(e){return e.stageModel})).setEnterType,a=Object(wt.c)();return{createStageByUrl:function(){var i=Object(f.a)(Object(b.a)().mark((function i(o){var u,s,l,d;return Object(b.a)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return a.init(),r(),c("open"),i.next=5,Object(ge.l)(o);case 5:s=i.sent,u=s.width,s=s.height,l=Object(ge.n)({width:u,height:s,data:{url:o,maskURL:"",stretchOption:2,naturalWidth:u,naturalHeight:s,imageTransform:{offsetX:0,offsetY:0,rotate:0,scale:1,flipH:!1,flipV:!1,widthRatio:1,heightRatio:1},maskType:0,cutoutMaskURL:""}}),d=Object(ge.i)({width:u,height:s,data:{color:"",url:"",type:"repeat",id:0,naturalWidth:0,naturalHeight:0,imageTransform:{offsetX:0,offsetY:0,rotate:0,scale:1,flipH:!1,flipV:!1,widthRatio:1,heightRatio:1},stretchOption:2}}),n({width:u,height:s}),t.open(),e.action(d,!1,!1),e.action(l,!1,!1);case 15:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}()}},yt=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(f.a)(Object(b.a)().mark((function e(r,c){var a,i,o,u,s,l,d,p,j,O;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=t.name.split(".")[0],"image/heic"===t.type)return e.next=5,n.e(26).then(n.t.bind(null,689,7));e.next=12;break;case 5:return i=e.sent.default,e.next=8,i({blob:t,toType:"image/jpg",quality:1});case 8:return i=e.sent,e.next=11,Object(ge.d)(i);case 11:t=e.sent;case 12:return o=t.size,pe.f,e.next=16,Object(ge.g)(t);case 16:return u=e.sent,e.next=19,Object(ge.l)(u);case 19:if(j=e.sent,s=j.width,l=j.height,(j=(p=l)<(d=s)?s:l)>pe.g||o>pe.f)return O=pe.e,o<pe.f&&j>pe.g&&(O=2*pe.e),m.j.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:"\u5f53\u524d\u56fe\u7247\u8fc7\u5927\uff0c\u5904\u7406\u65f6\u6613\u53d1\u751f\u95ee\u9898\uff0c\u662f\u5426\u8c03\u6574\u56fe\u7247\u5927\u5c0f\u540e\u6253\u5f00\uff1f",okText:"\u662f",cancelText:"\u5426\uff0c\u6253\u5f00\u5176\u4ed6\u56fe\u7247",centered:!0,closable:!0,onOk:function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t,n;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l<s?(l/=s/O,s=O):(s/=l/O,l=O),e.next=3,Object(ge.u)(u);case 3:return t=e.sent,e.next=6,c=t,i=d,b=p,f=s,j=l,h=m=void 0,h=(m=document.createElement("canvas")).getContext("2d"),m.width=f,m.height=j,null!=h&&h.drawImage(c,0,0,i,b,0,0,f,j),m;case 6:t=e.sent,n=t.toDataURL("image/png"),r({base64:n,name:a,originalSize:"\u5c3a\u5bf8:".concat(d,"*").concat(p," \u5927\u5c0f:").concat((+o/1024/1024).toFixed(2),"MB")});case 9:case"end":return e.stop()}var c,i,b,f,j,m,h}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(e){c(e)}}),e.abrupt("return");e.next=30;break;case 30:r({base64:u,name:a,originalSize:"\u5c3a\u5bf8:".concat(d,"*").concat(p," \u5927\u5c0f:").concat((+o/1024/1024).toFixed(2),"MB")}),e.next=36;break;case 33:e.prev=33,e.t0=e.catch(0),c("openError");case 36:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),kt=(n(1121),n(124)),Et=n(7),Tt=n(178),St=n(496),It=n(515),At=n(284),Ct=o.a.memo((function(){var e=Object(X.g)(),t=Object(At.d)().isImageCutout;return e||t?Object(h.jsx)(At.a,{onConfirm:function(){window._stat_track("kt_hotkey_user_decision",{oper_type:1})},onCancel:function(){window._stat_track("kt_hotkey_user_decision",{oper_type:0})}}):null})),Lt=n(631),Nt=(n(1126),n(319)),Mt=(n(1127),{ADJUST_ENTRY:{options:{showBullets:!1,tooltipPosition:"right",showButtons:!1,allCount:1},steps:[{element:".intelligent-step-entry",intro:K({prevText:"\u4e0b\u6b21\u518d\u6765",nextText:"\u7acb\u5373\u4f53\u9a8c",content:"\u65b0\u589e\u4e00\u952e\u6362\u8272\u529f\u80fd\uff0c\u53ef\u4ee5\u5feb\u901f\u6539LOGO\u3001\u6d77\u62a5\u3001\u8863\u670d\u7b49\u989c\u8272\uff0c\u5feb\u6765\u8bd5\u8bd5"})}]},INTELLIGENT_ENTRY:{options:{showBullets:!1,nextLabel:"\u4e0b\u4e00\u6b65",doneLabel:"\u7acb\u5373\u4f53\u9a8c",hidePrev:!0,tooltipPosition:"right",showButtons:!1,allCount:3},steps:[{element:".intelligent-step-entry",intro:K({nextText:"\u4e0b\u4e00\u6b65",prevText:"\u8df3\u8fc7",showStepCount:!0,content:"\u9009\u62e9\u539f\u56fe\u4e0a\u8981\u6362\u6389\u7684\u989c\u8272\uff0c\u4e0d\u60f3\u6362\u8272\u7684\u533a\u57df\u53ef\u4ee5\u4fdd\u62a4\u8d77\u6765\u54e6~",allCount:3,currentStepCount:1})},{element:".p-intelligent-color",intro:K({nextText:"\u4e0b\u4e00\u6b65",prevText:"\u8df3\u8fc7",showStepCount:!0,content:"\u8fd9\u91cc\u4e3a\u60a8\u63d0\u4f9b\u4e86\u9884\u8bbe\u7684\u989c\u8272\u6548\u679c\uff0c\u53ef\u70b9\u51fb\u81ea\u52a8\u5e94\u7528\uff01\u4e5f\u53ef\u5207\u6362\u5230\u3010\u66f4\u591a\u989c\u8272\u3011\u9009\u62e9\u6362\u5230\u6307\u5b9a\u989c\u8272\u54e6",allCount:3,currentStepCount:2})},{element:".p-intelligent-color__hsl-card",intro:K({nextText:"\u6211\u5b66\u4f1a\u4e86",prevText:"\u518d\u5b66\u4e00\u6b21",showStepCount:!0,content:"\u70b9\u51fb\u3010\u624b\u52a8\u8c03\u8272\u3011\u53ef\u6ed1\u52a8\u6ed1\u7aff\u5bf9\u989c\u8272\u6548\u679c\u8fdb\u884c\u7ec6\u8c03~",allCount:3,currentStepCount:3}),position:"left"}]}}),Rt=o.a.memo((function(){var e=Object(u.useState)({steps:[],options:{}}),t=(e=Object(j.a)(e,2))[0],n=e[1],r=(e=Object(u.useState)(""),(e=Object(j.a)(e,2))[0]),c=e[1],a=(e=Object(u.useState)(!1),(e=Object(j.a)(e,2))[0]),i=e[1],o=(e=Object(u.useState)(0),(e=Object(j.a)(e,2))[0]),s=e[1],l=Object(u.useRef)(),d=Object(y.c)((function(e){return e.editor.collapseModel.currentType})),p=Object(y.b)((function(e){return e.editor.adjustCollapseModel.setCurrentType})),O=Object(Oe.d)().use,m=Object(Z.j)(),g=Object(He.D)();e=v.a.parse(window.location.search);return Object(u.useEffect)((function(){for(var e in Mt)if(!window.localStorage.getItem(e)){var t=Q()(Mt[e]);n(t),c(e);break}}),[m]),Object(u.useEffect)((function(){var e=window.localStorage.getItem(r);switch(r){case"ADJUST_ENTRY":d!==ce.b.ADJUST_MENU||e||(i(!0),window.localStorage.setItem(r,"".concat((new Date).getTime())));break;case"INTELLIGENT_ENTRY":m&&!e&&!a&&g.length&&(Ie.a.emit(Nt.a,!0),setTimeout((function(){i(!0),window.localStorage.setItem(r,"".concat((new Date).getTime()))}),100))}}),[r,m,g,a]),Object(u.useEffect)((function(){var e=function(){var e=Object(f.a)(Object(b.a)().mark((function e(n){var c,a;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"introjs-skipbutton"===(c=(null==n?void 0:n.target).className)&&i(!1),"c-steps-wrapper__btns-next"!==c?e.next=15:(e.t0=r,e.next="ADJUST_ENTRY"===e.t0?6:"INTELLIGENT_ENTRY"===e.t0?12:15);break;case 6:return l.current.introJs.exit(),i(!1),p(ce.a.ADJUST_INTELLIGENT),e.next=11,O(ce.a.ADJUST_INTELLIGENT);case 11:return e.abrupt("break",15);case 12:return a=t.options.allCount,o+1!==a?(l.current.introJs.nextStep(),s(o+1)):(l.current.introJs.exit(),i(!1)),e.abrupt("break",15);case 15:"c-steps-wrapper__btns-prev"!==c?e.next=25:(e.t1=r,e.next="ADJUST_ENTRY"===e.t1?19:"INTELLIGENT_ENTRY"===e.t1?22:25);break;case 19:return l.current.introJs.exit(),i(!1),e.abrupt("break",25);case 22:return a=t.options.allCount,o+1!==a?(l.current.introJs.exit(),i(!1)):(s(0),l.current.introJs.goToStep(1)),e.abrupt("break",25);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[r,o,t,l]),null!=e&&e.func||null==t||null==(e=t.steps)||!e.length||!a?null:Object(h.jsx)(Lt.Steps,{ref:l,initialStep:o,steps:t.steps,options:t.options,onExit:function(){"INTELLIGENT_ENTRY"===r&&Ie.a.emit(Nt.a,!1)},enabled:a})})),Pt=n(246),Ut={delete:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u5220\u9664"},cut:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u526a\u5207"},copy:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u590d\u5236"},paste:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u7c98\u8d34"},makeGroup:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u6210\u7ec4"},brokeGroup:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u89e3\u7ec4"},lock:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u89e3\u9501/\u9501\u5b9a"},upload:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u4e0a\u4f20"},sortUp:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u4e0a\u79fb\u4e00\u5c42"},sortDown:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u4e0b\u79fb\u4e00\u5c42"},sortTop:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u7f6e\u9876"},sortBottom:{func_type:"\u56fe\u7247\u7f16\u8f91",oper_type:"\u7f6e\u5e95"}},Dt=n(666),Ft=o.a.memo((function(){var e=Object(me.b)().showUserInfo,t=Object(y.c)((function(e){return e.editor.watermarkModel})),n=t.materialList,r=(t=t.watermarkShow,Object(y.c)((function(e){return e.editor.watermarkModel.materialList})));e(),e=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t,c,a,i;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(he.b)();case 2:if(t=e.sent,c={entrance:"other",source:"tpbj",vip_type:function(){var e="";return Array.from(new Set(n)).forEach((function(t){e+="".concat(t.type,"_").concat(t.typeId,"_").concat(t.id,",")})),e}(),material_id:r.map((function(e){return"".concat(e.type,"_").concat(e.typeId,"_").concat(e.id,"_").concat(Number(e.isVip),"_").concat(e.trackName)})).join(",")},a=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:!t||null!=t&&t.is_vip||Object(he.f)(c);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t){e.next=16;break}return e.next=8,Object(he.e)();case 8:if(e.sent)return e.next=12,Object(he.b)();e.next=14;break;case 12:null!=(i=e.sent)&&i.is_vip||Object(he.f)(c);case 14:return setTimeout(a,1e3),e.abrupt("return");case 16:a();case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)(Dt.a,{show:t,onHandler:e})})),Gt=n(642),zt=n(517),Bt=o.a.memo((function(){var e,t=Object(Oe.i)(),n=(r=Object(D.b)()).width,r=r.height,c=Object(y.c)((function(e){return e.editor.searchModel.is_search})),a=(0,Object(X.o)().getActivePickLayer)(),i=null==a||null==(e=a.materialIds)?void 0:e.get(ge.b.IMAGE_MATERIAL),o=Object(D.h)();return Object(h.jsx)(Gt.a,{cancelCallBack:function(){window._stat_track("hb_picture_edit_yes_data",{"\u88c1\u526a\u56fe\u7247":"\u53d6\u6d88",is_search:c,"\u5206\u7c7b":null==a?void 0:a.category,"\u7d20\u6750":null==i?void 0:i.join(",")})},confirmCallBack:function(){Object(zt.a)({firstId:2,secondId:6,isUse:!0,recordId:(o.id||"").toString(),activeLayer:a}),window._stat_track("hb_picture_edit_yes_data",{"\u88c1\u526a\u56fe\u7247":"\u5e94\u7528",is_search:c,"\u5206\u7c7b":null==a?void 0:a.category,"\u7d20\u6750":null==i?void 0:i.join(",")})},stageWidth:n,stageHeight:r,scale:t})})),Ht=n(633),Vt=n(523),Jt=n(155),Yt=n(652),Wt=n(508),qt=n(497),Kt=n(123),Xt=n(209),Zt=n(213),Qt=o.a.memo((function(e){var t,n=e.id,r=e.isHover,c=(e=e.isMakeup,(0,Object(X.q)().getLayer)(n));return c?(t=!1,c.layerType===ge.a.GROUP_LAYER&&(t=!c.data.isExtraGroup),Object(h.jsxs)(vt.b,{enableGuides:!0,id:n,isHover:r,isMakeup:e,children:[Object(h.jsx)(Kt.c,{id:n}),Object(h.jsx)(Jt.d,{id:n,show:t}),Object(h.jsx)(Zt.k,{id:n})]})):null})),$t=(a={},Object(k.a)(a,ge.a.TEXT_LAYER,"\u53cc\u51fb\u4fee\u6539\u6587\u5b57"),Object(k.a)(a,ge.a.IMAGE_LAYER,"\u53cc\u51fb\u66ff\u6362\u56fe\u7247"),a),en=o.a.memo((function(){var e=Object(X.s)(),t=Object(X.g)(),n=Object(X.D)(),r=Object(Z.n)(),c=Object(Z.h)(),a=(0,Object(X.o)().getActivePickLayer)(),i=Object(Z.l)(),o=Object(Z.i)(),u=Object(D.b)().width,s=Object(He.E)(),l=Object(Z.k)(),d=[];return o&&d.push(Object(h.jsx)(He.g,{},"eliminate-pen")),s&&d.push(Object(h.jsx)(He.c,{},"color-pick-pen")),l&&d.push(Object(h.jsx)(He.q,{},"smart-mask-pen")),i&&d.push(Object(h.jsx)(Zt.m,{},"shape-pen")),r&&d.push(Object(h.jsx)(Jt.c,{id:r},"link-operate-layer")),e&&d.push(Object(h.jsx)(Qt,{id:e,isHover:!0},"h-".concat(e))),t&&t.id!==r&&d.push(Object(h.jsx)(Qt,{id:t.id},"a-".concat(t.id))),n.forEach((function(e){d.push(Object(h.jsx)(Qt,{id:e,isMakeup:!0},"p-".concat(e)))})),c&&t&&d.push(Object(h.jsx)(Xt.b,{id:t.id,includeIds:["#c-text-panel"],stageWidth:u},"e-".concat(t.id))),null==a||!a.id||(null==a?void 0:a.layerType)!==ge.a.TEXT_LAYER&&(null==a?void 0:a.layerType)!==ge.a.TEXT_MATERIAL_LAYER||d.push(Object(h.jsx)(Xt.c,{},"fontLoading")),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(vt.e,{tipTxtMap:$t}),d.length?Object(h.jsx)(h.Fragment,{children:d}):null]})})),tn=(dt=n(91),n.n(dt)),nn=(bt=n(128),n.n(bt)),rn=(pt=n(126),n.n(pt)),cn=(ft={},Object(k.a)(ft,He.i.hsl,{name:"HSL",iconName:"hsl",typeName:"\u8c03\u6574",url:"",isVip:!0,typeId:10,id:46,type:"func"}),Object(k.a)(ft,He.i.particulars,{name:"\u7ec6\u8282",iconName:"structure",typeName:"\u8c03\u6574",url:"",isVip:!0,typeId:10,id:43,type:"func"}),Object(k.a)(ft,He.i.aiEliminate,{name:"AI\u6d88\u9664",iconName:"eliminate",typeName:"\u6d88\u9664\u7b14",url:"",isVip:!0,typeId:10,id:48,type:"func"}),ft),an=o.a.memo((function(){function e(e){return Array.from(new Set(e.filter((function(e){return!(16===e.length&&e.startsWith("2210"))})).filter((function(e){return"0"!==e})).filter((function(e){return"undefined"!==e})).filter((function(e){return!nn()(e)})).filter((function(e){return e}))))}function t(){var e;0<g.current.length&&(e=g.current.splice(0,1)[0],P(e.layerList,e.isVip))}var r=Object(D.b)(),c=Object(u.useState)(!0),a=(c=Object(j.a)(c,2))[0],i=c[1],o=(c=Object(u.useState)([]),(c=Object(j.a)(c,2))[0]),s=c[1],l=Object(X.F)(),d=(c=Object(u.useState)(!1),(c=Object(j.a)(c,2))[0]),O=c[1],m=Object(X.w)().addOrUpdate,g=Object(u.useRef)([]),_=(c=Object(Ge.h)()).checkMaterialId,v=c.setShowWaterMark,w=(c.showWaterMark,Object(X.i)()),x=Object(X.A)(),k=(c=Object(y.c)((function(e){return e.editor.watermarkModel})),c.thresholdIdMap),T=(c.isVipTemplate,(0,Object(me.b)().showUserInfo)()),S=Object(y.c)((function(e){return e.editor.watermarkModel})).thresholdIdList,I=(c=Object(y.b)((function(e){return e.editor.watermarkModel})),c.setThresholdIdMap),A=c.setThresholdIdList,L=c.setMaterialList,N=c.setWatermarkShow,M=c.setMaterialIdList,R=Object(ge.w)((function(e,t){i(!1),P(e,t)}),100),P=function(){var r=Object(f.a)(Object(b.a)().mark((function r(c,a){var i,o,u,l,f,j,h,y,T,R,P,U,D;return Object(b.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(d)return g.current=g.current.concat([{layerList:c,isVip:a}]),r.abrupt("return");r.next=3;break;case 3:if(i=[],function e(t){t.forEach((function(t){t.materialIds&&i.push.apply(i,Object(E.a)(Object(ge.o)(t.materialIds))),t.children&&e(t.children)}))}(c),M(e(i)),o=!!i.filter((function(e){return He.r.has(e)})).length,u=function(e,t){return t.forEach((function(t){var r;-1===(t="".concat(t)).indexOf("vip-font-style")||e.get(t)||(r={name:"\u6587\u5b57\u7279\u6548",iconName:"",typeName:"\u6587\u5b57\u7279\u6548",url:n(1160)("./".concat(t,".png")).default,isVip:!0,type:"vipTextFont"},e.set(t,r))})),e}(k,i),I(u),0<(u=e(i).filter((function(e){return!Ne()(null==(e=k.get(e))?void 0:e.isVip)}))).length)return O(!0),r.next=15,Object(C.g)({ids:u.join(",")});r.next=22;break;case 15:u=r.sent,l=u.data.data,f=[],Object.keys(l).forEach((function(e){f.push(l[e])})),j=function(e,t){return t&&t.length&&t.forEach((function(t){var n;t&&(n={name:t.default_name||(null==t?void 0:t.name)||"",typeName:t.type,url:t.thumbnail||"",iconName:"",id:t.id,typeId:t.type_id,type:"material",trackName:""},"image_filter"===t.type&&(n.name=t.default_name||(null==t?void 0:t.name)||"",n.typeName="\u6ee4\u955c",n.url="",n.iconName="filter",n.trackName="lj"),"pic_shape"===t.type&&(n.name=t.default_name||(null==t?void 0:t.name)||"",n.typeName="\u5f62\u72b6\u8499\u7248",n.url="",n.iconName="shape",n.trackName="mb"),"fonts"===t.type&&(n.typeName="\u5b57\u4f53",n.url="",n.trackName="wz"),"pic_static_sticker"===t.type&&(n.trackName="sc"),"pic_background"===t.type&&(n.trackName="bj"),"watermark"===t.type&&(n.url=t.thumbnail.url),tn()(t.threshold))&&e.set(String(t.id),Object(p.a)({isVip:!!t.threshold},n))})),e}(k,f),I(j),O(!1);case 22:return j=c.find((function(e){return e.layerType===ge.a.WATERMARK})),h=[].concat(Object(E.a)(Object(ge.o)(w.materialIds)),Object(E.a)(Object(ge.o)(x.materialIds)),Object(E.a)(j&&j.data.isFullScreen?Object(ge.o)(j.materialIds):[])),r.next=26,_(c,h,k);case 26:if(h=r.sent,y=h.showWaterMark,T=h.result,R=h.materials,P=function(e,t){return t.forEach((function(t){He.r.has(t)&&!e.get(t)&&e.set(t,cn[t])})),e}(k,i),I(P),c.forEach((function(e){var t,n;e.layerType===ge.a.GROUP_LAYER&&e.data.isTextMaterial&&(n=!0,n=!(null==(t=k.get(((null==(t=e.materialIds)?void 0:t.get(ge.b.ADVANCED_TEXT_MATERIAL))||[])[0]||""))||!t.isVip),e.data.isVip!==n)&&m(Object(p.a)(Object(p.a)({},e),{},{data:Object(p.a)(Object(p.a)({},e.data),{},{isVip:n})}))})),rn()(S,T)&&!o||(o&&(P=i.filter((function(e){return He.r.has(e)})),T.push.apply(T,Object(E.a)(P)),R.push.apply(R,Object(E.a)(P.map((function(e){return cn[e]}))))),A(Array.from(new Set(T))),L(Array.from(new Set(R.sort((function(e){return e.url?0:-1})))))),P=o||y,v(!a&&P),N(!a&&(P||!!T.length)),a||P)return s([]),t(),r.abrupt("return");r.next=41;break;case 41:U=[],D=function(e){return null==(e=Object(ge.o)(e||[]))?void 0:e.some((function(e){return T.includes(e)}))},function(e){e.forEach((function(t){var n;!D(t.materialIds)||t.parentId&&(n=e.find((function(e){return e.id===t.parentId})),D(null==n?void 0:n.materialIds))||U.push(t)}))}(c),s(U||[]),t();case 47:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}();return Object(u.useEffect)((function(){0===l.length?i(!0):(a?R:P)(l,!(null==T||!T.is_vip))}),[l,null==T?void 0:T.is_vip]),Object(Ge.g)("watermark-container",r.width,r.height),Object(h.jsx)("div",{id:"watermark-container",children:Object(h.jsx)(Ge.c,{renderLayers:o})})})),on=n(261),un=o.a.memo((function(){var e=Object(Oe.i)(),t=Object(D.b)(),n=Object(Z.f)(),r=Object(X.g)(),c=t.width;t=t.height;return Object(h.jsx)(h.Fragment,{children:n?r?Object(h.jsx)("div",{id:"c-crop-image-wrap",className:"c-crop-image-wrap",children:Object(h.jsx)(Bt,{})}):Object(h.jsx)(Yt.a,{stageWidth:c,stageHeight:t,scale:e}):null})})),sn=o.a.memo((function(){function e(){var e,t;r.current&&(e=(t=i||{width:0,height:0}).width,t=t.height,c({width:e,height:t,isShow:!1}),r.current=!1)}var t=Object(X.p)().getMainLayer,n=Object(D.g)(),r=Object(u.useRef)(!1),c=Object(y.b)((function(e){return e.stageModel})).setContrast,a=Object(u.useState)(null),i=(a=Object(j.a)(a,2))[0],o=a[1];return Object(u.useEffect)((function(){var t=function(){var t=Object(f.a)(Object(b.a)().mark((function t(){var r,c,a,i;return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n&&de.a.getCode(n),t.next=3,de.a.getRemoteUrlAsync(r);case 3:return r=t.sent,t.next=6,Object(ge.l)(r);case 6:i=t.sent,c=i.width,a=i.height,i=i.img,o({width:c,height:a,img:i}),document.addEventListener("mouseup",e);case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return o(null),t(),function(){document.removeEventListener("mouseup",e)}}),[n]),i?Object(h.jsx)(m.x,{placement:"top",title:"\u957f\u6309\u67e5\u770b\u539f\u56fe",trigger:"hover",children:Object(h.jsxs)("div",{className:"navigator-wrap__contrast",onMouseDown:function(){r.current=!0;var e,n=(a=t()).width,a=a.height,o=(s=i||{width:0,height:0}).width,u=s.height,s=s.img,l=n/o;o=(e=a/u)<l?o*e:n,n=e<l?a:u*l;null!=(a=((e=document.querySelector("#stage-contrast")).width=o,e.height=n,e.getContext("2d")))&&a.drawImage(s,0,0,o,n),c({width:o,height:n,isShow:!0})},children:[Object(h.jsx)(m.d,{name:"compare",fontSize:22}),"\u5bf9\u6bd4"]})}):null})),ln=o.a.memo((function(){var e=(t=Object(D.b)()).width,t=t.height,n=Object(u.useState)(""),r=(n=Object(j.a)(n,2))[0],c=n[1],a=(0,Object(me.b)().showUserInfo)(),i=(n=Object(u.useState)({}),(n=Object(j.a)(n,2))[0]),o=n[1],l=(n=Object(u.useState)(0),(n=Object(j.a)(n,2))[0]),d=n[1],p=Object(s.a)().theme;return Object(u.useEffect)((function(){!function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ke.b)();case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[]),Object(u.useEffect)((function(){!function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t,n,r;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Ee.a)();case 2:n=e.sent,t="".concat("https://feedback.meitu.com","/im?client_id=").concat(pe.a,"&track_from=\u56fe\u7247\u7f16\u8f91&client_orign=").concat(window.location.origin||""),n={gid:n||"",language:"zh_CN",channel:"",theme:p},r={vipType:(null==a?void 0:a.is_vip)||!1,screenName:(null==a?void 0:a.screen_name)||"",avatar:(null==a?void 0:a.avatar)||""},o({iframeUrl:t,appInfo:n,userInfo:r});case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[a,p]),Object(u.useEffect)((function(){var e,t=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(fe.c)({});case 2:t=e.sent,d((null==t||null==(t=t.data)||null==(t=t.data)?void 0:t.online_unread_num)||0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return t(),e=setInterval(t,8e3),function(){e&&clearInterval(e)}}),[]),Object(h.jsxs)("div",{className:"navigator-wrap",children:[Object(h.jsx)(sn,{}),Object(h.jsx)(Wt.a,{canvasWidth:e,canvasHeight:t,showNavigatorTips:!0,feedBackSrc:r,businessMessengerConfig:i,unReadMessage:l,children:Object(h.jsx)(qt.a,{isNavigator:!0})})]})})),dn=o.a.memo((function(){function e(e){window._stat_track("canvas_layer_use",Ut[e])}return Object(u.useEffect)((function(){return Ie.a.on(Pt.a.track,e),function(){Ie.a.off(Pt.a.track,e)}}),[]),null})),bn=o.a.memo((function(){var e=Object(Oe.i)(),t=(n=Object(D.b)()).width,n=n.height;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(qt.a,{}),Object(h.jsx)(an,{}),Object(h.jsx)(en,{}),Object(h.jsx)(on.b,{scale:e}),Object(h.jsx)(vt.d,{adsorbDistance:2,width:t,height:n})]})})),pn=o.a.memo((function(){var e=Object(Oe.i)(),t=Object(D.b)(),n=Object(X.J)().setSize,r=t.width,c=t.height,a=(t=Object(X.A)(),Object(St.a)().filesUpload),i=Object(It.a)().addImgToLayers,o=Object(y.c)((function(e){return e.editor.collapseModel.currentType})),s=Object(M.d)(),l=(0,Object(me.b)().showUserInfo)(),d=Object(Z.o)().canUseQuickAdd,p=Object(y.c)((function(e){return e.stageModel})).contrast,j=Object(u.useCallback)(function(){var e=Object(f.a)(Object(b.a)().mark((function e(t,n){var r;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,d()){e.next=3;break}return e.abrupt("return");case 3:if(l){e.next=11;break}return s.hide(),e.next=7,Object(he.e)();case 7:if(e.sent){e.next=11;break}return kt.a.error("\u8bf7\u5148\u767b\u5f55\u8d26\u53f7\u540e\u4e0a\u4f20\u56fe\u7247"),e.abrupt("return");case 11:if(t=Object(E.a)(t).filter((function(e){return Tt.b.includes(e.type)})),null!=(r=t)&&r.length){e.next=14;break}return e.abrupt("return");case 14:if(10<t.length)return m.i.info("\u4ec5\u652f\u6301\u6279\u91cf\u4e0a\u4f2010\u5f20\u56fe\u7247"),e.abrupt("return",!1);e.next=17;break;case 17:return s.show(),r=o===ce.b.MATERIAL_MENU?"1":"0",e.next=21,a(t,r);case 21:e.sent.forEach((function(e){var t=e.url,r=e.width,c=e.height;i({thumbnail:t,width:r,height:c},n),Object(St.b)(e)})),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(0),s.hide();case 28:return e.prev=28,s.hide(),e.finish(28);case 31:case"end":return e.stop()}}),e,null,[[0,25,28,31]])})));return function(t,n){return e.apply(this,arguments)}}(),[i]);return Object(u.useEffect)((function(){n({width:r,height:c})}),[r,c]),Object(u.useEffect)((function(){return Ie.a.on(Pt.a.add,j),Ie.a.on(Pt.a.paste,j),function(){Ie.a.off(Pt.a.add,j),Ie.a.off(Pt.a.paste,j)}}),[j]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(dn,{}),Object(h.jsx)(Pt.b,{children:Object(h.jsx)(Vt.a,{canScale:!0,children:Object(h.jsx)(Jt.e,{children:Object(h.jsxs)(Wt.b,{canvasWidth:null!=p&&p.isShow?null==p?void 0:p.width:r,canvasHeight:null!=p&&p.isShow?null==p?void 0:p.height:c,children:[Object(h.jsx)("div",{style:{display:null!=p&&p.isShow?"none":"block"},children:Object(h.jsx)(X.b,{maskURL:null==(t=t.data)?void 0:t.maskURL,children:Object(h.jsx)(Ht.a,{scale:e,uploadImageToStage:j,children:Object(h.jsx)(bn,{})})})}),Object(h.jsx)("div",{style:{display:null!=p&&p.isShow?"flex":"none",alignItems:"center",justifyContent:"center",height:"100%",backgroundImage:"url(".concat(L,")"),backgroundRepeat:"repeat"},children:Object(h.jsx)("canvas",{id:"stage-contrast"})})]})})})}),Object(h.jsx)(ln,{}),null!=p&&p.isShow?null:Object(h.jsx)(Ft,{}),Object(h.jsx)(un,{}),Object(h.jsx)(Ct,{}),Object(h.jsx)(Rt,{})]})})),fn=Object(u.lazy)((function(){return n.e(20).then(n.bind(null,1299))})),jn=o.a.memo((function(){var e=Object(y.c)((function(e){return e.templateModel.isInit})),t=Object(D.d)();return Object(h.jsx)(h.Fragment,{children:e?t?Object(h.jsx)(u.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(fn,{})}):Object(h.jsx)(pn,{}):Object(h.jsx)(q,{})})})),On=(n(1175),n(240)),mn=o.a.memo((function(){var e=Object(u.useState)(!1),t=(e=Object(j.a)(e,2))[0],n=e[1],r=(e=Object(u.useState)(!1),(e=Object(j.a)(e,2))[0]),c=e[1],a=(e=Object(X.g)(),Object(Z.l)()),i=Object(y.c)((function(e){return e.editor.collapseModel.currentType})),o=Object(X.i)(),s=Object(X.z)(),l=Object(Z.j)(),d=Object(He.D)(),b=Object(X.p)().getLayers,p=Object(X.q)().getLayer,f=(b().filter((function(e){return e.layerType===ge.a.WATERMARK}))||[null])[0];return Object(u.useEffect)((function(){var e,t=!1;i===ce.b.BACKGROUND_MENU?(e=(null==o?void 0:o.data).url,n(!!e)):i===ce.b.WATERMARK_MENU&&f?t=p(f.id).data.isFullScreen:setTimeout((function(){return n(!1)}),0),c(t)}),[i,s,f]),Object(h.jsx)("div",{className:"p-panel",children:null!=e&&e.layerType?Object(h.jsx)(h.Fragment,{children:a?Object(h.jsx)(h.Fragment,{children:(null==e?void 0:e.layerType)===ge.a.SVG_LAYER?Object(h.jsx)(h.Fragment,{children:On.a[ge.a.MAIN_LAYER]}):Object(h.jsx)(h.Fragment,{children:On.a[e.layerType]})}):Object(h.jsx)(h.Fragment,{children:On.a[e.layerType]})}):r?Object(h.jsx)(h.Fragment,{children:On.a[ge.a.WATERMARK]}):t&&o?Object(h.jsx)(h.Fragment,{children:On.a[ge.a.BACKGROUND_LAYER]}):Object(h.jsx)(h.Fragment,{children:l&&d.length?On.a[ce.a.ADJUST_INTELLIGENT]:On.a[ge.a.MAIN_LAYER]})})})),hn=(n(1176),Ot={},Object(k.a)(Ot,ce.c.POSTERIZE,{name:"\u8272\u8c03\u5206\u79bb",type:"video",url:"https://xiuxiupro-material-center.meitudata.com/poster/846a570c93684e5231b3236c27d00795.mov",content:["\u4e3a\u56fe\u7247\u7684\u9ad8\u5149\u6216\u9634\u5f71\u533a\u57df\u6dfb\u52a0\u6240\u9009\u989c\u8272\uff0c\u901a\u8fc7\u9971\u548c\u5ea6\u7684\u8f93\u5165\u6846/\u6ed1\u6746\u53ef\u8c03\u6574\u989c\u8272\u7684\u9971\u548c\u5ea6\u3002"]}),Object(k.a)(Ot,ce.c.HSL,{name:"HSL",type:"video",url:"https://xiuxiupro-material-center.meitudata.com/poster/6d9a450ccc1c2f9fb3dcc043b16892ce.mov",content:["\u9009\u62e9\u989c\u8272\uff0c\u901a\u8fc7\u8f93\u5165\u6846/\u6ed1\u6746\u53ef\u8c03\u6574\u56fe\u7247\u4e2d\u8be5\u989c\u8272\u7684\u8272\u76f8\u3001\u900f\u660e\u5ea6\u3001\u660e\u5ea6\u3002"]}),Object(k.a)(Ot,ce.c.ELIMINATE,{name:"ELIMINATE",type:"video",url:"https://xiuxiupro-material-center.meitudata.com/poster/6597d82ff3bb4378c1aad69868f27677.mov",content:["\u8c03\u6574\u753b\u7b14\u5927\u5c0f\uff0c\u5728\u56fe\u4e0a\u6d82\u62b9\u60f3\u8981\u6d88\u9664\u7684\u533a\u57df\u3002"]}),Object(k.a)(Ot,ce.c.AI_ELIMINATE,{name:"AI_ELIMINATE",type:"video",url:"https://xiuxiu-pro.meitudata.com/poster/5795e6118593f70068d51d86271225ac.mov",content:["\u76f4\u63a5\u6d82\u62b9/\u6846\u9009/\u5708\u9009\u56fe\u7247\u4e2d\u4e0d\u9700\u8981\u7684\u90e8\u5206\uff0c\u5c31\u80fd\u81ea\u52a8\u6d88\u9664~"]}),Object(k.a)(Ot,ce.c.SHAPE,{name:"SHAPE",type:"video",url:"https://xiuxiupro-material-center.meitudata.com/poster/78807d8bb9379e884e20fdf0ca845775.mov",content:["\u9009\u62e9\u5f62\u72b6/\u7ebf\u6761\uff0c\u8c03\u6574\u753b\u7b14\u5927\u5c0f\u3001\u7a0b\u5ea6\u548c\u989c\u8272\u7b49\u5c5e\u6027\uff0c\u5728\u56fe\u4e0a\u7ed8\u5236\u5f62\u72b6\u6216\u6807\u6ce8\u91cd\u70b9\u533a\u57df"]}),Object(k.a)(Ot,ce.c.SIZE_CHANGE,{name:"SIZE_CHANGE",type:"video",url:"https://xiuxiupro-material-center.meitudata.com/poster/0843c0094a277b8cc288ab3e8af3c13d.mov",content:["1\u3001\u4ece\u6eda\u52a8\u83dc\u5355\u4e2d\u9009\u62e9\u56fe\u7247\u7684\u5c3a\u5bf8/\u6bd4\u4f8b/\u5f62\u72b6\uff0c\u6216\u586b\u5199\u81ea\u7531\u88c1\u526a\u7684\u5bbd\u548c\u9ad8\uff0c\u53ef\u6700\u5927\u8303\u56f4\u7684\u81ea\u52a8\u9009\u62e9\u533a\u57df","2\u3001\u70b9\u51fb\u5feb\u6377\u65cb\u8f6c\u6216\u5728\u753b\u5e03\u4e0a\u62d6\u52a8\u6ed1\u7aff\u65cb\u8f6c","3\u3001\u70b9\u51fb\u201c\u5e94\u7528\u201d\u4ee5\u4fdd\u5b58\u88c1\u526a\u6548\u679c","\u63d0\u793a\uff1a\u53ef\u5220\u9664\u7684\u4e3a\u60a8\u81ea\u5b9a\u4e49\u5c3a\u5bf8/\u6bd4\u4f8b\uff0c\u5176\u5b83\u4e3a\u7cfb\u7edf\u9884\u8bbe\uff0c\u6682\u4e0d\u652f\u6301\u5220\u9664\u3002"]}),Object(k.a)(Ot,ce.c.INTELLIGENT,{name:"INTELLIGENT",type:"video",url:"https://xiuxiupro-material-center.meitudata.com/poster/40b52045710215b3193d1ac8cb19a31a.mp4",content:["1\u3001\u4ece\u5de6\u4fa7\u9009\u62e9\u539f\u56fe\u4e0a\u8981\u6362\u7684\u989c\u8272\u3002\u53ef\u9009\u6574\u56fe\u6216\u5355\u4e2a\u989c\u8272\uff0c\u70b9\u51fb\u3010\u4fdd\u62a4\u533a\u57df\u3011\u53ef\u6d82\u62b9\u4fdd\u62a4\u4e0d\u60f3\u6362\u8272\u7684\u533a\u57df\u54e6~","2\u3001\u5728\u53f3\u4fa7\u9009\u62e9\u7ed3\u679c\u8272\u4e00\u952e\u6362\u8272\u3002\u53ef\u9009\u62e9\u9884\u8bbe\u7684\u989c\u8272\u6548\u679c\uff0c\u4e5f\u53ef\u5728\u8c03\u8272\u677f\u91cc\u4efb\u610f\u9009\u62e9\u989c\u8272\uff01\u8fd8\u53ef\u4ee5\u4f7f\u7528\u624b\u52a8\u8c03\u8272\u7ec6\u8c03\u6548\u679c\u54e6~"]}),Object(k.a)(Ot,ce.c.CUSTOM_AD,{name:"CUSTOM_AD",type:"video",url:"https://xiuxiupro-material-center.meitudata.com/poster/1d46d3da67810e06c079adcb9436c114.mov",content:["\u514d\u8d39\u5b89\u88c5\u5ba2\u6237\u7aef\u4f7f\u7528\u6d82\u9e26\u7b14\u3001\u9a6c\u8d5b\u514b\u3001\u6807\u6ce8\u7b14\u3001\u80cc\u666f\u865a\u5316\u3001\u53d6\u6837\u590d\u5236\u5143\u7d20\u7b49\u8d85\u591a\u529f\u80fd~"]}),Ot),gn=o.a.memo((function(){var e,t,n=Object(y.c)((function(e){return e.editor.collapseModel.functionTip})),r=Object(y.b)((function(e){return e.editor.collapseModel.setFunctionTip})),c=Object(Oe.f)(),a=Object(u.useRef)(null);return Object(u.useEffect)((function(){a.current&&(a.current.style.left="".concat(c?334:72,"px"))}),[c]),n&&hn[n]?(e=(n=hn[n]).url,t=n.content,n=n.type,Object(h.jsxs)("div",{ref:a,className:"m-function-tips",children:["img"===n?Object(h.jsx)("img",{src:e,alt:"",className:"m-function-tips__img"}):Object(h.jsx)("video",{src:e,className:"m-function-tips__img",autoPlay:!0,loop:!0}),Object(h.jsx)("div",{className:"m-function-tips__content",children:t.map((function(e,t){return Object(h.jsx)("p",{children:e},t)}))}),Object(h.jsx)("div",{className:"m-function-tips__btn",children:Object(h.jsx)(m.a,{block:!0,onClick:function(e){r(null)},children:"\u6211\u77e5\u9053\u4e86"})})]})):null})),_n=n(657),vn=[{title:"\u9e92\u9e9f\u7248X86",url:"https://xiuxiu.dl.meitu.com/mtxx-x86_64-2.0.4.deb",version_type:"L1",class:"Linux"},{title:"\u9e92\u9e9f\u7248ARM",url:"https://xiuxiu.dl.meitu.com/mtxx-aarch64-2.0.4.deb",version_type:"L2",class:"Linux"},{title:"\u9e92\u9e9f\u7248Loongarch",url:"https://xiuxiu.dl.meitu.com/mtxx-loongarch64-2.0.4.deb",version_type:"L3",class:"Linux"},{title:"\u7edf\u4fe1UOS\u7248X86",url:"https://xiuxiu.dl.meitu.com/com.meitu.mtxx_2.0.4_x86_64.deb",version_type:"L4",class:"Linux"},{title:"\u7edf\u4fe1UOS\u7248ARM",url:"https://xiuxiu.dl.meitu.com/com.meitu.mtxx_2.0.4_aarch64.deb",version_type:"L5",class:"Linux"},{title:"\u7edf\u4fe1UOS\u7248Loongarch",url:"https://xiuxiu.dl.meitu.com/com.meitu.mtxx_2.0.4_loongarch64.deb",version_type:"L6",class:"Linux"},{title:"\u4e2d\u79d1\u65b9\u5fb7\u7248X86",url:"https://xiuxiu.dl.meitu.com/zkfd_5.0_mtxx-x86_64-2.0.4.deb",version_type:"L7",class:"Linux"},{title:"\u4e2d\u79d1\u65b9\u5fb7\u7248ARM",url:"https://xiuxiu.dl.meitu.com/zkfd_mtxx-aarch64-2.0.4.deb",version_type:"L8",class:"Linux"},{title:"\u4e2d\u79d1\u65b9\u5fb7\u7248Loongarch",url:"https://xiuxiu.dl.meitu.com/zkfd_mtxx-loongarch64-2.0.4.deb",version_type:"L9",class:"Linux"}],wn=n(173),xn=(n(1178),o.a.memo((function(){function e(){var e;1===(null==t?void 0:t.btn_jump_type)?((e=document.createElement("a")).href=t.protocol,e.click(),window._stat_track("download_click",{entry:"tpbj"}),window._stat_track("publicity_pop_click",{class:"load_click",function_name:null==t?void 0:t.name})):null!=t&&t.protocol&&1===(null==t?void 0:t.type)&&(window._stat_track("publicity_pop_click",{class:"jump",function_name:null==t?void 0:t.name,trans_url:t.protocol}),window.open(t.protocol))}var t=Object(y.c)((function(e){return e.customAdModel.data})),n=W(),r=Object(y.c)((function(e){return e.customAdModel.show})),c=2===(null==t?void 0:t.type),a=2===(null==t?void 0:t.media_type),i="linux"===Object(ke.d)(),o=(r&&window._stat_track("publicity_pop_show",{function_name:null==t?void 0:t.name}),Object(h.jsxs)("div",{className:"pc-download-img-content",children:[a?Object(h.jsx)("video",{src:null==t?void 0:t.media_link,autoPlay:!0,loop:!0}):null,a?null:Object(h.jsx)("img",{src:null==t?void 0:t.media_link,alt:"",onClick:e})]}));a=Object(h.jsxs)("div",{className:"pc-download-img-text-content",children:[Object(h.jsxs)("div",{className:"pc-download-img-text-content__header",children:[a?Object(h.jsx)("video",{src:null==t?void 0:t.media_link,autoPlay:!0,loop:!0}):null,a?null:Object(h.jsx)("img",{src:null==t?void 0:t.media_link,alt:"",onClick:e})]}),null!=t&&t.title?Object(h.jsx)("div",{className:"pc-download-img-text-content__title",children:null==t?void 0:t.title}):null,null!=t&&t.desc?Object(h.jsx)("div",{className:"pc-download-img-text-content__desc",children:null==t?void 0:t.desc}):null,c&&null!=t&&t.btn_text&&!i?Object(h.jsx)(m.a,{type:"primary",onClick:function(){var e;2===(null==t?void 0:t.btn_jump_type)&&null!=t&&t.protocol&&(window._stat_track("publicity_pop_click",{class:"jump",function_name:null==t?void 0:t.name,trans_url:t.protocol}),window.open(t.protocol)),1===(null==t?void 0:t.btn_jump_type)&&((e=document.createElement("a")).href=t.protocol,e.click(),window._stat_track("publicity_pop_click",{class:"load_click",function_name:null==t?void 0:t.name}),window._stat_track("download_click",{entry:"tpbj"}))},children:null==t?void 0:t.btn_text}):null,i?Object(h.jsxs)("div",{className:"pc-download-img-text-content__linux",children:[null==t?void 0:t.btn_text,Object(h.jsx)("div",{className:"pc-download-img-text-content__download",children:vn.map((function(e){return Object(h.jsx)("a",{href:e.url,children:e.title})}))})]}):null]});return r?Object(h.jsx)("div",{className:"pc-download-wrap",children:Object(h.jsxs)("div",{className:"pc-download-content",children:[2===(null==t?void 0:t.type)?a:o,Object(h.jsx)("div",{className:"pc-download-content__close",onClick:function(){window._stat_track("publicity_pop_click",{class:"close",function_name:null==t?void 0:t.name}),n(!1)},children:Object(h.jsx)(wn.a,{name:"crossBold",fontSize:24})})]})}):null}))),yn=n(387),kn=n(348),En=function(){var e=Object(_e.e)();return function(){var t=Object(f.a)(Object(b.a)().mark((function t(){var n,r;return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(yn.a)({});case 2:return r=t.sent,n=[],r.data.error_code===kn.a.OK&&(r=((null==(r=r.data)?void 0:r.data)||[]).reduce((function(e,t){var n=(t.materials||[]).map((function(e){return Object.assign({},e,{category_name:t.category_name})}));return[].concat(Object(E.a)(e),Object(E.a)(n))}),[]),e(r),n=r),e(n),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},Tn=window,Sn=Tn.navigator,In=Tn.document,An=(jt=Tn.ActiveXObject,i=In.documentMode,/^Apple/),Cn=(function(){for(var e=3,t=document.createElement("p"),n=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);}(),jt||i),Ln=function(){if(!Cn&&void 0===Tn.scrollMaxX&&!An.test(Sn.vendor||"")){var e="track"in document.createElement("track"),t=Tn.chrome&&Tn.chrome.webstore?Object.keys(Tn.chrome.webstore).length:0;if(Nn(/^sogou/i,0))return"sogou";if(Nn(/^liebao/i,0))return"liebao";if(Tn.clientInformation&&Tn.clientInformation.languages&&2<Tn.clientInformation.languages.length)return"chrome";if(e)return 1<t?"360ee":"360se"}return""}();function Nn(e,t){var n,r=Tn.external||{};for(n in r)if(e.test(t?r[n]:n))return 1}var Mn=n(354),Rn=m.v.AppTheme;function Pn(e,t){var n=(e="eraser"===e||"ai_eraser"===e?{func:"eraser",subFunc:"ai_eraser"===e?He.h.AI:He.h.LEGACY}:{func:e}).subFunc;(t=t[e.func])&&(n?t(n):t())}a={},Object(k.a)(a,ce.a.ADJUST_COLOR,"color"),Object(k.a)(a,ce.a.ADJUST_HSL,"hsl"),Object(k.a)(a,ce.a.ADJUST_LIGHT,"light"),Object(k.a)(a,ce.a.ADJUST_PARTICULARS,"detail"),Object(k.a)(a,ce.a.ADJUST_POSTERIZE,"separation"),Object(k.a)(a,ce.a.ADJUST_INTELLIGENT,"changecolor"),Object(k.a)(a,ce.a.ADJUST_SIZE_CHANGE,"crop"),Object(k.a)(a,ce.a.ADJUST_ELIMINATE,"eraser");var Un=a,Dn=n(636),Fn=(dt=n(424),n.n(dt));function Gn(e){try{return JSON.parse(e)}catch(e){return null}}n(256),n(339);var zn=n(528),Bn=n(88),Hn=n(375);function Vn(){return(Vn=Object(f.a)(Object(b.a)().mark((function e(t,n,r){var c,a,i,o,u,s,l,d,p,f,j,O,m,h,g,_,v,w=arguments;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=3<w.length&&void 0!==w[3]&&w[3],i=Object(ge.e)(n,r),a=i.ctx,i=i.canvas,o=t.data,e.next=5,Object(ge.u)(o.url);case 5:return u=e.sent,O=o.imageTransform,j=O.flipH,O=O.flipV,s=t.left,l=t.top,d=t.width,p=t.height,f=t.rotate,e.next=10,Object(Hn.c)(d,p,j,O,1);case 10:for(j=e.sent,O=j.canvas,j.ctx.drawImage(u,0,0,d,p),a.save(),a.translate(s+d/2,l+p/2),a.rotate(f*Math.PI/180),a.drawImage(O,-d/2,-p/2,d,p),a.restore(),_=a.getImageData(0,0,n,r),m=_.data,h=m.length/4,g=0;g<h;g++)m[4*g]=255,m[4*g+1]=255,m[4*g+2]=255;if(a.putImageData(_,0,0),c)return e.next=27,Object(ge.e)(n,r);e.next=32;break;case 27:_=e.sent,v=_.canvas,_.ctx.drawImage(i,0,0),function(e,t,n){var r=2<arguments.length&&void 0!==n?n:{thickness:10,color:"rgba(255, 255, 255, 255)"};e.save();for(var c=0;c<360;c++)e.drawImage(t,r.thickness*Math.cos(c),r.thickness*Math.sin(c));e.globalCompositeOperation="source-in",e.fillStyle=r.color,e.fillRect(0,0,e.canvas.width,e.canvas.height),e.restore(),e.drawImage(t,0,0)}(a,v);case 32:return e.abrupt("return",i.toDataURL("image/png"));case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jn(e,t){return e?"".concat(Object(ct.f)(),"/editsdk/fetch_image?url=").concat(encodeURIComponent(e),"&app_key=").concat(t):""}function Yn(){var e=Object(s.a)().theme===Zn.AppTheme.dark?Zn.AppTheme.dark:Zn.AppTheme.white;Object(u.useEffect)((function(){Object(Ee.a)().then((function(t){var n=e;n={env:"release",client_id:pe.a,theme:n,gid:t,device_id:t,channel:window.sessionStorage.getItem("channel")||"",module_id:"\u56fe\u7247\u7f16\u8f91",country_code:"cn",app_key:"43815DC54A66BEE8"},Object(Qn.a)(n)}))}),[e])}function Wn(e){return window.sessionStorage.getItem(e)&&decodeURIComponent(window.sessionStorage.getItem(e))}function qn(e,t){window.sessionStorage.setItem(e,encodeURIComponent(t))}var Kn={extension:null,extensionParams:null,extensions:[],launch:function(){var e=v.a.parse(window.location.search),t=e.extension_params,n=e.extension;n&&(e=Gn(decodeURIComponent(t||"")),Kn.extension=Kn.extensions.find((function(e){return e.name===n})),Kn.extensionParams=e)},beforeInitLayers:function(e){var t,n;return null==(t=Kn.extension)||null==(n=t.beforeInitLayers)?void 0:n.call(t,Kn,e)},afterInitLayers:function(e){var t,n;return null==(t=Kn.extension)||null==(n=t.afterInitLayers)?void 0:n.call(t,Kn,e)}},Xn=n(204),Zn=n(117),Qn=n(299),$n=o.a.memo((function(){var e,t,n,r,c,a,i,o,s,l,d,O,h,g=En();return Kn.extensions.push(function(){var e=Object(Oe.b)(),t=Object(M.d)(),n=Object(X.h)();return{name:"ai_eraser",beforeInitLayers:function(n,r){return Object(f.a)(Object(b.a)().mark((function c(){var a,i,o,u,s,l;return Object(b.a)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(a=n.extensionParams){c.next=3;break}return c.abrupt("return");case 3:if(i=r.find((function(e){return e.id===a.maskId})),o=r.find((function(e){return e.id===a.originId})),i&&o){c.next=7;break}return c.abrupt("return");case 7:return e.close(),t.show(),c.prev=9,c.next=12,function(){return Vn.apply(this,arguments)}(i,o.width,o.height,a.expand);case 12:return u=c.sent,c.next=15,Object(se.c)(u);case 15:return u=c.sent,l=u.url,s=o.data,c.next=20,Object(zn.a)(s.url,l);case 20:return l=c.sent,s.url=l,c.next=24,Object(ge.u)(s.url);case 24:c.next=31;break;case 26:throw c.prev=26,c.t0=c.catch(9),m.i.error("\u6253\u5f00\u5f02\u5e38\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5"),c.t0;case 31:d=o,b=He.i.aiEliminate,p=void 0,d.materialIds||(d.materialIds=new Map),(p=d.materialIds.get(Bn.d.FUNC_LIST)||[]).push(b),d.materialIds.set(Bn.d.FUNC_LIST,p);case 32:case"end":return c.stop()}var d,b,p}),c,null,[[9,26]])})))()},afterInitLayers:function(e){return Object(f.a)(Object(b.a)().mark((function r(){var c,a;return Object(b.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(c=e.extensionParams){r.next=3;break}return r.abrupt("return");case 3:a="1"===(null==(a=c.source)?void 0:a.toString())?"\u62d6\u62fd\u79fb\u52a8\u4ea7\u54c1\u56fe\u4f4d\u7f6e\u3001\u5927\u5c0f\u548c\u89d2\u5ea6\u54e6\uff5e":"\u53cc\u51fb\u56fe\u7247\uff0c\u66ff\u6362\u4ea7\u54c1\u56fe\u54e6\uff5e",n.setActiveInfoById(c.maskId),t.hide(),m.i.info(a);case 7:case"end":return r.stop()}}),r)})))()}}}()),Object(u.useEffect)((function(){Kn.launch()}),[]),Yn(),Object(u.useEffect)((function(){g()}),[]),e=Object(y.b)((function(e){return e.editor.AbTestModel.setIsSubscribeTest})),t=function(){var t=Object(f.a)(Object(b.a)().mark((function t(){var n;return Object(b.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(Xn.d)();case 2:n=t.sent,e(!!n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Object(u.useEffect)((function(){t()}),[]),function(){var e=Object(M.d)(),t=Object(A.a)(),n=Object(oe.c)(),r=Object(oe.a)().recordInfo,c=Object(y.b)((function(e){return e.stageModel})).setEnterType;m=Object(y.b)((function(e){return e.editor.adjustCollapseModel.setCurrentType})),h=Object(y.b)((function(e){return e.editor.penCollapseModel.setCurrentType})),g=Object(y.b)((function(e){return e.editor.collapseModel.setCurrentType})),_=Object(Z.x)(),w=Object(Z.u)(),x=Object(He.I)(),k=Object(He.x)(),L=Object(Oe.d)(),E=L.use,T=L.getCurFeature,S={crop:function(){m(ce.a.ADJUST_SIZE_CHANGE)},eraser:(O=Object(f.a)(Object(b.a)().mark((function e(t){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(ce.a.ADJUST_ELIMINATE),w(!0),x(Object(p.a)(Object(p.a)({},k),{},{type:t})),e.next=5,E(ce.a.ADJUST_ELIMINATE);case 5:case"end":return e.stop()}}),e)}))),function(e){return O.apply(this,arguments)}),light:(j=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(ce.a.ADJUST_LIGHT),e.next=3,E(ce.a.ADJUST_LIGHT);case 3:case"end":return e.stop()}}),e)}))),function(){return j.apply(this,arguments)}),detail:(d=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(ce.a.ADJUST_PARTICULARS),e.next=3,E(ce.a.ADJUST_PARTICULARS);case 3:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)}),color:(l=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(ce.a.ADJUST_COLOR),e.next=3,E(ce.a.ADJUST_COLOR);case 3:case"end":return e.stop()}}),e)}))),function(){return l.apply(this,arguments)}),separation:(s=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(ce.a.ADJUST_POSTERIZE),e.next=3,E(ce.a.ADJUST_POSTERIZE);case 3:case"end":return e.stop()}}),e)}))),function(){return s.apply(this,arguments)}),hsl:(o=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(ce.a.ADJUST_HSL),e.next=3,E(ce.a.ADJUST_HSL);case 3:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)}),filters:function(){g(ce.b.FILTER_MENU)},text:function(){g(ce.b.TEXT_MENU)},shapeslines:(i=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(ce.b.PENT_MENU),h(ce.a.PEN_SHAPE),_(!0),e.next=5,E(ce.a.PEN_SHAPE);case 5:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)}),stickers:function(){g(ce.b.MATERIAL_MENU)},background:function(){g(ce.b.BACKGROUND_MENU)},changecolor:(a=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m(ce.a.ADJUST_INTELLIGENT),e.next=3,E(ce.a.ADJUST_INTELLIGENT);case 3:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},I=void 0===(L=v.a.parse(window.location.search).func)?"":L,Object(u.useEffect)((function(){return Ie.a.on(Ae,(function(){var e=T();setTimeout((function(){Pn(Un[e]||e||I,S)}),500)})),function(){Ie.a.off(Ae)}}),[]);var a,i,o,s,l,d,j,O,m,h,g,_,w,x,k,E,T,S,I,C=function(e){return Pn(e,S)},L=v.a.parse(window.location.search),N=L.open,R=L.name,P=L.func,D=L.origin,F=L.platform,G=L.from,z=function(){var a=Object(f.a)(Object(b.a)().mark((function a(i){var o,u,s,l,d;return Object(b.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.show(),c("record"),a.next=4,Object(be.e)({id:"".concat(i)});case 4:if(s=(s=a.sent).data.data,l=s.records,o=s.editor_version,u=s.original_image,s=s.caption,l=JSON.parse(l||"[]"),Object(U.b)(),0<l.length)return d="",u&&(d=u.match(/[^\.]\w*$/)[0]),a.next=13,Kn.beforeInitLayers(l);a.next=16;break;case 13:return a.next=15,t.initLayers(l,{naturalFileName:s||"",naturalImage:u||"",naturalFileSize:0,naturalFileSuffix:d||""},o);case 15:n(Object(p.a)(Object(p.a)({},r),{},{id:i}));case 16:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),B=function(){var n=Object(f.a)(Object(b.a)().mark((function n(r,a){var i;return Object(b.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c(G||"open"),e.show(),n.next=4,Object(Se.c)(r);case 4:i=(i=n.sent).base64,t.createImg({imgSrc:i,width:0,height:0,name:a||"\u672a\u547d\u540d\u56fe\u7247"}),Object(U.b)(),setTimeout((function(){C(P)}),500);case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),H=function(){var e=Object(f.a)(Object(b.a)().mark((function e(n){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(G||"open"),function e(t){var n,r=Object(Dn.a)(t);try{for(r.s();!(n=r.n()).done;){var c,a,i=n.value;switch(i.layerType){case ge.a.MAIN_LAYER:i.category=null!=(c=i.category)?c:0,i.mode=null!=(a=i.mode)?a:0;case ge.a.IMAGE_LAYER:var o,u,s,l,d,b,p=i.data;p.imageTransform=Fn()({offsetX:0,offsetY:0,rotate:0,scale:1,flipH:!1,flipV:!1,widthRatio:1,heightRatio:1},p.imageTransform),i.rotate=null!=(o=i.rotate)?o:0,i.opacity=null!=(u=i.opacity)?u:1,i.lock=null!=(s=i.lock)&&s,i.shine=null!=(l=i.shine)&&l,i.hidden=null!=(d=i.hidden)&&d,i.category=null!=(b=i.category)?b:1;break;case ge.a.GROUP_LAYER:e(i.children)}}}catch(e){r.e(e)}finally{r.f()}}(n),e.next=4,Kn.beforeInitLayers(n);case 4:return e.next=6,t.initLayers(n);case 6:return e.next=8,Kn.afterInitLayers(n);case 8:Object(U.b)(),setTimeout((function(){C(P)}),500);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(f.a)(Object(b.a)().mark((function e(t){var n,r,c,a;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.data,n=a.type,r=a.id,c=a.url,a=a.layers,n!==Ve.OPEN)e.next=11;else{if(r)return z(r),e.abrupt("return");e.next=5}break;case 5:if(c)return B(Jn(c,F)),e.abrupt("return");e.next=8;break;case 8:if(a)return H(a),e.abrupt("return");e.next=11;break;case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(u.useEffect)((function(){var e,t,n;return window.addEventListener("message",V),N&&(t=R,"sample"===(e=N)?(n=pe.i[Math.floor(Math.random()*pe.i.length)],B(n.url,n.name)):Object(ge.s)(e)?(n=e,"image-editor-sdk"===D&&F&&(n=Jn(e,F)),B(n,t)):(n=Gn(decodeURIComponent(e)))&&H(n)),function(){window.removeEventListener("message",V)}}),[])}(),r=Object(D.c)(),c=Object(M.d)(),a=Object(A.a)(),i=Object(D.g)(),o=Object(u.useState)(""),s=(o=Object(j.a)(o,2))[0],l=o[1],d=Object(y.b)((function(e){return e.stageModel})).setEnterType,O=En(),Object(u.useEffect)((function(){!function(){var e=Object(f.a)(Object(b.a)().mark((function e(){return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=l,e.next=3,de.a.getRemoteUrlAsync(i);case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[i]),Object(ee.b)({stage:{naturalImage:s},fileName:r+"_\u526f\u672c",initHandler:(n=Object(f.a)(Object(b.a)().mark((function e(t,n,r){var i;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.show(),d("record"),e.next=4,O();case 4:return i=e.sent,a.initLayers(t,n,pe.h,r,i),e.next=8,Object(U.b)();case 8:case"end":return e.stop()}}),e)}))),function(e,t,r){return n.apply(this,arguments)})}),Object(de.c)(),h=Object(Mn.a)(),Object(u.useEffect)((function(){var e=v.a.parse(window.location.search);((null==e?void 0:e.theme)||h.theme)===Rn.white?h.setWhiteTheme():h.setDarkTheme()}),[]),Object(u.useEffect)((function(){var e,t,n,r;"sogou"===Ln&&(e=document.querySelector(".p-editor__container"),t=document.createElement("div"),n=document.createElement("img"),(r=document.createElement("span")).innerText="\u5f53\u524d\u6d4f\u89c8\u5668\u5bfc\u81f4\u90e8\u5206\u529f\u80fd\u65e0\u6cd5\u6b63\u5e38\u4f7f\u7528\uff0c\u5efa\u8bae\u60a8\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\u3002",n.src="https://titan-img.meitudata.com/mini-program/xiuxiu/icon-tip.png",t.appendChild(n),t.appendChild(r),t.classList.add("p-editor__tips"),null!=e&&null!=(n=e.parentNode)&&n.insertBefore(t,e),e.setAttribute("style","height: calc(100vh - 100px)"))}),[]),Object(u.useEffect)((function(){var e=(new Date).getTime(),t=(null==(t=window.performance.timing)?void 0:t.navigationStart)||window.startTime;window._stat_track("interface_render_durations",{duration:e-t})}),[]),null})),er=(n(1179),o.a.memo((function(){var e=Object(s.a)();return Object(h.jsxs)(d.a,{children:[Object(h.jsx)(d.b,{type:d.c.header,children:Object(h.jsx)(it,{})}),Object(h.jsx)(d.b,{type:d.c.menu,children:Object(h.jsx)(lt,{})}),Object(h.jsx)(d.b,{type:d.c.collapse,children:Object(h.jsx)(_t,{})}),Object(h.jsx)(d.b,{type:d.c.stage,theme:e.theme,children:Object(h.jsx)(jn,{})}),Object(h.jsx)(d.b,{type:d.c.panel,children:Object(h.jsx)(mn,{})}),Object(h.jsxs)(d.b,{type:d.c.extra,children:[Object(h.jsx)(l.a,{}),Object(h.jsx)(gn,{})]})]})}))),tr=(bt=function(e){e&&e instanceof Function&&n.e(30).then(n.bind(null,1297)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP;t=t.getTTFB;n(e),r(e),c(e),a(e),t(e)}))},n(148)),nr=n(1198),rr=n(1200),cr=(pt=n(637),n.n(pt)),ar=n(1187),ir=[];window._stat_track=function(e,t){ir.push({name:e,options:t})},ft=function(){var e=Object(f.a)(Object(b.a)().mark((function e(){var t,n,r,c,a,i,o;return Object(b.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(tr.c)()&&(window._stat_track=function(e,t){}),t={},e.prev=2,e.t0=Object,e.t1=t,e.next=7,Object(nr.c)().then(rr.b);case 7:e.t2=e.sent,e.t0.assign.call(e.t0,e.t1,e.t2),e.next=14;break;case 11:e.prev=11,e.t3=e.catch(2),cr.a.captureException(e.t3,{logger:"@meitu/fingerprint"});case 14:(n=v.a.parse(window.location.search)).channel&&(qn("channel",n.channel),qn("first_url",decodeURIComponent(n.first_url||"")||window.location.href)),null!=(a=window.mtstat)&&a.init({app_key:"43815DC54A66BEE8",app_version:"2.8.0.0",app_language:"zh-CN",env:"release",log_level:Object(tr.c)()?1:0,debug:Object(tr.c)(),channel:n.channel&&decodeURIComponent(n.channel)||Wn("channel")||"",module_id:"tpbj"}),(a=window.localStorage.getItem("uid"))&&null!=(r=window.mtstat)&&r.login(a),n.platform&&("image-editor-sdk"===n.origin?null!=(r=window.mtstat)&&r.setCommonParams({is_sdk:"image_editor_sdk",company_key:n.platform}):(a=n.platform,"pc"===n.platform&&(a="macos"),null!=(c=window.mtstat)&&c.setCommonParams({operate_source:a}))),null!=(c=window.mtstat)?e.next=24:e.next=29;break;case 24:return e.t4=c,e.next=27,Object(ar.a)({});case 27:e.t5=e.sent,e.t4.setGid.call(e.t4,e.t5,"web");case 29:return null!=(a=window.mtstat)&&a.setCommonParams(Object(p.a)({first_url:decodeURIComponent(n.first_url||Wn("first_url")||""),channel:n.channel&&encodeURIComponent(n.channel)||Wn("channel")||""},t)),null!=(i=window.mtstat)&&i.setCommonParams({func_enter:"tpbj"}),window._stat_track=function(e,t){var n;window.mtstat&&0!==ir.length&&(ir.forEach((function(e){var t;null!=(t=window.mtstat)&&t.track(e.name,e.options)})),ir=[]),null!=(n=window.mtstat)&&n.track(e,t)},null!=(i=window.mtstat)&&i.pageview({title:document.title,url:window.location.href,station:(u=void 0,-1!==(u=document.referrer).indexOf("pc.meitu.com")||-1!==u.indexOf("account.meitu.com")?1:0)}),e.next=35,Object(nr.b)();case 35:return(i=e.sent)&&null!=(o=window.mtstat)&&o.track.apply(null,Object(rr.a)(i)),e.next=39,Object(Xn.c)();case 39:window._stat_track("tpbj_enter",{source:n.from||"other"});case 40:case"end":return e.stop()}var u}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}();window._stat_track=window._stat_track||function(){},ft(),Object(se.b)({type:"editor",env:Object(tr.d)()?se.a.Release:se.a.Test}),c.a.render(Object(h.jsx)(t.a,{store:y.a,children:Object(h.jsx)((function(){var e=Object(y.c)((function(e){return e.downloadModel.showDownloadTip}));return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)($n,{}),Object(h.jsx)(er,{}),Object(h.jsx)(ne,{}),Object(h.jsx)(_n.a,{show:e}),Object(h.jsx)(xn,{})]})}),{})}),document.getElementById("root")),bt()},119:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return u})),n.d(t,"f",(function(){return s}));var r=n(18),c=function(){return{isSaving:Object(r.c)((function(e){return e.editor.saveInfoModel.isSaving})),isAutoSaving:Object(r.c)((function(e){return e.editor.saveInfoModel.isAutoSaving})),saveTooltipText:Object(r.c)((function(e){return e.editor.saveInfoModel.saveTooltipText})),saveType:Object(r.c)((function(e){return e.editor.saveInfoModel.saveType}))}},a=function(){return Object(r.b)((function(e){return e.editor.saveInfoModel.setIsSaving}))},i=function(){return Object(r.b)((function(e){return e.editor.saveInfoModel.setIsAutoSaving}))},o=function(){return Object(r.b)((function(e){return e.editor.saveInfoModel.changeSaveTooltipText}))},u=function(){return Object(r.b)((function(e){return e.editor.saveInfoModel.resetSaveTooltipText}))},s=function(){return Object(r.b)((function(e){return e.editor.saveInfoModel.setSaveType}))}},142:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));t=n(63);var r=n.n(t),c=n(55),a=function(){return r.a.parse(window.location.search).t||localStorage.getItem("access_token")},i=function(){return c.a}},148:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i}));var r=function(){return!!Object({NODE_ENV:"production",PUBLIC_URL:"https://pc.meitudata.com/image-editor",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_STAT_ENV:"release",REACT_APP_ENV:"release",REACT_APP_PREVIEW_MODE:"0",REACT_APP_APP_KEY:"43815DC54A66BEE8",REACT_APP_TITLE:"\u7f8e\u56fe\u79c0\u79c0-\u56fe\u7247\u7f16\u8f91",REACT_APP_USER_API_POLICY:"/image/editor/",REACT_APP_USER_API_POLICY_LOCAL:"/",REACT_APP_USER_API_MAAT:"/image/editor/",REACT_APP_USER_API_MAAT_LOCAL:"/",REACT_APP_USER_API_ORIGIN_LOCAL:"/user/api",REACT_APP_CLIENT_ID:"1189857435",REACT_APP_USER_API_OFFICE:"/user/office",REACT_APP_USER_API_OFFICE_LOCAL:"/user/office",REACT_APP_LANGUAGE:"zh-Hans",REACT_APP_RELEASE:"version_202311081138"}).REACT_APP_LOCAL},c=function(){return!1},a=function(){return!0},i=function(){return r()?"":"/image/edit"}},154:function(e,t,n){"use strict";function r(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];return Object(d.n)({width:t,height:n,data:{url:e,maskURL:"",stretchOption:2,naturalWidth:t,naturalHeight:n,isTransparent:r,imageTransform:{offsetX:0,offsetY:0,rotate:0,scale:1,flipH:!1,flipV:!1,widthRatio:1,heightRatio:1},maskType:0,cutoutMaskURL:""}})}n.d(t,"a",(function(){return T}));var c=n(5),a=n(4),i=n(11),o=n(16),u=n(13),s=n(2),l=n(18),d=n(23),b=n(172),p=n(34),f=n(45),j=n(10),O=n(43),m=n(29),h=n(119),g=n(17),_=n(86),v=n(233),w=n(42),x=n(123),y=n(55),k=n(107),E=n(208),T=function(){function e(t,n){for(var r=[],c=[],a=[],i=0;i<t.length;i++){var u,l=t[i];l.layerType===s.h.TEXT_LAYER&&((null==n?void 0:n.layerType)!==s.h.TEXT_MATERIAL_LAYER?r:c).push(l),l.layerType===s.h.TEXT_MATERIAL_LAYER&&a.push(l),null!=(u=l.children)&&u.length&&(u=e(l.children||[],l),r=[].concat(Object(o.a)(r),Object(o.a)(u.baseTexts)),c=[].concat(Object(o.a)(c),Object(o.a)(u.materialTexts)),a=[].concat(Object(o.a)(a),Object(o.a)(u.textMaterials)))}return{baseTexts:r,materialTexts:c,textMaterials:a}}var t,n=Object(h.a)(),T=Object(l.b)((function(e){return e.stageModel.create})),S=Object(l.b)((function(e){return e.templateModel.setIsInit})),I=Object(_.b)(),A=Object(b.e)(),C=Object(j.w)().addOrUpdate,L=Object(f.d)(),N=Object(m.h)(),M=Object(O.j)(),R=Object(f.d)(),P=Object(O.k)(),U=Object(k.b)(),D=Object(g.c)(),F=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var n,r,c,i,o,u,l;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=[],r=[],null!=t&&t.length){e.next=4;break}return e.abrupt("return",{fontsDisabled:n,fontsDisabledTextLayers:r});case 4:return c=[],t.forEach((function(e){(e=null==(e=e.data)?void 0:e.materialId)&&!v.c.get(e)&&c.push(e)})),c=Array.from(new Set(c)),i=c.join(","),e.next=10,Object(E.g)({ids:i});case 10:i=e.sent,o=i.data.data,c.forEach((function(e){var t=o[e];t&&t.material_conf_v3&&(t=t.material_conf_v3.layers,v.c.set(e,t[0]))})),u=Object(a.a)().mark((function e(){var c,i,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t[l],i=c.data.materialId,i=v.c.get(i)){e.next=5;break}return e.abrupt("return",1);case 5:Object(v.d)(i,c.width-i.width,{left:c.left,top:c.top},c.rotate,!0,!1),o=i.children.filter((function(e){return e.layerType===s.h.TEXT_LAYER})),c.children.filter((function(e){return e.layerType===s.h.TEXT_LAYER})).forEach((function(e,t){var c=e.data.fontFamily;(t=(I.find((function(e){return e.font_name===c}))||(e.data=Object.assign({},e.data,{fontFamily:s.c.name}),n.includes(c)||n.push(c),r.push(e)),o[t]))&&(t.data=Object.assign({},e.data,{fontSize:t.data.fontSize}),t.opacity=e.opacity)})),C(i);case 10:case"end":return e.stop()}}),e)})),l=0;case 15:if(l<t.length)return e.delegateYield(u(),"t0",17);e.next=22;break;case 17:if(e.t0)return e.abrupt("continue",19);e.next=19;break;case 19:l++,e.next=15;break;case 22:return e.abrupt("return",{fontsDisabled:n,fontsDisabledTextLayers:r});case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{initLayers:(t=Object(i.a)(Object(a.a)().mark((function t(r,i){var l,b,p,f,j,O,m,h,g,_,v,k,E,A,U,G=arguments;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=2<G.length&&void 0!==G[2]?G[2]:y.h,b=3<G.length?G[3]:void 0,I=(4<G.length?G[4]:void 0)||I,D.init(),R.show(),p=r.find((function(e){return e.layerType===s.h.MAIN_LAYER})),f=0;case 8:if(f<r.length)if("background"!==(j=r[f]).layerType)t.next=23;else{if(j.layerType=s.h.BACKGROUND_LAYER,(O=j.data).url)return t.next=16,Object(d.u)(O.url);t.next=20}else t.next=26;break;case 16:v=t.sent,g=v.width,v=v.height,O="repeat"===O.type?Object(c.a)(Object(c.a)({},O),{},{backgroundColor:"",naturalWidth:null==p?void 0:p.width,naturalHeight:null==p?void 0:p.height,stretchOption:s.u.repeat}):(h=Object(x.d)({imgWidth:g,imgHeight:v,stageHeigh:(null==p?void 0:p.height)||0,stageWidth:(null==p?void 0:p.width)||0}),m=h.widthRatio,h=h.heightRatio,Object(c.a)(Object(c.a)({},O),{},{imageTransform:Object(c.a)(Object(c.a)({},O.imageTransform),{},{widthRatio:m,heightRatio:h}),backgroundColor:"",naturalWidth:g,naturalHeight:v,stretchOption:s.u.cover}));case 20:O.color&&(O.backgroundColor=O.color,delete O.color),j.data=O,j.useFontFamilySubset=!1;case 23:f++,t.next=8;break;case 26:return m=e(r,void 0),h=m.baseTexts,g=m.materialTexts,_=m.textMaterials,(v=[].concat(Object(o.a)(h),Object(o.a)(g))).map((function(e){return delete e.data.fontFamilySubset,delete e.useFontFamilySubset,e.data.fontFamily})),k=[],E=[],h.forEach((function(e){var t=e.data.fontFamily;I.find((function(e){return e.font_name===t}))||(e.data.fontFamily=s.c.name,k.includes(t)||k.push(t),E.push(e))})),a=r,(z=l)!==y.c["1.0.0"]&&""!==z||Object(d.v)(a,(function(e){e.layerType===s.h.IMAGE_LAYER&&(e.data.stretchOption=s.u.fill)})),t.next=35,Object(d.f)(v,I);case 35:return r.filter((function(e){return e.layerType!==s.h.TEXT_MATERIAL_LAYER})).forEach((function(e){C(e)})),t.next=38,F(_);case 38:U=t.sent,A=U.fontsDisabled,U=U.fontsDisabledTextLayers,L.hide(),A=Array.from(new Set([].concat(Object(o.a)(A),k))),U=Array.from(new Set([].concat(Object(o.a)(U),E))),A.length&&(U.forEach((function(e){w.f.shine(e.id)})),u.i.warn("".concat(A.join("\u3001"),"\u5b57\u4f53\u5df2\u4e0b\u67b6\uff0c\u5df2\u5e2e\u60a8\u66ff\u6362\u6210\u963f\u91cc\u5df4\u5df4\u666e\u60e0\u4f53"))),M({width:(null==p?void 0:p.width)||0,height:(null==p?void 0:p.height)||0}),i&&T(i),N.open(),S(!0),n(),b&&P(b);case 51:case"end":return t.stop()}var a,z}),t)}))),function(e,n){return t.apply(this,arguments)}),createImg:function(e){D.init(),U(),L.show();var t=new Image;t.onload=Object(i.a)(Object(a.a)().mark((function c(){var i,o;return Object(a.a)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,p.a.uploadImgAsync(t.src,t.src);case 2:o=p.a.getCode(e.imgSrc),i=e.imgSrc.match(/image\/(\S*);/)?e.imgSrc.match(/image\/(\S*);/)[1]:"png",i={naturalImage:o,naturalFileName:e.name||"\u672a\u547d\u540d\u56fe\u7247",naturalFileSize:0,naturalFileSuffix:i},M({width:t.width,height:t.height}),T(i),i=r(o,t.width,t.height),o=A.create({width:t.width,height:t.height,backgroundColor:""}),N.open(),C(o),C(i),L.hide(),S(!0),n();case 15:case"end":return c.stop()}}),c)}))),t.src=e.imgSrc},createBackground:function(e){D.init(),U();var t,c=e.width,a=e.height,i=(t=Object(d.e)(c,a)).ctx,o=(t=t.canvas).toDataURL();e.backgroundColor&&(i.fillStyle=e.backgroundColor||"",i.fillRect(0,0,c,a)),M({width:c,height:a}),i=t.toDataURL(),T({naturalImage:i,naturalFileName:"\u672a\u547d\u540d\u56fe\u7247",naturalFileSize:0,naturalFileSuffix:"png"}),c=A.create(e),a=r(o,e.width,e.height,e.isTransparent);N.open(),C(c),C(a),S(!0),n()}}}},177:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return p})),n(5);var r=n(4),c=n(11),a=n(44),i=(n(112),n(175),n(56)),o=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)("".concat(Object(i.a)(),"/api/v1/user/records"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)("".concat(Object(i.a)(),"/api/v1/user/record_delete"),{method:"POST",data:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)("".concat(Object(i.a)(),"/api/v1/user/save_material"),{method:"POST",data:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)("".concat(Object(i.a)(),"/api/v1/user/materials"),{method:"GET",params:t,hideErrorToast:!0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)("".concat(Object(i.a)(),"/api/v1/user/delete_materials"),{method:"POST",data:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)("".concat(Object(i.a)(),"/api/v1/user/record_save"),{method:"POST",data:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)("".concat(Object(i.a)(),"/api/v1/user/record_detail"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},178:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));t=n(148);var r=(Object(t.c)(),{url:"https://material-center.meitudata.com/material/image/61615aef9f64d8971.png",width:548,height:493}),c="https://xiuxiupro-material-center.meitudata.com/poster/dac43e9d71b0628d11b2588cc9b8ed18.jpg",a=["image/png","image/jpg","image/jpeg","image/heic",".heic"]},18:function(e,t,n){"use strict";n.d(t,"c",(function(){return U})),n.d(t,"b",(function(){return D}));var r=n(17),c=n(12),a=n(28),i=(a={destroy:Object(c.b)((function(e){})),currentType:a.b.ADJUST_MENU,setCurrentType:Object(c.b)((function(e,t){e.currentType=t})),isLock:!0,setIsLock:Object(c.b)((function(e,t){e.isLock=t})),functionTip:null,setFunctionTip:Object(c.b)((function(e,t){e.functionTip=t}))},{curTemplateId:-1,curTemplateType:n(581).a.TYPE_TEMPLATE,categories:[],setCategories:Object(c.b)((function(e,t){e.categories=t})),setCurTemplateId:Object(c.b)((function(e,t){e.curTemplateId=t})),setCurTemplateType:Object(c.b)((function(e,t){e.curTemplateType=t}))}),o=n(15),u=n.n(o),s=(o={recentUsedList:null,recentBGUsedList:null,recentTextUsedList:null,recentWatermarkUsedList:null,setRecentTextUsedList:Object(c.b)((function(e,t){e.recentTextUsedList=u()(t)})),setRecentWatermarkUsedList:Object(c.b)((function(e,t){e.recentWatermarkUsedList=u()(t)})),setRecentBGUsedList:Object(c.b)((function(e,t){e.recentBGUsedList=u()(t)})),setRecentUsedList:Object(c.b)((function(e,t){e.recentUsedList=u()(t)}))},{currentType:"",setCurrentType:Object(c.b)((function(e,t){e.currentType=t}))}),l=n(282),d={stageSizeList:[],setStageSizeList:Object(c.b)((function(e,t){e.stageSizeList=u()(t)}))},b=n(159),p=n(179),f=n(172),j=n(45),O={destroy:Object(c.b)((function(e){})),isInit:!1,templateName:"",editorWidth:0,editorHeight:0,preview:"",version:"",id:"",setIsInit:Object(c.b)((function(e,t){e.isInit=t})),initTemplateInfo:Object(c.b)((function(e,t){var n=t.id,r=t.version,c=t.preview,a=t.editorWidth;t=t.editorHeight;e.id=n,e.version=r,e.preview=c,e.editorWidth=a,e.editorHeight=t})),setTemplateId:Object(c.b)((function(e,t){e.id=t})),setVersion:Object(c.b)((function(e,t){e.version=t})),setPreview:Object(c.b)((function(e,t){e.preview=t})),setStageSize:Object(c.b)((function(e,t){var n=t.width;t=t.height;e.editorWidth=n,e.editorHeight=t})),setTemplateName:Object(c.b)((function(e,t){e.templateName=t}))},m=n(213),h=n(41),g=n(89),_=n(5),v={id:"",material_id:0,category_id:void 0,topic_id:void 0,temp_topic_id:void 0,threshold:0,switchTemplateNum:1,isRecording:!1},w={vipModalShow:!1,vipModalParams:"",setVipModalShow:Object(c.b)((function(e,t){e.vipModalShow=t})),setVipModalParams:Object(c.b)((function(e,t){e.vipModalParams=t})),recordInfo:v,getRecordId:Object(c.g)((function(e,t,n){return n.getState().recordInfo.id})),setRecordInfo:Object(c.b)((function(e,t){e.recordInfo=Object(_.a)(Object(_.a)({},e.recordInfo),t)})),resetRecordInfo:Object(c.b)((function(e){e.recordInfo=v}))},x={isVipTemplate:!1,watermarkShow:!1,thresholdIdList:[],materialList:[],materialIdList:[],thresholdIdMap:new Map,setMaterialIdList:Object(c.b)((function(e,t){e.materialIdList=t})),setIsVipTemplate:Object(c.b)((function(e,t){e.isVipTemplate=t})),setThresholdIdList:Object(c.b)((function(e,t){e.thresholdIdList=t})),setThresholdIdMap:Object(c.b)((function(e,t){e.thresholdIdMap=t})),setMaterialList:Object(c.b)((function(e,t){e.materialList=t})),setWatermarkShow:Object(c.b)((function(e,t){e.watermarkShow=t})),destroy:Object(c.b)((function(e){e.watermarkShow=!1,e.materialList=[],e.thresholdIdList=[],e.thresholdIdMap=new Map}))},y=n(431),k=n(257),E={is_search:"1",class:"",query:"",scm:"",setISearchInfo:Object(c.b)((function(e,t){e.is_search=t.is_search||"",e.class=t.class||"",e.query=t.query||"",e.scm=t.scm||""})),setIsSerch:Object(c.b)((function(e,t){e.is_search=t})),setClass:Object(c.b)((function(e,t){e.class=t})),setQuery:Object(c.b)((function(e,t){e.query=t})),setScm:Object(c.b)((function(e,t){e.scm=t}))},T={data:[],setData:Object(c.b)((function(e,t){e.data.unshift(t),20<e.data.length&&e.data.pop()}))},S={originCanvas:null,setOriginCanvas:Object(c.b)((function(e,t){e.originCanvas=t})),oldOriginCanvas:{},setOldOriginCanvas:Object(c.b)((function(e,t){var n=t.id;t=t.canvas;e.oldOriginCanvas[n]=t})),filterCanvas:{},setFilterCanvas:Object(c.b)((function(e,t){var n=t.id;t=t.canvas;e.filterCanvas[n]=t})),clearOriginCanvas:Object(c.b)((function(e){e.originCanvas=null,e.filterCanvas={}})),isConfirm:!1,setIsConfirm:Object(c.b)((function(e,t){e.isConfirm=t}))},I={download:!1,downloadModelShow:!1,setDownloadModelShow:Object(c.b)((function(e,t){t&&!e.downloadModelShow&&window._stat_track("picture_download_icon_click",{source:"tpbj"}),e.downloadModelShow=t})),setDownload:Object(c.b)((function(e,t){e.download=t})),showDownloadTip:!1,setShowDownloadTip:Object(c.b)((function(e,t){e.showDownloadTip=t})),copyrightVisible:!1,setCopyrightVisible:Object(c.b)((function(e,t){e.copyrightVisible=t}))},A=n(139),C=function(e){return e.naturalImage="naturalImage",e.naturalFileSize="naturalFileSize",e.naturalFileName="naturalFileName",e.fileName="fileName",e.scale="scale",e.autoScale="autoScale",e.isCropStage="isCropStage",e.initVersion="initVersion",e.recordId="recordId",e}({}),L={destroy:Object(c.b)((function(e){e.naturalImage="",e.naturalFileSize=0,e.naturalFileName="",e.fileName="",e.isCropStage=!1,e.initVersion=Object(A.a)(),e.recordId=""})),getStateByName:Object(c.b)((function(e,t){var n=t.payload,r=t.callback;switch(n){case C.naturalImage:r(e.naturalImage);break;case C.naturalFileSize:r(e.naturalFileSize);break;case C.naturalFileName:r(e.naturalFileName);break;case C.fileName:r(e.fileName);break;case C.isCropStage:r(e.isCropStage);break;case C.initVersion:r(e.initVersion);break;case C.recordId:r(e.recordId);break;default:r(null)}})),initVersion:"",naturalImage:"",setNaturalImage:Object(c.b)((function(e,t){e.naturalImage=t})),naturalFileSize:0,naturalFileName:"",naturalFileSuffix:"",isCropStage:!1,recordId:"",setRecordId:Object(c.b)((function(e,t){e.recordId=t})),create:Object(c.b)((function(e,t){e.naturalImage=t.naturalImage,e.naturalFileSize=t.naturalFileSize,e.naturalFileName=t.naturalFileName,e.naturalFileSuffix=t.naturalFileSuffix,e.fileName=t.naturalFileName})),setIsCropStage:Object(c.b)((function(e,t){e.isCropStage=t})),maxFileSize:10240,maxDimensions:8e3,fileName:"",updateFileName:Object(c.b)((function(e,t){e.fileName=t})),triggerCreate:!1,openCreateDialog:Object(c.b)((function(e,t){e.triggerCreate=t})),contrast:null,setContrast:Object(c.b)((function(e,t){e.contrast=t})),enterType:"",setEnterType:Object(c.b)((function(e,t){e.enterType=t}))},N={data:null,show:!1,setShow:Object(c.b)((function(e,t){e.show=t})),setData:Object(c.b)((function(e,t){e.data=t}))},M=n(349),R=(n=n(284),{currentType:"",setCurrentType:Object(c.b)((function(e,t){e.currentType=t}))}),P={isSubscribeTest:!1,setIsSubscribeTest:Object(c.b)((function(e,t){e.isSubscribeTest=t}))},U=(a={collapseModel:a,templateCollapseModel:i,mineCollapseModel:l.b,stageSizeCollapseModel:d,materialCollapseModel:o,adjustCollapseModel:s,watermarkModel:x,recordModel:w,saveInfoModel:k.b,searchModel:E,VConsoleModel:T,penCollapseModel:R,customAdModel:N,AbTestModel:P},i=Object(c.e)({sdk:r.a,editor:a,templateModel:O,displacementModel:b.b,globalMaskModel:j.b,userInfoModel:g.c,vipModel:y.b,watermarkLayerModel:p.j,backgroundModel:f.d,filterModel:S,dragAndDropImageModel:M.c,svgPenModel:m.o,mainLayerModel:h.v,downloadModel:I,stageModel:L,imageMattingModel:n.b,customAdModel:N}),(l=Object(c.f)()).useStoreState),D=l.useStoreActions;l.useStoreDispatch,t.a=i},204:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return j}));var r,c=n(4),a=n(11),i=n(625),o=n(456),u=n(104),s=n(1187),l={},d=function(){var e=Object(a.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)();case 2:return t=e.sent,e.abrupt("return",{appKey:"43815DC54A66BEE8",env:"release",custom:[{type:o.b.WebGid,value:t}]});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t,n){var a,i;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(s.a)({});case 3:return e.sent,e.next=6,Object(u.a)();case 6:return e.sent,e.t0=Object,e.next=11,d();case 11:return e.t1=e.sent,e.t2=n,a=e.t0.assign.call(e.t0,e.t1,e.t2),a=new o.a(a),e.next=18,a.init();case 18:if(l=(r=a).getABInfo(),window.sessionStorage.setItem("AB_TEST_INFO",JSON.stringify(l)),null!=(i=window)&&null!=(i=i.mtstat)&&i.setABInfo(l),t)return e.next=25,null==(i=r)?void 0:i.isInABTesting(+t);e.next=25;break;case 25:e.next=30;break;case 27:e.prev=27,e.t3=e.catch(0);case 30:case"end":return e.stop()}}),e,null,[[0,27]])})));return function(t,n){return e.apply(this,arguments)}}(),p=function(){return l},f=function(){var e=Object(a.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i.clientInfo.isClient){e.next=17;break}if(r){e.next=5;break}return e.next=5,b();case 5:if(null!=(t=r)&&t.isInABTesting(20752))return e.abrupt("return",!1);e.next=10;break;case 10:if(null!=(t=r)&&t.isInABTesting(20751))return e.abrupt("return",!0);e.next=13;break;case 13:case 17:return e.abrupt("return",!1);case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(){return e.apply(this,arguments)}}(),j=function(e){return e.PHONE="phone",e.WECHAT="wechat",e.OLD="old",e}({})},208:function(e,t,n){"use strict";n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"l",(function(){return d})),n.d(t,"h",(function(){return b})),n.d(t,"j",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return O})),n.d(t,"m",(function(){return m})),n.d(t,"k",(function(){return h})),n.d(t,"n",(function(){return g})),n.d(t,"a",(function(){return _})),n.d(t,"o",(function(){return v})),n.d(t,"d",(function(){return w})),n.d(t,"i",(function(){return x}));var r=n(5),c=n(4),a=n(11),i=n(55),o=n(56),u=n(44),s=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.d)("/user/api"),"/operation/material_list.json"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)("/api"),"/v2/materials/get_by_ids"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/material/recent_used_list"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)("/api"),"/v2/material/categories"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/material/sticker/newest"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/material/sticker/list_with_category"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/material/filter/category"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/material/filter/list_with_category"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t,n){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/material/save_recent_used"),{method:"POST",params:Object(r.a)(Object(r.a)({},t),{},{client_id:i.a}),data:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(a.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.d)("/user/api"),"/operation/material_list.json"),{method:"GET",params:{type:"preset_size_material"}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/search"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/tag/category_tag_list"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/search/suggest"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)(),"/api/v1/search/hot_words"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)("".concat(Object(o.a)("/api"),"/v2/materials"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},240:function(e,t,n){"use strict";n.d(t,"a",(function(){return Y}));t=n(3);var r,c=n(0),a=n.n(c),i=n(23),o=n(28),u=n(8),s=n(13),l=n(4),d=n(11),b=n(129),p=n.n(b),f=(b=n(15),n.n(b)),j=n(98),O=n(41),m=(n(600),n(45)),h=n(1),g=a.a.memo((function(e){var t=e.onTrack,n=(e=Object(O.z)()).getHSLFromColors,r=e.applyEnhanceAndPushHistory,c=(e.getMaskData,Object(O.C)()),a=Object(O.G)(),i=Object(O.L)(),o=(e=Object(O.A)(),Object(O.K)()),s=a.type===O.u.All,b=s?(null==(e=e[2])?void 0:e.color)||"":a.color,g=(e=b.split(","),(e=Object(u.a)(e,4))[0]),_=e[1],v=e[2],w=(e=e[3],Object(m.d)()),x=p()(function(){var e=Object(d.a)(Object(l.a)().mark((function e(u){var d,p,m,h,g,_;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,w.show(),h=s?b:a.color,_=(_=Object(j.d)(u.color)).rgba,d=_.r,p=_.g,m=_.b,_=_.a,_="".concat(d,",").concat(p,",").concat(m,",").concat(_),e.next=8,n(h,_);case 8:return h=e.sent,g={pickColors:b,hslPickColors:h,isHslSelectAll:s,color:{}},s&&(g.color=Object(O.t)(h)),null!=c&&c.maskCode&&(g.maskCode=c.maskCode),_={old:f()(c),new:f()(g)},o({info:g,index:-1}),e.next=16,r(g,_);case 16:i(g),window._stat_track("quick_color_change_click",{func:"free_change",area_type:"contents",func_detail:"palette_".concat(d,"*").concat(p,"*").concat(m)}),null!=t&&t("pick"),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(0),w.hide();case 25:return e.prev=25,w.hide(),e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[0,21,25,28]])})));return function(t){return e.apply(this,arguments)}}(),300);return Object(h.jsx)("div",{className:"intelligent-sketch-picker",children:Object(h.jsx)(j.c,{onChange:x,color:{r:+g,g:+_,b:+v,a:+e/255}})})})),_=n(5),v=(b=n(9),n.n(b)),w=a.a.memo((function(e){var t=e.data,n=e.onClick,r=e.index;e=Object(O.F)(),t=t.url;return Object(h.jsxs)("div",{className:v()("intelligent-preview-list__item",{active:e===r}),onClick:function(){return n(r)},children:[0===r?Object(h.jsx)("span",{children:"\u539f\u56fe"}):null,Object(h.jsx)("img",{src:t})]})})),x=a.a.memo((function(e){var t=e.onTrack,n=Object(O.D)(),r=Object(O.K)(),a=Object(O.G)(),i=(e=Object(O.z)()).applyEnhanceAndPushHistory,o=e.getMaskData,s=Object(O.C)(),b=Object(O.L)(),p=(e=Object(c.useState)(-1),(e=Object(u.a)(e,2))[0]),j=e[1],g=(e=Object(c.useState)(!1),(e=Object(u.a)(e,2))[0]),v=e[1],x=Object(m.d)(),y=(Object(c.useEffect)((function(){j(-1)}),[n]),function(){var e=Object(d.a)(Object(l.a)().mark((function e(c){var u,d,m,h,w;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,p===c)return e.abrupt("return");e.next=3;break;case 3:return x.show(),u=f()(n[c]),(d=a.type===O.u.All)&&(u.color=Object(O.s)(+u.color)),m=Object(_.a)(Object(_.a)({},f()(u)),{},{isHslSelectAll:d}),h={info:m,index:c},e.next=11,o();case 11:return(w=e.sent)&&(m.maskCode=w),delete(w={old:f()(s),new:f()(m)}).new.url,delete w.old.url,r(h),e.next=19,i(m,w);case 19:b(f()(m)),0!==p&&v(!0),j(c),0===c?g&&window._stat_track("quick_color_change_click",{func:"free_change",area_type:"contents",func_detail:"rec_origin"}):window._stat_track("quick_color_change_click",{func:"free_change",area_type:"contents",func_detail:(d?u.hslPickColors:u.color.split(",").slice(0,3)).join("*")}),null!=t&&t("recommend"),e.next=30;break;case 26:e.prev=26,e.t0=e.catch(0),x.hide();case 30:return e.prev=30,x.hide(),e.finish(30);case 33:case"end":return e.stop()}}),e,null,[[0,26,30,33]])})));return function(t){return e.apply(this,arguments)}}());return Object(h.jsx)("div",{className:"intelligent-preview-list",children:n.map((function(e,t){return Object(h.jsx)(w,{index:t,data:e,onClick:y},t)}))})})),y=(b=n(114),n.n(b)),k=function(e){return e.HUE="hue",e.SLIDER="slider",e}({}),E=[{title:"\u8272\u76f8",max:180,min:-180,value:0,tipText:"\u8272\u76f8\u6307\u989c\u8272\uff0c\u5982\u84dd\u8272\u3001\u7ea2\u8272\u7b49",index:0,ratio:1,rgba:[],type:"hsl_hue"},{title:"\u9971\u548c\u5ea6",max:100,min:-100,ratio:.5,value:0,tipText:"\u9971\u548c\u5ea6\u6307\u8272\u5f69\u7684\u7eaf\u5ea6\uff0c\u9971\u548c\u5ea6\u8d8a\u9ad8\u8272\u5f69\u8d8a\u6d53",index:1,rgba:[],type:"hsl_saturation"},{title:"\u660e\u5ea6",max:100,min:-100,ratio:.5,value:0,tipText:"\u660e\u5ea6\u6307\u8272\u5f69\u660e\u4eae\u7a0b\u5ea6\uff0c\u660e\u5ea6\u8d8a\u9ad8\u8272\u5f69\u8d8a\u4eae",index:2,rgba:[],type:"hsl_light"}],T={title:"\u5bb9\u5dee",max:30,min:-30,value:0,tipText:"\u5bb9\u5dee\u6307\u56fe\u4e0a\u751f\u6548\u7684\u989c\u8272\u8303\u56f4\uff0c\u5bb9\u5dee\u8d8a\u5927\uff0c\u751f\u6548\u7684\u989c\u8272\u8303\u56f4\u4e5f\u8d8a\u5927",index:3,rgba:[],type:"fuzziness",sliderType:k.SLIDER},S={0:"h",1:"s",2:"v"},I="COLOR_SLIDER_HUE",A=a.a.memo((function(e){function t(e,t,n){p&&p(e-n,t)}var n=void 0===(n=e.title)?"":n,r=void 0===(r=e.tipText)?"":r,c=void 0===(a=e.max)?180:a,a=void 0===(a=e.min)?-180:a,o=void 0===(l=e.value)?180:l,l=void 0===(l=e.ratio)?1:l,d=e.index,b=void 0===(b=e.rgba)?[]:b,p=e.onChangeValue,f=e.onAfterChangeValue,O=void 0===(m=e.type)?"":m,m=void 0!==(m=e.tooltipVisible)&&m,g=(e=void 0===(e=e.sliderType)?"hue":e,Object(i.w)((function(e,t){f&&f(e,t)}),300)),_=Math.abs(a)+c,v=(b=Object(u.a)(b,4))[0],w=b[1],x=b[2];b=b[3],v=Object(j.g)({r:+v,g:+w,b:+x,a:+b});return"h"===S[d]&&(v={h:v.h,s:100,v:100,a:v.a}),"s"===S[d]&&(v={h:v.h,s:50,v:100,a:v.a}),"v"===S[d]&&(v={h:v.h,s:100,v:50,a:v.a}),e===k.SLIDER&&setTimeout((function(){var e=document.querySelector(".COLOR_SLIDER_HUE_hsl_light > div").style.background,t=document.querySelector(".COLOR_SLIDER_HUE_fuzziness > .ant-slider-rail");t&&(t.style.background=e)}),100),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("div",{className:"intelligent-color-input",children:[Object(h.jsxs)("div",{className:"intelligent-color-input__header",children:[Object(h.jsxs)("div",{className:"intelligent-color-input__header-title",children:[n,Object(h.jsx)(s.x,{placement:"top",title:r,children:Object(h.jsx)("div",{children:Object(h.jsx)(s.d,{name:"questionmarkCircle",fontSize:18})})})]}),Object(h.jsx)(s.f,{max:c,min:a,className:"mt-slider-input__input-number",onChange:function(e){t(e,d,0),g(O,o)},showStepBtn:!0,value:o})]}),"hue"===e?Object(h.jsx)(j.b,{className:"".concat(I,"_").concat(O),width:"100%",height:2,ratio:l,hsva:v,type:S["".concat(d)],maxValue:_,value:o+c,onChange:function(e){t(e=e.value,d,c),g(O)}}):Object(h.jsx)(s.p,{className:"".concat(I,"_").concat(O),value:o,range:!1,max:c,min:a,tooltipVisible:m,onChange:function(e){return p&&p(e)},onAfterChange:function(e){f&&f(O,e)}})]})})})),C=n(19),L=n(319),N=a.a.memo((function(e){function t(e){e.path&&(e.path.map((function(e){return e.className})).includes("p-intelligent-color__hsl-card")?I(!0):I(!1))}function n(e,t){var n=f()(y).map((function(e,t){var n=[v,w,x,1];return Object(_.a)(Object(_.a)({},e),{},{rgba:n})}));n[t].value=e,k(n)}var r=e.onTrack,a=Object(O.B)(),i=(e=Object(O.z)()).applyEnhanceAndPushHistory,o=(e=(e.getMaskData,Object(O.G)()),Object(O.C)()),b=Object(O.L)(),p=Object(O.A)(),j=e.type===O.u.All,g=j?(null==(p=p[2])?void 0:p.color)||"":(null==e?void 0:e.color)||"",v=(p=g.split(","),(p=Object(u.a)(p,4))[0]),w=p[1],x=p[2],y=(p=(p[3],Object(c.useState)(f()(E))),(p=Object(u.a)(p,2))[0]),k=p[1],S=(p=Object(c.useState)(!1),(p=Object(u.a)(p,2))[0]),I=p[1],N=(p=Object(c.useState)(!1),(p=Object(u.a)(p,2))[0]),M=p[1],R=(p=Object(c.useState)(f()(T)),(p=Object(u.a)(p,2))[0]),P=p[1],U=Object(m.d)(),D=(Object(c.useEffect)((function(){P(f()(Object.assign({},f()(T),{value:(null==a?void 0:a.pickFuzziness)||0})))}),[a]),Object(c.useEffect)((function(){var e=[],t=(j?"object"==typeof(null==a?void 0:a.color)&&Object.values(a.color).length?Object.values(a.color).forEach((function(t){e.push(t[t.length-1])})):e=[0,0,0]:e=null!=a&&a.hslPickColors?a.hslPickColors:[0,0,0],f()(y).map((function(t,n){var r=[v,w,x,1];return Object(_.a)(Object(_.a)({},t),{},{value:e[n],rgba:r})})));k(t)}),[a,e,j]),Object(c.useEffect)((function(){var e;if(S&&!N)return null!=(e=document.body)&&e.addEventListener("click",t),function(){var e;null!=(e=document.body)&&e.removeEventListener("click",t)}}),[S,N]),Object(c.useEffect)((function(){return C.a.on(L.a,(function(e){I(e),M(e)})),function(){C.a.off(L.a,(function(e){I(e),M(e)}))}}),[]),function(){var e=Object(d.a)(Object(l.a)().mark((function e(t,n){var c,a,u;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=y.map((function(e){return e.value})),a={isHslSelectAll:j,color:{},pickColors:"",hslPickColors:[],pickFuzziness:0},j?a.color=Object(O.t)(c):(a.pickColors=g,a.hslPickColors=c,a.pickFuzziness=n),null!=o&&o.maskCode&&(a.maskCode=o.maskCode),u={old:f()(o),new:f()(a)},e.next=9,i(f()(a),f()(u));case 9:b(f()(a)),window._stat_track("quick_color_change_click",{func:"advanced_color",area_type:"contents",func_detail:"manual_".concat(c.join("*"))}),null!=r&&r(t),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),U.hide();case 17:return e.prev=17,U.hide(),e.finish(17);case 20:case"end":return e.stop()}}),e,null,[[0,14,17,20]])})));return function(t,n){return e.apply(this,arguments)}}());return Object(h.jsxs)("div",{className:"p-intelligent-color__hsl",children:[Object(h.jsxs)("div",{className:"p-intelligent-color__hsl-card",style:{display:"".concat(S?"block":"none")},children:[y.map((function(e,t){return Object(h.jsx)(A,Object(_.a)(Object(_.a)({},e),{},{onChangeValue:n,onAfterChangeValue:D}),t)})),j?null:Object(h.jsx)(A,Object(_.a)(Object(_.a)({},R),{},{onChangeValue:function(e){var t=f()(R);t.value=e,P(t)},onAfterChangeValue:D}))]}),Object(h.jsx)(s.a,{type:"ghost",icon:Object(h.jsx)(s.d,{name:"adjestment",fontSize:16}),onClick:function(){I(!S),null!=r&&r("high")},children:"\u624b\u52a8\u8c03\u8272"})]})})),M=n(43),R=n(521),P=n(522),U=function(e){return e.RECOMMEND="recommend",e.COLOR="color",e}({}),D=[{name:"\u63a8\u8350",tabKey:U.RECOMMEND},{name:"\u66f4\u591a\u989c\u8272",tabKey:U.COLOR}],F=(b=a.a.memo((function(){var e=Object(c.useState)(U.RECOMMEND),t=(e=Object(u.a)(e,2))[0],n=e[1],r=Object(M.h)().id;e=Object(c.useCallback)((function(e){var t=R.a[o.a.ADJUST_INTELLIGENT];t=Object(P.a)(t,e);window._stat_track("tpbj_subfunction_click",{func:t,open:1,click_type:1,record_id:r}),window._stat_track("tpbj_subfunction_tick",{func:t,record_id:r})}),[r]);return Object(h.jsxs)("div",{className:"p-intelligent-color",children:[Object(h.jsx)("div",{className:"p-intelligent-color__title",children:"\u81ea\u52a8\u6362\u8272"}),Object(h.jsx)("div",{className:"p-intelligent-color__tab",children:Object(h.jsx)(s.u,{data:D,tabsWidth:"228px",tabsHeight:"26px",showContent:!1,handleTabClick:function(e){n(e),window._stat_track("quick_color_change_click",{func:"free_change",area_type:"button"})}})}),Object(h.jsx)(y.a,{style:{height:"calc(100vh - 200px)"},children:t===U.RECOMMEND?Object(h.jsx)(x,{onTrack:e}):Object(h.jsx)(g,{onTrack:e})}),Object(h.jsx)(N,{onTrack:e})]})})),a=Object(c.lazy)((function(){return n.e(22).then(n.bind(null,1292))})),Object(c.lazy)((function(){return Promise.all([n.e(1),n.e(28),n.e(25)]).then(n.bind(null,1305))}))),G=Object(c.lazy)((function(){return n.e(24).then(n.bind(null,1293))})),z=Object(c.lazy)((function(){return Promise.all([n.e(2),n.e(27),n.e(14)]).then(n.bind(null,1301))})),B=Object(c.lazy)((function(){return n.e(13).then(n.bind(null,1307))})),H=Object(c.lazy)((function(){return n.e(16).then(n.bind(null,1294))})),V=Object(c.lazy)((function(){return n.e(6).then(n.bind(null,1295))})),J=Object(c.lazy)((function(){return Promise.all([n.e(1),n.e(3)]).then(n.bind(null,1296))})),Y=(r={},Object(t.a)(r,i.a.SVG_LAYER,Object(h.jsx)(c.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(a,{})})),Object(t.a)(r,i.a.TEXT_LAYER,Object(h.jsx)(c.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(F,{})})),Object(t.a)(r,i.a.TEXT_MATERIAL_LAYER,Object(h.jsx)(c.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(G,{})})),Object(t.a)(r,i.a.IMAGE_LAYER,Object(h.jsx)(c.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(z,{})})),Object(t.a)(r,i.a.GROUP_LAYER,Object(h.jsx)(c.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(B,{})})),Object(t.a)(r,i.a.MAIN_LAYER,Object(h.jsx)(c.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(H,{})})),Object(t.a)(r,i.a.BACKGROUND_LAYER,Object(h.jsx)(c.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(V,{})})),Object(t.a)(r,o.a.ADJUST_INTELLIGENT,Object(h.jsx)(b,{})),Object(t.a)(r,i.a.WATERMARK,Object(h.jsx)(c.Suspense,{fallback:Object(h.jsx)(h.Fragment,{}),children:Object(h.jsx)(J,{})})),r)},257:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));t=n(12);var r=n(23),c=function(e){return e.HANDLE="handle",e.AUTO="auto",e.DOWNLOAD="download",e}({}),a={isSaving:!1,isAutoSaving:!1,saveType:"",saveTooltipText:"",setIsSaving:Object(t.b)((function(e,t){e.isSaving=t})),setSaveType:Object(t.b)((function(e,t){e.saveType=t})),setIsAutoSaving:Object(t.b)((function(e,t){e.isAutoSaving=t})),changeSaveTooltipText:Object(t.b)((function(e){e.saveTooltipText="".concat(Object(r.k)()," \u5df2\u4fdd\u5b58")})),resetSaveTooltipText:Object(t.b)((function(e){e.saveTooltipText=""}))}},28:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return a}));var r=function(e){return e.ADJUST_MENU="adjust_menu",e.FILTER_MENU="filter_menu",e.PENT_MENU="pen_menu",e.TEXT_MENU="text_menu",e.MATERIAL_MENU="material_menu",e.MINE_MENU="mine_menu",e.BACKGROUND_MENU="background_menu",e.WATERMARK_MENU="watermark_menu",e}({}),c=function(e){return e.POSTERIZE="posterize",e.HSL="hsl",e.ELIMINATE="eliminate",e.AI_ELIMINATE="ai_eliminate",e.SHAPE="shape",e.SIZE_CHANGE="size_change",e.INTELLIGENT="intelligent",e.CUSTOM_AD="custom_ad",e}({}),a=function(e){return e.ADJUST_SIZE_CHANGE="adjust_size",e.ADJUST_ELIMINATE="adjust_eliminate_pen",e.ADJUST_AI_ELIMINATE="adjust_ai_eliminate_pen",e.ADJUST_LIGHT="adjust_light",e.ADJUST_PARTICULARS="adjust_particulars",e.ADJUST_COLOR="adjust_color",e.ADJUST_INTELLIGENT="adjust_intelligent",e.ADJUST_HSL="adjust_hsl",e.ADJUST_POSTERIZE="adjust_posterize",e.PEN_SHAPE="pen_shape",e.PEN_ELIMINATE="pen_eliminate",e.PEN_AI_ELIMINATE="pen_ai_eliminate",e}({})},282:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c}));t=n(12);var r=function(e){return e.RECORD="record",e.MATERIAL="material",e}({}),c={dragInfo:{},currrentMineTab:r.MATERIAL,setCurrrentMineTab:Object(t.b)((function(e,t){e.currrentMineTab=t})),setDragInfo:Object(t.b)((function(e,t){e.dragInfo=t}))}},286:function(e,t,n){"use strict";n.d(t,"d",(function(){return r.e})),n.d(t,"c",(function(){return r.c})),n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n(5),n(4),n(11),n(44),n(112),n(175);var r=n(331);n(387)},319:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="INTELLIGENT_HSL_CARD_EVENTe"},331:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b})),n(8);var r=n(4),c=n(11),a=n(56),i=n(44),o=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)("".concat(Object(a.f)(),"/user/info"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)("".concat(Object(a.b)(),"/user/logout"),{method:"GET",params:t,hideErrorToast:!0});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)("".concat(Object(a.a)(),"/api/v1/user/record_save_preview"),{method:"POST",data:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)("".concat(Object(a.e)(),"/im_v2/unread_count.json"),{method:"GET",data:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)("".concat(Object(a.g)(),"/popover/promotion"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.a)("".concat(Object(a.g)(),"/common/get_pc_download_url"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},348:function(e,t,n){"use strict";t.a={OK:0,UNAUTHORIZED:[1e3,1001,1002],UNAUTHORIZED_USER:[401]}},350:function(e,t,n){"use strict";function r(e){var t=e.type;return new File([e],"\u81ea\u5b9a\u4e49\u56fe\u7247",{type:t})}n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return d}));var c=n(4),a=n(11),i=(n(629),n(55)),o=n(13),u=(RegExp(/data:image\/.*;base64,/),function(e){return new Promise((function(t,n){var r=new Image;r.crossOrigin="",r.onload=function(){var e=s(r);t({base64:e})},r.src=e}))}),s=function(e){var t=document.createElement("canvas"),n=(t.width=e.width,t.height=e.height,t.getContext("2d"));return null!=n&&n.drawImage(e,0,0,e.width,e.height),t.toDataURL("image/png")},l=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(a.a)(Object(c.a)().mark((function e(u,s){var l,d,b,p,f,j,O,m,h,g;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,l=t.name.split(".")[0],"image/heic"===t.type)return e.next=5,n.e(26).then(n.t.bind(null,689,7));e.next=12;break;case 5:return d=e.sent.default,e.next=8,d({blob:t,toType:"image/jpg",quality:1});case 8:return d=e.sent,e.next=11,r(d);case 11:t=e.sent;case 12:b=t.size,i.f,e.next=16;var _=t;return new Promise((function(e,t){var n=new FileReader;n.onload=function(){e(n.result)},n.readAsDataURL(_)}));case 16:p=e.sent,e.next=19;var v=p;return new Promise((function(e,t){var n=new Image;n.setAttribute("crossOrigin","anonymous"),n.src=v,n.onload=function(){e({width:n.width,height:n.height})},n.onerror=function(){t(!1)}}));case 19:if(h=e.sent,f=h.width,j=h.height,(h=(m=j)<(O=f)?f:j)>i.g||b>i.f)return g=i.e,b<i.f&&h>i.g&&(g=2*i.e),o.j.confirm({title:"\u6e29\u99a8\u63d0\u793a",content:"\u5f53\u524d\u56fe\u7247\u8fc7\u5927\uff0c\u5904\u7406\u65f6\u6613\u53d1\u751f\u95ee\u9898\uff0c\u662f\u5426\u8c03\u6574\u56fe\u7247\u5927\u5c0f\u540e\u6253\u5f00\uff1f",okText:"\u662f",cancelText:"\u5426\uff0c\u6253\u5f00\u5176\u4ed6\u56fe\u7247",centered:!0,closable:!0,onOk:function(){var e=Object(a.a)(Object(c.a)().mark((function e(){var t,n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j<f?(j/=f/g,f=g):(f/=j/g,j=g),e.next=3;var r=p;return new Promise((function(e,t){var n=new Image;n.onload=function(){e(n)},n.src=r}));case 3:return t=e.sent,e.next=6,c=t,a=O,i=m,o=f,s=j,h=d=void 0,h=(d=document.createElement("canvas")).getContext("2d"),d.width=o,d.height=s,null!=h&&h.drawImage(c,0,0,a,i,0,0,o,s),d;case 6:t=e.sent,n=t.toDataURL("image/png"),u({base64:n,name:l,originalSize:"\u5c3a\u5bf8:".concat(O,"*").concat(m," \u5927\u5c0f:").concat((+b/1024/1024).toFixed(2),"MB")});case 9:case"end":return e.stop()}var c,a,i,o,s,d,h}),e)})));return function(){return e.apply(this,arguments)}}(),onCancel:function(e){s(e)}}),e.abrupt("return");e.next=30;break;case 30:u({base64:p,name:l,originalSize:"\u5c3a\u5bf8:".concat(O,"*").concat(m," \u5927\u5c0f:").concat((+b/1024/1024).toFixed(2),"MB")}),e.next=36;break;case 33:e.prev=33,e.t0=e.catch(0),s("openError");case 36:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(e){return"".concat(e,"?x-image-process=image/auto-orient,1")}},371:function(e,t,n){var r={"./dark/saturation-bg.jpg":965,"./dark/saturation.jpg":966,"./dark/temperature-bg.jpg":967,"./dark/temperature.jpg":968,"./dark/tinge-bg.jpg":969,"./dark/tinge.jpg":970,"./light/saturation-bg.jpg":971,"./light/saturation.jpg":972,"./light/temperature-bg.jpg":973,"./light/temperature.jpg":974,"./light/tinge-bg.jpg":975,"./light/tinge.jpg":976};function c(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}c.keys=function(){return Object.keys(r)},c.resolve=a,(e.exports=c).id=371},372:function(e,t,n){var r={"./dark/com-bg.jpg":978,"./dark/com.jpg":979,"./dark/contrast-bg.jpg":980,"./dark/contrast.jpg":981,"./dark/fade-bg.jpg":982,"./dark/fade.jpg":983,"./dark/highlight-bg.png":984,"./dark/highlight.jpg":985,"./dark/shadow-bg.png":986,"./dark/shadow.jpg":987,"./light/com-bg.jpg":988,"./light/com.jpg":989,"./light/contrast-bg.jpg":990,"./light/contrast.jpg":991,"./light/fade-bg.jpg":992,"./light/fade.jpg":993,"./light/highlight-bg.png":994,"./light/highlight.jpg":995,"./light/shadow-bg.png":996,"./light/shadow.jpg":997};function c(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}c.keys=function(){return Object.keys(r)},c.resolve=a,(e.exports=c).id=372},373:function(e,t,n){var r={"./dark/dispersion-bg.jpg":998,"./dark/dispersion.jpg":999,"./dark/particle-bg.jpg":1e3,"./dark/particle.jpg":1001,"./dark/sharpen-bg.jpg":1002,"./dark/sharpen.jpg":1003,"./dark/structure-bg.jpg":1004,"./dark/structure.jpg":1005,"./dark/vignette-bg.jpg":1006,"./dark/vignette.jpg":1007,"./light/dispersion-bg.jpg":1008,"./light/dispersion.jpg":1009,"./light/particle-bg.jpg":1010,"./light/particle.jpg":1011,"./light/sharpen-bg.jpg":1012,"./light/sharpen.jpg":1013,"./light/structure-bg.jpg":1014,"./light/structure.jpg":1015,"./light/vignette-bg.jpg":1016,"./light/vignette.jpg":1017};function c(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}c.keys=function(){return Object.keys(r)},c.resolve=a,(e.exports=c).id=373},386:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));var r=n(18),c=function(){return{currrentMineTab:Object(r.c)((function(e){return e.editor.mineCollapseModel.currrentMineTab}))}},a=function(){return Object(r.b)((function(e){return e.editor.mineCollapseModel.setCurrrentMineTab}))}},387:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n(5);var r=n(4),c=n(11),a=n(44),i=(n(112),n(1188),n(56)),o=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(a.a)("".concat(Object(i.a)(),"/api/v1/material/font/list_with_category"),{method:"GET",params:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},423:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(4),c=n(11),a=(n(220),n(34));function i(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,{canvas:n,width:e,height:t,ctx:n.getContext("2d")}}n(2);var o=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,a.a.getLocalUrlAsync(t);case 3:return n=e.sent,e.abrupt("return",new Promise((function(e){var t=new Image;t.setAttribute("crossOrigin","anonymous"),t.onload=function(){e(t)},t.src=n})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(e){return o(e).then((function(e){return{width:e.width,height:e.height,img:e}}))},s=function(e,t,n){return new Promise((function(r,c){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.src=e,a.width=t,a.height=n,a.onload=function(){r(a)}}))}},43:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"n",(function(){return o})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"o",(function(){return d})),n.d(t,"m",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"k",(function(){return f})),n.d(t,"d",(function(){return j})),n.d(t,"l",(function(){return O})),n.d(t,"g",(function(){return m})),n.d(t,"f",(function(){return h}));var r=n(18),c=function(){return{width:Object(r.c)((function(e){return e.templateModel.editorWidth})),height:Object(r.c)((function(e){return e.templateModel.editorHeight}))}},a=function(){return Object(r.c)((function(e){return e.templateModel.id}))},i=function(){return Object(r.b)((function(e){return e.templateModel.setStageSize}))},o=function(){return Object(r.c)((function(e){return e.templateModel.templateName}))},u=function(){return Object(r.c)((function(e){return e.editor.recordModel.recordInfo}))},s=function(){return Object(r.c)((function(e){return e.editor.searchModel.is_search}))},l=function(){return Object(r.c)((function(e){return e.editor.searchModel}))},d=function(){return Object(r.c)((function(e){return e.stageModel.triggerCreate}))},b=function(){return Object(r.b)((function(e){return e.stageModel.openCreateDialog}))},p=function(){return Object(r.c)((function(e){return e.stageModel.fileName}))},f=function(){return Object(r.b)((function(e){return e.stageModel.updateFileName}))},j=function(){return Object(r.c)((function(e){return e.stageModel.isCropStage}))},O=function(){return Object(r.b)((function(e){return e.stageModel.setIsCropStage}))},m=function(){return Object(r.c)((function(e){return e.stageModel.naturalImage}))},h=function(){return Object(r.c)((function(e){return e.stageModel.naturalFileSuffix}))}},496:function(e,t,n){"use strict";n.d(t,"b",(function(){return j}));var r=n(4),c=n(11),a=n(178),i=n(177),o=n(23),u=n(151),s=n(139),l=n(124),d=n(10),b=n(19),p=n(45),f=n(55),j=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var n,c,a,u,s,p;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,c=t.id,p=t.name,a=t.source,s=t.blobUrl,e.prev=1,b.a.emit(d.a.materialAdd+a,{type:"pending",blobUrl:s,id:c,name:p}),e.next=5,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3;return new Promise((function(t,n){setTimeout(t,e)}))}(100);case 5:return e.next=7,Object(o.l)(n);case 7:if(0===(u=e.sent).width||0===u.height)return e.abrupt("return");e.next=10;break;case 10:return e.next=12,Object(i.g)({url:n,width:u.width.toString()||"",height:u.height.toString()||"",module:"1",source:a});case 12:s=e.sent,p=s.data.data.id,b.a.emit(d.a.materialAdd+a,{type:"success",url:n,id:c,_id:p.toString(),width:u.width,height:u.height}),l.a.success("\u6dfb\u52a0\u6210\u529f"),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),b.a.emit(d.a.materialAdd+a,{type:"fail",file:t,id:c});case 21:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t){return e.apply(this,arguments)}}();t.a=function(){var e,t=Object(p.d)();return{filesUpload:(e=Object(c.a)(Object(r.a)().mark((function e(i,d){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(c.a)(Object(r.a)().mark((function e(b,p){var j,O,m;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j=[],t.show(),O=Object(r.a)().mark((function e(){var O,h,g,_,v,w,x,y;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(O=i[m]).size>f.f&&(l.a.warning("\u56fe\u7247\u6700\u5927\u53ea\u652f\u630120M"),t.hide(),p()),g=(null==(g=O)||null==(g=g.name)?void 0:g.lastIndexOf("."))||0,h=Object(s.a)(),g=(null==(v=O)||null==(v=v.name)||null==(v=v.substring(g))?void 0:v.toLowerCase())||"",_=O&&window.URL.createObjectURL(O)||"",e.next=8,Object(o.l)(_);case 8:if(v=e.sent,w=v.width,x=v.height,O&&(a.b.includes(O.type)||a.b.includes(g))){if("image/heic"===O.type)return e.prev=13,e.next=16,n.e(26).then(n.t.bind(null,689,7));e.next=28}else e.next=31;break;case 16:return y=e.sent.default,e.next=19,y({blob:O,toType:"image/jpg",quality:1});case 19:return y=e.sent,e.next=22,Object(o.d)(y);case 22:O=e.sent,e.next=28;break;case 25:e.prev=25,e.t0=e.catch(13),l.a.error("HEIC\u56fe\u7247\u89e3\u6790\u5931\u8d25\uff0c\u5efa\u8bae\u60a8\u8f6c\u6362\u4e3a\u5176\u4ed6\u56fe\u7247\u683c\u5f0f\u4e0a\u4f20");case 28:Object(u.d)(O).then(function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.url,j.push({url:n,id:h,name:(null==(n=O)?void 0:n.name)||"",source:d,width:w,height:x,blobUrl:_}),j.length===i.length&&b(j);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){j.push({url:"",id:"",name:"",source:"",width:0,height:0,blobUrl:""}),j.length===i.length&&b(j)})),e.next=32;break;case 31:O&&(p(),l.a.warning("\u6682\u65f6\u53ea\u652f\u6301JPG/JPEG/PNG/HEIC\u683c\u5f0f\u56fe\u7247"));case 32:case"end":return e.stop()}}),e,null,[[13,25]])})),m=0;case 4:if(m<i.length)return e.delegateYield(O(),"t0",6);e.next=9;break;case 6:m++,e.next=4;break;case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)}))),function(t,n){return e.apply(this,arguments)})}}},497:function(e,t,n){"use strict";var r=n(3),c=n(5),a=n(0),i=(a=n.n(a),n(23)),o=n(10),u=n(172),s=n(155),l=n(123),d=n(41),b=n(213),p=n(209),f=n(233),j=n(635),O=n(179),m=n(22),h=n(42),g=n(43),_=n(1),v=(h.g.setIgnoreTypes([i.a.GROUP_LAYER,i.a.BACKGROUND_LAYER]),n={},Object(r.a)(n,i.a.IMAGE_LAYER,(function(e,t){return Object(_.jsx)(l.b,Object(c.a)({layer:e},t))})),Object(r.a)(n,i.a.GROUP_LAYER,(function(e,t){return Object(_.jsx)(s.b,Object(c.a)({layer:e},t))})),Object(r.a)(n,i.a.BACKGROUND_LAYER,(function(e,t){return Object(_.jsx)(u.b,Object(c.a)({layer:e},t))})),Object(r.a)(n,i.a.TEXT_LAYER,(function(e,t){return Object(_.jsx)(p.d,Object(c.a)({layer:e},t))})),Object(r.a)(n,i.a.TEXT_MATERIAL_LAYER,(function(e,t){return Object(_.jsx)(f.b,Object(c.a)({layer:e},t))})),Object(r.a)(n,i.a.SVG_LAYER,(function(e,t){return Object(_.jsx)(b.n,Object(c.a)({layer:e},t))})),Object(r.a)(n,i.a.MAIN_LAYER,(function(e,t){return Object(_.jsx)(d.m,Object(c.a)({layer:e},t))})),Object(r.a)(n,i.a.WATERMARK,(function(e,t){return Object(_.jsx)(j.a,Object(c.a)({layer:e},t))})),n);Object(o.e)((h={},Object(r.a)(h,i.a.GROUP_LAYER,s.a),Object(r.a)(h,i.a.IMAGE_LAYER,l.a),Object(r.a)(h,i.a.TEXT_LAYER,p.a),Object(r.a)(h,i.a.TEXT_MATERIAL_LAYER,f.a),Object(r.a)(h,i.a.SVG_LAYER,b.a),Object(r.a)(h,i.a.MAIN_LAYER,d.a),Object(r.a)(h,i.a.BACKGROUND_LAYER,u.c),Object(r.a)(h,i.a.WATERMARK,O.a),h)),t.a=a.a.memo((function(e){var t=e.isNavigator,n=(e=Object(o.F)(),Object(m.n)()),r=Object(g.b)(),c=Object(m.f)(),a=Object(o.f)().getActiveInfo,i=Object(g.d)();return Object(_.jsx)(_.Fragment,{children:e.map((function(e){var o={isNavigator:t,isLinkOperate:!!n,stageWidth:r.width,stageHeight:r.height,overflowStageHidden:!i,isCropImage:c&&(null==(o=a())?void 0:o.id)===e.id};return v[e.layerType]?Object(_.jsx)("div",{className:"l-layer",children:v[e.layerType](e,o)},e.id):null}))})}))},513:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return a}));var r=function(e){return 0==="".concat(e).indexOf("adjust_")},c=function(e){return 0==="".concat(e).indexOf("pen_")},a=function(e){return 0==="".concat(e).indexOf("filter_")}},515:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(4),c=n(11),a=n(8),i=n(123),o=n(10),u=n(7),s=n(43),l=n(0),d=n(89),b=n(208),p=n(45),f=n(24),j=n(23),O={left:0,top:0},m=0,h=function(){var e=Object(i.e)().addImageLayer,t=Object(o.p)(),n=Object(p.d)(),h=(w=Object(s.b)()).width,g=w.height,_=(0,Object(d.b)().showUserInfo)(),v=Object(f.b)(),w=Object(l.useState)(0),x=(w=Object(a.a)(w,2))[0],y=w[1],k=t.getRenderLayers();return Object(l.useEffect)((function(){var e=k.length;e<x&&(O={left:0,top:0},m=0),y(e)}),[k]),Object(l.useEffect)((function(){v||(O={left:0,top:0},m=0)}),[v]),{addImgToLayers:function(t,a){return Object(c.a)(Object(r.a)().mark((function c(){var i,o,s,l,d,p,f,v,w,x,y,k,E;return Object(r.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.prev=0,n.show(),i=h,o=g,l=t.thumbnail,s=t.id,w=t.width,v=t.height,f=p=0,w&&v?(p=w,f=v,r.next=20):r.next=13;break;case 13:return r.next=15,Object(u.P)(l);case 15:if(d=r.sent){r.next=18;break}return r.abrupt("return");case 18:p=d.width,f=d.height;case 20:w=f,1.5*h<(v=p)&&(l=Object(j.q)(l,1.5*h,100),w=(v=1.5*h)/p*f),x={top:0,left:0},k=y=0,p/f<i/o?y=p/(f/(k=o/2)):k=f/(p/(y=i/2)),E=m,a?(x.left=a.x-y/2,x.top=a.y-k/2):O.left&&O.top?(x.top=O.top+5*E,x.left=O.left+5*E,E=g,(h<x.left+y||E<x.top+k)&&(O.top=1,O.left=1)):(O.top=(o-k)/2,O.left=(i-y)/2,x.top=O.top,x.left=O.left),e(l,y,k,x.left,x.top,null==s?void 0:s.toString(),v,w),s&&_&&Object(b.m)({code:"pic_static_sticker"},{material_id:+s,code:"pic_static_sticker",module:1}),a||(m+=1),r.next=37;break;case 34:r.prev=34,r.t0=r.catch(0),n.hide();case 37:return r.prev=37,n.hide(),r.finish(37);case 40:case"end":return r.stop()}}),c,null,[[0,34,37,40]])})))()}}}},517:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a}));var r=n(23),c=function(e){var t=0,n=1;if(e&&e.children&&e.children.length){for(var c=Object(r.m)([e]),a=(e=c.filter((function(e){return e.layerType!==r.a.GROUP_LAYER})).length,0),i=0,o=!1,u=0;u<c.length;u++){var s=c[u].layerType;if(o)break;switch(s){case r.a.TEXT_LAYER:a=1;break;case r.a.IMAGE_LAYER:i=2;break;case r.a.GROUP_LAYER:o=!0}}t=o?4:a+i,n=e}return{layerType:t,layerNum:n}},a=function(e){var t=e.firstId,n=e.secondId,r=e.isClick,c=e.isUse;e={record_id:e.recordId,layer_num:1,layer_type:e.layerType,func_id:"".concat(t,"_").concat(n)};r&&window._stat_track("hb_layers_func_click",e),c&&window._stat_track("hb_layers_func_use",e)}},521:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));t=n(3),n=n(28);var r,c=(r={},Object(t.a)(r,n.a.ADJUST_ELIMINATE,{id:10,func:41,reset:7,penSize:6}),Object(t.a)(r,n.a.ADJUST_AI_ELIMINATE,{id:10,func:48,reset:7,penSize:6,daub:104,rect:105,path:106}),Object(t.a)(r,n.a.ADJUST_LIGHT,{id:10,func:42,smartLightLevel:8,brightness:9,contrast:10,highlight:11,shadow:12,fade:13,reset:7}),Object(t.a)(r,n.a.ADJUST_PARTICULARS,{id:10,func:43,sharpen:14,structure:15,particle:17,dispersion:18,vignette:16,reset:7}),Object(t.a)(r,n.a.ADJUST_COLOR,{id:10,func:44,saturation:19,temperature:20,tinge:21,reset:7}),Object(t.a)(r,n.a.ADJUST_POSTERIZE,{id:10,func:45,select:23,tab_light:21,tab_shadow:22,posterize_light:24,reset:7}),Object(t.a)(r,n.a.ADJUST_HSL,{id:10,func:46,select:23,hsl_hue:25,hsl_saturation:19,hsl_light:26,reset:7}),Object(t.a)(r,n.a.ADJUST_INTELLIGENT,{id:10,func:47,protect:52,color:23,pen:56,pen_size:6,recommend:53,pick:54,hsl_hue:25,hsl_saturation:19,hsl_light:26,high:55}),r)},522:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(0),c=n(43),a=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",n=e.id,r=e.func;n="".concat(n,"_").concat(r);return t&&(r=e[t])?"".concat(n,"_").concat(r):n},i=function(e){var t=Object(c.h)().id,n=Object(r.useCallback)((function(n,r){n=e[n],n=a(n),window._stat_track("tpbj_subfunction_click",{func:n,open:+r,click_type:0,record_id:t})}),[t]),i=Object(r.useCallback)((function(n,r){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,i=3<arguments.length&&void 0!==arguments[3]&&arguments[3];n=e[n],n=a(n,r);window._stat_track("tpbj_subfunction_click",{func:n,open:1,click_type:c,record_id:t}),i||window._stat_track("tpbj_subfunction_tick",{func:n,record_id:t})}),[t]),o=Object(r.useCallback)((function(n){n=e[n],n=a(n,"reset"),window._stat_track("tpbj_subfunction_click",{func:n,open:1,click_type:1,record_id:t}),window._stat_track("tpbj_subfunction_tick",{func:n,record_id:t})}),[t]),u=Object(r.useCallback)((function(n,r,c){n=e[n],n=a(n,r),window._stat_track("tpbj_subfunction_click",{func:n,open:1,click_type:c,record_id:t}),c&&window._stat_track("tpbj_subfunction_tick",{func:n,record_id:t})}),[t]),s=Object(r.useCallback)((function(n,r,c){n=e[n],n=a(n,"select"),window._stat_track("tpbj_subfunction_click",{func:n,open:1,click_type:1,record_id:t})}),[t]),l=Object(r.useCallback)((function(n,r){n=e[n],n=a(n,"tab_".concat(r)),window._stat_track("tpbj_subfunction_click",{func:n,open:1,click_type:1,record_id:t})}),[t]);return{getTrackFunc:a,onToggleHandle:n,onSliderHandle:i,onResetHandle:o,onAttrChangeHandle:u,onSelectHandle:s,onTabHandle:l}}},528:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(56),c=n(44);function a(e,t){return e={media_info_list:[{media_data:e,media_extra:{},media_profiles:{media_data_type:"url"}},{media_data:t,media_extra:{},media_profiles:{media_data_type:"url"}}],parameter:{rsp_media_type:"url",model_type:"lama",use_sod:!1,userboxes:"",use_box_mask:!1}},Object(c.a)("".concat(Object(r.f)(),"/v1/mtlab/znxc"),{method:"POST",data:e,params:{source:"editor"},headers:{"Content-Type":"application/json"}}).then((function(e){var t=(e=e.data).code,n=e.message;e=e.data;if(0===t&&e)return t=e.media_info_list[0].media_data,"jpg"===e.parameter.rsp_media_type?"data:image/png;base64,".concat(t):t;throw new Error("imageAieraser:"+n)}))}},53:function(e,t,n){"use strict";n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return b})),n.d(t,"f",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return O}));var r=n(4),c=n(11),a=n(16),i=(n(90),n(63),n(18)),o=(n(23),n(142)),u=n(55),s=(t=n(621),n.n(t)),l=n(104),d=function(){return Object({NODE_ENV:"production",PUBLIC_URL:"https://pc.meitudata.com/image-editor",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_STAT_ENV:"release",REACT_APP_ENV:"release",REACT_APP_PREVIEW_MODE:"0",REACT_APP_APP_KEY:"43815DC54A66BEE8",REACT_APP_TITLE:"\u7f8e\u56fe\u79c0\u79c0-\u56fe\u7247\u7f16\u8f91",REACT_APP_USER_API_POLICY:"/image/editor/",REACT_APP_USER_API_POLICY_LOCAL:"/",REACT_APP_USER_API_MAAT:"/image/editor/",REACT_APP_USER_API_MAAT_LOCAL:"/",REACT_APP_USER_API_ORIGIN_LOCAL:"/user/api",REACT_APP_CLIENT_ID:"1189857435",REACT_APP_USER_API_OFFICE:"/user/office",REACT_APP_USER_API_OFFICE_LOCAL:"/user/office",REACT_APP_LANGUAGE:"zh-Hans",REACT_APP_RELEASE:"version_202311081138"}).REACT_APP_LOCAL},b=function(){var e=(t=i.a.getState().editor.watermarkModel.materialList).filter((function(e){return"fonts"===e.typeName})).map((function(e){return"material_1001_".concat(e.name)})),t=t.filter((function(e){return"pic_static_sticker"===e.typeName})).map((function(e){if(e=e.id)return"material_1000_".concat(e)}));return[].concat(Object(a.a)(e),Object(a.a)(t))},p=function(){return-1<navigator.userAgent.toLowerCase().indexOf("usesafari")},f=function(){var e,t=window.navigator.userAgent.toLowerCase();return/(macintosh)|(mac os x)/.test(t)?"mac":/(window)/.test(e=t)&&/(win32)|(wow32)/.test(e)?"win32":/(window)/.test(e=t)&&/(win64)|(wow64)/.test(e)?"win64":/linux/.test(t)?"linux":""},j=function(){var e=Object(c.a)(Object(r.a)().mark((function e(){var t,n;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(t=new s.a).getBrowser(),e.next=4,Object(l.a)();case 4:return n=e.sent,e.abrupt("return","".concat("https://fankui.meitu.com/pc/","?client_id=").concat(u.a,"&appName=\u7f8e\u56fe\u79c0\u79c0&access_token=").concat(Object(o.a)(),"&version=").concat(t.version||"","&model=").concat(t.name||"","&os=").concat(f()||"","&gid=").concat(n,"&track_from=\u56fe\u7247\u7f16\u8f91"));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=f(),t={channel:window.sessionStorage.getItem("channel")||Object(o.b)()||"",bit:"64",suffix:"exe"};return"mac"===e?(t.bit="",t.suffix="dmg"):"win32"===e&&(t.bit="32",t.suffix="exe"),t}},55:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return d}));var r="1189857435",c="zh-Hans",a=(Object({NODE_ENV:"production",PUBLIC_URL:"https://pc.meitudata.com/image-editor",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!1,REACT_APP_STAT_ENV:"release",REACT_APP_ENV:"release",REACT_APP_PREVIEW_MODE:"0",REACT_APP_APP_KEY:"43815DC54A66BEE8",REACT_APP_TITLE:"\u7f8e\u56fe\u79c0\u79c0-\u56fe\u7247\u7f16\u8f91",REACT_APP_USER_API_POLICY:"/image/editor/",REACT_APP_USER_API_POLICY_LOCAL:"/",REACT_APP_USER_API_MAAT:"/image/editor/",REACT_APP_USER_API_MAAT_LOCAL:"/",REACT_APP_USER_API_ORIGIN_LOCAL:"/user/api",REACT_APP_CLIENT_ID:"1189857435",REACT_APP_USER_API_OFFICE:"/user/office",REACT_APP_USER_API_OFFICE_LOCAL:"/user/office",REACT_APP_LANGUAGE:"zh-Hans",REACT_APP_RELEASE:"version_202311081138"}).REACT_APP_CLIENT_ID_USER,8e3),i=20971520,o=4e3,u=[{url:"https://xiuxiupro-material-center.meitudata.com/poster/a5b124caae6c1f35be58ba7ba651725a.jpg",name:"\u7f8e\u56fe\u79c0\u79c0 \u6837\u72471"},{url:"https://xiuxiupro-material-center.meitudata.com/poster/9db01920b813f18321274bc13da283db.jpg",name:"\u7f8e\u56fe\u79c0\u79c0 \u6837\u72472"},{url:"https://xiuxiupro-material-center.meitudata.com/poster/325cb902e32aa5b426c765cc53ffbac8.jpeg",name:"\u7f8e\u56fe\u79c0\u79c0 \u6837\u72473"}],s="history-material",l={"1.0.0":"1.0.0","2.0.0":"2.0.0"},d="2.0.0"},56:function(e,t,n){"use strict";function r(e){return e[Object(f.d)()?"release":Object(f.b)()?"beta":"pre"]}n.d(t,"f",(function(){return j})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return _})),n.d(t,"g",(function(){return v}));var c=n(4),a=n(11),i=(t=n(44),n(122)),o=n(53),u=(n(63),n(142)),s=n(55),l=n(622),d=n.n(l),b=n(64),p=n(104),f=n(148),j=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"pre",t={pre:"https://prewebapi-pc.meitu.com",beta:"https://betawebapi-pc.meitu.com",release:"https://webapi-pc.meitu.com"};return Object(o.e)()?t[e]:r(t)},O=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return Object(o.e)()?e:r({pre:"https://preapi-xiuxiupro.meitu.com",beta:"https://betaapi-xiuxiupro.meitu.com",release:"https://api-xiuxiupro.meitu.com"})},m=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return Object(o.e)()?e:r({pre:"https://prestrategy.meitubase.com/upload/policy",beta:"https://strategy.app.meitudata.com/upload/policy",release:"https://strategy.app.meitudata.com/upload/policy"})},h=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return Object(o.e)()?e:r({pre:"https://prepc.meitu.com",beta:"https://beta-pc.meitu.com",release:"https://pc.meitu.com"})},g=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return Object(o.e)()?e:r({pre:"https://preapi.posters.meitu.com",beta:"https://betaapi.posters.meitu.com",release:"https://api.posters.meitu.com"})},_=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return Object(o.e)()?e:r({pre:"https://preapi-feedback.meitu.com",beta:"https://betaapi-feedback.meitu.com",release:"https://api-feedback.meitu.com"})},v=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return Object(o.e)()?e:r({pre:"https://prewebapi-pc.meitu.com",beta:"https://betawebapi-pc.meitu.com",release:"https://webapi-pc.meitu.com"})},w=null,x=(l=Object(f.a)(),{client_id:Object(u.b)(),language:s.b,gid:""});Object(t.b)({baseURL:l,withCredentials:!0,config:{adaptor:function(e){var t;return{error_code:null==e||null==(t=e.data)?void 0:t.error_code,msg:null==e||null==(t=e.data)?void 0:t.msg,data:null==e||null==(t=e.data)?void 0:t.data}},successCode:0,unauthorizedCodes:[401],errorHandler:function(e){i.a(e)},loginHandler:function(){return new Promise(function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){var n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w)return e.next=3,w;e.next=6;break;case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,w=Object(b.e)();case 8:e.t0=e.sent;case 9:n=e.t0,w=null,t(n);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},requestInterceptors:[function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){var n,r;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,t.headers.access_token=Object(u.a)()||"",e.next=5,Object(p.a)();case 5:return x.gid=e.sent,t.params&&(t.params.gid=x.gid),"post"===t.method?t.headers["Content-Type"]?t.params=Object.assign({},x,{preview_mode:n},t.params):(r=Object.assign({},x,{preview_mode:n},t.data||{}),t.data=d.a.stringify(r),t.headers["Content-Type"]="application/x-www-form-urlencoded"):"get"===t.method&&(t.params=Object.assign({timestamp:(new Date).getTime()},{preview_mode:n},x,t.params||{})),["/user/checkLogin","/user/logout"].includes(t.url)&&(t.baseURL=Object(o.e)()?"/user/office":Object(f.a)()+"/user/office"),-1!==t.url.indexOf("/user/maat")&&(t.baseURL=Object(o.e)()?"/":"/image/editor/"),-1!==t.url.indexOf("/upload/policy")&&(t.headers["Access-Token"]=Object(u.a)()||"",t.headers["File-Key"]=(null==t||null==(r=t.params)?void 0:r.file)||"",t.params={app:t.params.app,type:t.params.type,count:t.params.count,sig:t.params.sig,sigTime:t.params.sigTime,suffix:t.params.suffix},delete t.params.file,t.baseURL=Object(o.e)()?"/":"/image/editor/"),e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()],responseInterceptors:[]})},581:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e.TYPE_TEMPLATE="template",e.TYPE_RECORD="record",e}({})},600:function(e,t,n){},64:function(e,t,n){"use strict";n.d(t,"a",(function(){return X})),n.d(t,"e",(function(){return $})),n.d(t,"c",(function(){return ee})),n.d(t,"f",(function(){return te})),n.d(t,"b",(function(){return ne})),n.d(t,"d",(function(){return re}));t={};var r=(n.r(t),n.d(t,"closeAccountLoginDialog",(function(){return y})),n.d(t,"closeVipSubscribeDialog",(function(){return k})),n.d(t,"msgBox",(function(){return E})),n.d(t,"setLocalStorage",(function(){return T})),n.d(t,"getLocalStorage",(function(){return S})),n.d(t,"getGid",(function(){return A})),n.d(t,"enableTitleBack",(function(){return L})),n.d(t,"openBrowser",(function(){return N})),n.d(t,"mtTrack",(function(){return M})),n.d(t,"isWebStartup",(function(){return R})),n.d(t,"switchToStartup",(function(){return P})),n.d(t,"switchToEditor",(function(){return U})),n.d(t,"logout",(function(){return D})),n.d(t,"relogin",(function(){return F})),n.d(t,"account",(function(){return G})),n.d(t,"getCountryCode",(function(){return z})),n.d(t,"buyProduct",(function(){return B})),n.d(t,"downloadSuccess",(function(){return V})),n.d(t,"loadWeb",(function(){return J})),n.d(t,"addUndo",(function(){return Y})),n(5)),c=n(4),a=n(11),i=(t=(n(623),n(624)),n.n(t)),o=n(122),u=(t=n(63),n.n(t)),s=(t=n(142),n(348)),l=n(331),d=n(18),b=n(104),p=n(53);function f(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Promise((function(t){window.qtObject?e.apply(void 0,n.concat([function(e){t(e)}])):t(e.apply(void 0,n))}))}function j(e){return JSON.stringify(e)}var O,m,h,g,_,v=function(){return window.webview||window.qtObject||window},w={qtObject:{closeAccountLoginDialog:function(){v().closeAccountLoginDialog&&v().closeAccountLoginDialog()},closeVipSubscribeDialog:function(){v().closeVipSubscribeDialog&&v().closeVipSubscribeDialog()},msgBox:function(e){v().js_msgBox?v().js_msgBox(e):window.alert(e)},setLocalStorage:function(e,t){v().setLocalStorage?v().setLocalStorage(e,t):window.localStorage.setItem(e,t)},getLocalStorage:(_=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v().getLocalStorage)return e.next=3,f(v().getLocalStorage,t);e.next=6;break;case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=window.localStorage.getItem(t);case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e)}))),function(e){return _.apply(this,arguments)}),getGid:(g=Object(a.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=v().getGid,e.t0)return e.next=4,f(v().getGid);e.next=5;break;case 4:e.t0=e.sent;case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)}))),function(){return g.apply(this,arguments)}),enableTitleBack:function(){v().enableTitleBack&&v().enableTitleBack()},openBrowser:function(e){return v().openBrowser?v().openBrowser(e):window.open(e)},isWebStartup:function(e){return v().isWebStartup&&v().isWebStartup(e)},loginStateChanged:function(e){e&&v().loginStateChanged&&v().loginStateChanged.connect(e)},getVersion:function(e){e&&v().getVersion&&v().getVersion(e)},relogin:function(e){v().relogin&&v().relogin(e)},account:function(){v().account&&v().account()},switchToStartup:function(){v().switchToStartup&&v().switchToStartup()},switchToEditor:function(){v().switchToEditor&&v().switchToEditor()},logout:function(){v().logout&&v().logout()},getCountryCode:function(){return v().getCountryCode&&v().getCountryCode()},buyProduct:function(e,t){v().buyProduct&&v().buyProduct(e,t)},downloadSuccess:function(e){v().downloadSuccess&&v().downloadSuccess(e)},loadWeb:function(e){v().loadWeb&&v().loadWeb(e)},addUndo:function(){v().addUndo&&v().addUndo()}},prompt:{closeAccountLoginDialog:function(){window.prompt("closeAccountLoginDialog")},closeVipSubscribeDialog:function(){window.prompt("closeVipSubscribeDialog")},msgBox:function(e){v().js_msgBox?v().js_msgBox(e):window.alert(e)},setLocalStorage:function(e,t){try{var n={ParamList:[e,t]};window.prompt("setLocalStorage",j(n))}catch(n){window.localStorage.setItem(e,t)}},getLocalStorage:(h=Object(a.a)(Object(c.a)().mark((function e(t){var n,r;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={ParamList:[t],Return:"string"};try{n=window.prompt("getLocalStorage",j(r))}catch(e){n=window.localStorage.getItem(t)}return e.abrupt("return",n);case 3:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)}),getGid:(m=Object(a.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={ParamList:[],Return:"string"},e.abrupt("return",window.prompt("getGid",j(t)));case 2:case"end":return e.stop()}}),e)}))),function(){return m.apply(this,arguments)}),enableTitleBack:function(){return window.prompt("enableTitleBack")},openBrowser:function(e){try{var t={ParamList:[e]};window.prompt("openBrowser",j(t))}catch(t){window.open(e)}},isWebStartup:function(e){return window.prompt("isWebStartup",j({ParamList:[e]}))},loginStateChanged:function(e){window.prompt("loginStateChanged"),e&&e()},getVersion:function(e){window.prompt("getVersion",j({ParamList:[],Return:"string"}))&&e&&e()},relogin:function(e){window.prompt("relogin",j({ParamList:[e]}))},account:function(){window.prompt("account")},switchToStartup:function(){window.prompt("switchToStartup")},switchToEditor:function(){window.prompt("switchToEditor")},logout:function(){window.prompt("logout")},getCountryCode:function(){return window.prompt("getCountryCode",j({ParamList:[],Return:"string"}))},buyProduct:(O=Object(a.a)(Object(c.a)().mark((function e(t,n){var r;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={ParamList:["".concat(JSON.stringify(t))],Return:"string"},e.next=3,window.prompt("buyProduct",j(r));case 3:r=e.sent,n&&n(r);case 5:case"end":return e.stop()}}),e)}))),function(e,t){return O.apply(this,arguments)}),downloadSuccess:function(e){e={ParamList:["".concat(JSON.stringify(e))]},window.prompt("downloadSuccess",j(e))},loadWeb:function(e){e={ParamList:["".concat(JSON.stringify(e))]},window.prompt("loadWeb",j(e))},addUndo:function(){window.prompt("addUndo")}}},x={qtObject:w.qtObject,prompt:w.prompt};function y(){(Object(p.f)()&&!v().closeAccountLoginDialog?x.prompt:x.qtObject).closeAccountLoginDialog()}function k(){(Object(p.f)()&&!v().closeVipSubscribeDialog?x.prompt:x.qtObject).closeVipSubscribeDialog()}function E(e){(Object(p.f)()&&!v().msgBox?x.prompt:x.qtObject).msgBox(e)}function T(e,t){(Object(p.f)()&&!v().setLocalStorage?x.prompt:x.qtObject).setLocalStorage(e,t)}function S(e){return I.apply(this,arguments)}function I(){return(I=Object(a.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(p.f)()&&!v().getLocalStorage)return e.abrupt("return",x.prompt.getLocalStorage(t));e.next=4;break;case 4:return e.abrupt("return",x.qtObject.getLocalStorage(t));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return C.apply(this,arguments)}function C(){return(C=Object(a.a)(Object(c.a)().mark((function e(){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(p.f)()&&!v().getGid)return e.abrupt("return",x.prompt.getGid());e.next=4;break;case 4:return e.abrupt("return",x.qtObject.getGid());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(Object(p.f)()&&!v().enableTitleBack?x.prompt:x.qtObject).enableTitleBack()}function N(e){return(Object(p.f)()&&!v().openBrowser?x.prompt:x.qtObject).openBrowser(e)}function M(e){v().mtTrack&&v().mtTrack(JSON.stringify(e))}function R(e){(Object(p.f)()&&!v().isWebStartup?x.prompt:x.qtObject).isWebStartup(e)}function P(){(Object(p.f)()&&!v().switchToStartup?x.prompt:x.qtObject).switchToStartup()}function U(){(Object(p.f)()&&!v().switchToEditor?x.prompt:x.qtObject).switchToEditor()}function D(){(Object(p.f)()&&!v().logout?x.prompt:x.qtObject).logout()}function F(e){(Object(p.f)()&&!v().relogin?x.prompt:x.qtObject).relogin(e)}function G(){(Object(p.f)()&&!v().account?x.prompt:x.qtObject).account()}function z(){return(Object(p.f)()&&!v().getCountryCode?x.prompt:x.qtObject).getCountryCode()}function B(e,t){return H.apply(this,arguments)}function H(){return(H=Object(a.a)(Object(c.a)().mark((function e(t,n){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(p.f)()&&!v().buyProduct)return e.next=3,x.prompt.buyProduct(t,n);e.next=5;break;case 3:e.next=7;break;case 5:return e.next=7,x.qtObject.buyProduct(t,n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){(Object(p.f)()&&!v().downloadSuccess?x.prompt:x.qtObject).downloadSuccess(e)}function J(e){(Object(p.f)()&&!v().loadWeb?x.prompt:x.qtObject).loadWeb(e)}function Y(){(Object(p.f)()&&!v().addUndo?x.prompt:x.qtObject).addUndo()}var W=n(204),q=Object(t.b)(),K=function(){},X=(w=Object(p.e)()?"callback.html":"image/edit/callback.html","".concat(window.location.protocol,"//").concat(window.location.host,"/").concat(w)),Z=u.a.parse(window.location.search),Q=function(){var e=Object(a.a)(Object(c.a)().mark((function e(t){var n,r,a,u;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Z.first_url||window.sessionStorage.getItem("first_url"),e.next=3,Object(b.a)();case 3:r=e.sent,a={enable_login_method:"0"},t===W.a.WECHAT&&(a.enable_login_method="wechat"),(u=new i.a({env:"release",clientId:q,customParams:{client_configs:encodeURIComponent(JSON.stringify(a)),dev:!1,gid:r,callback:X,scenes_enter:"tpbj",client_callback:encodeURIComponent(X),cur_url:window.location.href,channel:Z.channel||window.sessionStorage.getItem("channel")||q||"",first_url:n||document.referrer||window.location.href}})).on("success",(function(e){null!=e&&e.access_token&&(K(e.access_token),ne(),window.mtstat.login(e.user.id),o.b({id:e.user.id}),u.close())})).on("close",(function(){K(!1)})).on("fail",(function(e){})),window.ql=u;case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(a.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.ql){e.next=4;break}return t=W.a.WECHAT,e.next=4,Q(t);case 4:return null!=(t=window.ql)&&t.create(),e.next=7,new Promise((function(e){return K=e}));case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(a.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=u.a.parse(window.location.search)).pathname=window.location.pathname,t="".concat(window.location.protocol,"//").concat("","account.meitu.com/#!/logout?client_id=").concat(q,"&client_params=").concat(encodeURIComponent(JSON.stringify(t)),"&client_callback=").concat(X),window.localStorage.removeItem("access_token"),window.localStorage.removeItem("uid"),window.mtstat.logout(),e.next=9,Object(l.f)({});case 9:window.location.href=t;case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var e=Object(a.a)(Object(c.a)().mark((function e(){var t,n,r,a=arguments;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<a.length&&void 0!==a[0]?a[0]:{},d.a.getState().userInfoModel.userInfo){e.next=9;break}return e.next=4,$();case 4:return e.next=6,ne();case 6:if(e.sent){e.next=9;break}return e.abrupt("return");case 9:n=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])}))||[],((r=u.a.parse(window.location.search)).channel||window.sessionStorage.getItem("channel"))&&n.push("channel=".concat(r.channel||window.sessionStorage.getItem("channel"))),r.origin&&"image-editor-sdk"===r.origin&&r.platform&&n.push("is_sdk=image_editor_sdk&company_key=".concat(r.platform)),n.push("module_id=tpbj"),(r=window.sessionStorage.getItem("AB_TEST_INFO")||(Object(W.b)()?JSON.stringify(Object(W.b)()):""))&&n.push("ab_info=".concat(encodeURIComponent(r))),d.a.getActions().vipModel.setVipModalParams(n.join("&")),d.a.getActions().vipModel.setVipModalShow(!0);case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(a.a)(Object(c.a)().mark((function e(){var t,n;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(l.d)({});case 2:if((n=e.sent).data.code===s.a.OK)return n=Object(r.a)(Object(r.a)({},null==n||null==(t=n.data)||null==(t=t.data)?void 0:t.userInfo),null==n||null==(t=n.data)||null==(n=t.data)?void 0:n.vipInfo),d.a.getActions().userInfoModel.destroy(),d.a.getActions().userInfoModel.setUserInfo(n),e.abrupt("return",n);e.next=10;break;case 10:d.a.getActions().userInfoModel.destroy();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(){var e=Object(a.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="".concat(window.location.protocol,"//").concat("","account.meitu.com/#!/?client_id=").concat(q,"&client_callback=").concat(X),window.open(t);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},699:function(e,t,n){n(700),n(712),e.exports=n(1185)},815:function(e,t,n){var r={"./collapse-btn-dark.svg":816,"./collapse-btn-light.svg":817,"./logo-white.svg":818,"./logo.svg":819,"./new.svg":820,"./not-vip.svg":821,"./vip.svg":822};function c(e){return e=a(e),n(e)}function a(e){if(n.o(r,e))return r[e];throw(e=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",e}c.keys=function(){return Object.keys(r)},c.resolve=a,(e.exports=c).id=815},944:function(e,t,n){}},[[699,21,9,11,7,10,8]]]);